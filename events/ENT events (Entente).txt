###########################
# Entente Events
###########################
# By Rylock
###########################

add_namespace = entente

### IEDC Events

# IEDC created (fired by focus)
country_event = {
	id = entente.1
	title = entente.1.t
	desc = entente.1.d
	picture = GFX_report_event_CAN_commission

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.1 option entente.1.a"
		name = entente.1.a
		add_ideas = CAN_iedc_main
		unlock_decision_category_tooltip = CAN_iedc_decisions
		add_political_power = -50
		custom_effect_tooltip = add_50_pp_to_iedc
		hidden_effect = {
			set_global_flag = CAN_iedc_created
			set_country_flag = CAN_joined_iedc
			save_global_event_target_as = iedc_leader
			add_to_array = { array = global.iedc_members }
			set_variable = { global.iedc_pp = 50 }
			set_variable = { iedc_civ_factories = 0 }
			set_variable = { iedc_mil_factories = 0 }
			set_variable = { iedc_nav_factories = 0 }
		}
	}
}

# Invitation to the IEDC (fired by decision)
country_event = {
	id = entente.2
	title = entente.2.t
	desc = entente.2.d
	picture = GFX_report_event_generic_diplomacy2

	is_triggered_only = yes

	trigger = {
		has_capitulated = no
		is_in_faction_with = FROM
	}

	option = {
		log = "[GetLogInfo]: event entente.2 option entente.2.a"
		name = entente.2.a #join +25PP
		ai_chance = {
			base = 50
			#do not join if you have more than double the factories of the Entente leader
			modifier = {
				factor = 0
				set_temp_variable = { num_fact = FROM.num_of_factories }
				multiply_temp_variable = { num_fact = 2 }
				check_variable = {
					var = ROOT.num_of_factories
					value = num_fact
					compare = greater_than
				}
			}
		}
		if = {
			limit = { GER_is_in_mitteleuropa = yes }
			GER_leave_mitteleuropa = yes
			custom_effect_tooltip = tooltip_white_line
		}
		custom_effect_tooltip = CAN_joins_iedc
		add_political_power = -25
		custom_effect_tooltip = add_25_pp_to_iedc
		hidden_effect = {
			set_variable = { iedc_contribution = 25 }
			add_to_variable = { global.iedc_pp = 25 }
			set_variable = { iedc_civ_factories = 0 }
			set_variable = { iedc_mil_factories = 0 }
			set_variable = { iedc_nav_factories = 0 }
			set_country_flag = CAN_joined_iedc
			clr_country_flag = CAN_invited_to_iedc
			FROM = { country_event = entente.3 }
			country_event = { id = entente.5 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.2 option entente.2.b"
		name = entente.2.b #join +50PP
		ai_chance = {
			base = 30
			modifier = {
				factor = 0.5
				has_political_power < 0
			}
			modifier = {
				factor = 0.25
				has_political_power < -50
			}
			modifier = {
				factor = 2
				has_political_power > 99
				has_political_power < 200
			}
			modifier = {
				factor = 0
				num_of_factories < 10
			}
			#do not join if you have more than double the factories of the Entente leader
			modifier = {
				factor = 0
				set_temp_variable = { num_fact = FROM.num_of_factories }
				multiply_temp_variable = { num_fact = 2 }
				check_variable = {
					var = ROOT.num_of_factories
					value = num_fact
					compare = greater_than
				}
			}
		}
		if = {
			limit = { GER_is_in_mitteleuropa = yes }
			GER_leave_mitteleuropa = yes
			custom_effect_tooltip = tooltip_white_line
		}
		custom_effect_tooltip = CAN_joins_iedc
		add_political_power = -50
		custom_effect_tooltip = add_50_pp_to_iedc
		hidden_effect = {
			set_variable = { iedc_contribution = 50 }
			add_to_variable = { global.iedc_pp = 50 }
			set_variable = { iedc_civ_factories = 0 }
			set_variable = { iedc_mil_factories = 0 }
			set_variable = { iedc_nav_factories = 0 }
			set_country_flag = CAN_joined_iedc
			clr_country_flag = CAN_invited_to_iedc
			FROM = { country_event = entente.3 }
			country_event = { id = entente.5 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.2 option entente.2.c"
		name = entente.2.c #join +100PP
		trigger = { has_political_power > 99 }
		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				has_political_power > 199
			}
			modifier = {
				factor = 0
				num_of_factories < 20
			}
			#do not join if you have more than double the factories of the Entente leader
			modifier = {
				factor = 0
				set_temp_variable = { num_fact = FROM.num_of_factories }
				multiply_temp_variable = { num_fact = 2 }
				check_variable = {
					var = ROOT.num_of_factories
					value = num_fact
					compare = greater_than
				}
			}
		}
		if = {
			limit = { GER_is_in_mitteleuropa = yes }
			GER_leave_mitteleuropa = yes
			custom_effect_tooltip = tooltip_white_line
		}
		custom_effect_tooltip = CAN_joins_iedc
		add_political_power = -100
		custom_effect_tooltip = add_100_pp_to_iedc
		hidden_effect = {
			set_variable = { iedc_contribution = 100 }
			add_to_variable = { global.iedc_pp = 100 }
			set_variable = { iedc_civ_factories = 0 }
			set_variable = { iedc_mil_factories = 0 }
			set_variable = { iedc_nav_factories = 0 }
			set_country_flag = CAN_joined_iedc
			clr_country_flag = CAN_invited_to_iedc
			FROM = { country_event = entente.3 }
			country_event = { id = entente.5 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.2 option entente.2.e"
		name = entente.2.e #do not join
		ai_chance = {
			base = 50
			#always join if the Entente leader has more factories than you
			modifier = {
				factor = 0
				check_variable = {
					var = FROM.num_of_factories
					value = ROOT.num_of_factories
					compare = greater_than
				}
			}
			modifier = {
				factor = 0
				is_subject = yes
			}
			modifier = {
				factor = 0.5
				tag = NFA
			}
		}
		clr_country_flag = CAN_invited_to_iedc
		set_country_flag = CAN_refused_iedc
		reverse_add_opinion_modifier = { target = FROM modifier = KR_disapproves_of_govt }
		FROM = { country_event = entente.4 }
	}
}

# Canada notified of member joining IEDC
country_event = {
	id = entente.3
	title = entente.3.t
	desc = entente.3.d
	picture = GFX_report_event_generic_diplomacy3

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.3 option entente.3.a"
		name = entente.3.a
		clr_country_flag = CAN_inviting_to_iedc
		reverse_add_opinion_modifier = { target = FROM modifier = CAN_iedc_member }
		hidden_effect = {
			add_to_array = { array = global.iedc_members value = FROM }
		}
	}
}

# Canada notified of country refusing to join IEDC
country_event = {
	id = entente.4
	title = entente.4.t
	desc = entente.4.d
	picture = GFX_report_event_generic_diplomacy2

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.4 option entente.4.a"
		name = entente.4.a
		clr_country_flag = CAN_inviting_to_iedc
	}
}

# Advisors picked
country_event = {
	id = entente.5
	title = entente.5.t
	desc = entente.5.d
	picture = GFX_report_event_generic_factory

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.5 option entente.5.a"
		name = entente.5.a #Economic
		ai_chance = { base = 40 }
		if = {
			limit = { check_variable = { iedc_contribution < 50 } }
			add_timed_idea = {
				idea = CAN_iedc_econ1
				days = 365
			}
		}
		else_if = {
			limit = { check_variable = { iedc_contribution < 100 } }
			add_timed_idea = {
				idea = CAN_iedc_econ2
				days = 365
			}
		}
		else = {
			add_timed_idea = {
				idea = CAN_iedc_econ3
				days = 365
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.5 option entente.5.b"
		name = entente.5.b #Naval
		trigger = { num_of_naval_factories > 0 }
		ai_chance = {
			base = 30
			modifier = {
				factor = 0.5
				num_of_naval_factories < 5
			}
		}
		if = {
			limit = { check_variable = { iedc_contribution < 50 } }
			add_timed_idea = {
				idea = CAN_iedc_naval1
				days = 365
			}
		}
		else_if = {
			limit = { check_variable = { iedc_contribution < 100 } }
			add_timed_idea = {
				idea = CAN_iedc_naval2
				days = 365
			}
		}
		else = {
			add_timed_idea = {
				idea = CAN_iedc_naval3
				days = 365
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.5 option entente.5.c"
		name = entente.5.c #Construction
		ai_chance = { base = 30 }
		if = {
			limit = { check_variable = { iedc_contribution < 50 } }
			add_timed_idea = {
				idea = CAN_iedc_const1
				days = 365
			}
		}
		else_if = {
			limit = { check_variable = { iedc_contribution < 100 } }
			add_timed_idea = {
				idea = CAN_iedc_const2
				days = 365
			}
		}
		else = {
			add_timed_idea = {
				idea = CAN_iedc_const3
				days = 365
			}
		}
	}
}

# Investment in IEDC nation (fired by decision)
country_event = {
	id = entente.6
	title = entente.6.t
	picture = GFX_report_event_generic_diplomacy2

	desc = {
		text = entente.6.d.head
		trigger = { tag = FROM }
	}
	desc = {
		text = entente.6.d.member
		trigger = { NOT = { tag = FROM } }
	}

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.6 option entente.6.a"
		name = entente.6.a #Civilian
		ai_chance = {
			base = 30
			modifier = {
				factor = 2
				has_war = no
				date < 1939.1.1
			}
		}
		add_offsite_building = { type = industrial_complex level = 1 }
		hidden_effect = {
			clr_country_flag = CAN_iedc_investment
			set_country_flag = CAN_iedc_investment
			add_to_variable = { iedc_civ_factories = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.6 option entente.6.b"
		name = entente.6.b #Military
		ai_chance = { base = 40 }
		add_offsite_building = { type = arms_factory level = 1 }
		hidden_effect = {
			clr_country_flag = CAN_iedc_investment
			set_country_flag = CAN_iedc_investment
			add_to_variable = { iedc_mil_factories = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.6 option entente.6.c"
		name = entente.6.c #Dockyard
		trigger = {
			any_owned_state = { is_coastal = yes }
		}
		ai_chance = { base = 30 }
		add_offsite_building = { type = dockyard level = 1 }
		hidden_effect = {
			clr_country_flag = CAN_iedc_investment
			set_country_flag = CAN_iedc_investment
			add_to_variable = { iedc_nav_factories = 1 }
		}
	}
}

# Annual investment in IEDC
country_event = {
	id = entente.10
	title = entente.10.t
	desc = entente.10.d
	picture = GFX_report_event_CAN_commission

	trigger = {
		has_country_flag = { flag = CAN_joined_iedc days > 354 }
		is_in_faction = yes
		NOT = {
			has_idea = CAN_iedc_econ1
			has_idea = CAN_iedc_econ2
			has_idea = CAN_iedc_econ3
			has_idea = CAN_iedc_naval1
			has_idea = CAN_iedc_naval2
			has_idea = CAN_iedc_naval3
			has_idea = CAN_iedc_const1
			has_idea = CAN_iedc_const2
			has_idea = CAN_iedc_const3
		}
	}

	mean_time_to_happen = {
		days = 10
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = CAN_joined_iedc
			set_country_flag = CAN_joined_iedc
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.10 option entente.10.f"
		name = entente.10.f #invest 250PP
		trigger = {
			tag = event_target:KR_entente_leader
			has_political_power > 249
		}
		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				has_political_power > 299
			}
			modifier = {
				factor = 0
				num_of_factories < 30
			}
			modifier = {
				factor = 0.5
				surrender_progress > 0
			}
		}
		add_political_power = -250
		custom_effect_tooltip = add_250_pp_to_iedc
		hidden_effect = {
			set_variable = { iedc_contribution = 250 }
			add_to_variable = { global.iedc_pp = 250 }
			country_event = { id = entente.5 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.10 option entente.10.a"
		name = entente.10.a #invest 100PP
		trigger = { has_political_power > 99 }
		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				has_political_power > 199
			}
			modifier = {
				factor = 0
				num_of_factories < 20
			}
			modifier = {
				factor = 0.5
				surrender_progress > 0
			}
		}
		add_political_power = -100
		custom_effect_tooltip = add_100_pp_to_iedc
		hidden_effect = {
			set_variable = { iedc_contribution = 100 }
			add_to_variable = { global.iedc_pp = 100 }
			country_event = { id = entente.5 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.10 option entente.10.b"
		name = entente.10.b #invest 50PP
		ai_chance = {
			base = 30
			modifier = {
				factor = 0.5
				has_political_power < 50
			}
			modifier = {
				factor = 0.5
				has_political_power < 0
			}
			modifier = {
				factor = 2
				has_political_power > 99
				has_political_power < 200
			}
			modifier = {
				factor = 0
				num_of_factories < 10
			}
			modifier = {
				factor = 0.5
				surrender_progress > 0
			}
		}
		add_political_power = -50
		custom_effect_tooltip = add_50_pp_to_iedc
		hidden_effect = {
			set_variable = { iedc_contribution = 50 }
			add_to_variable = { global.iedc_pp = 50 }
			country_event = { id = entente.5 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.10 option entente.10.c"
		name = entente.10.c #invest 25PP
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.5
				surrender_progress > 0
			}
		}
		add_political_power = -25
		custom_effect_tooltip = add_25_pp_to_iedc
		hidden_effect = {
			set_variable = { iedc_contribution = 25 }
			add_to_variable = { global.iedc_pp = 25 }
			country_event = { id = entente.5 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.10 option entente.10.e"
		name = entente.10.e #invest nothing
		ai_chance = {
			base = 20
			modifier = {
				factor = 0.1
				has_political_power > 50
			}
			modifier = {
				factor = 2.5
				has_political_power < 0
			}
			modifier = {
				factor = 2
				has_political_power < -100
			}
			modifier = {
				factor = 2
				surrender_progress > 0
			}
		}
		hidden_effect = {
			set_variable = { iedc_contribution = 0 }
		}
	}
}

# Country leaves the Entente, and thus the IEDC
country_event = {
	id = entente.12
	title = entente.12.t
	desc = entente.12.d
	picture = GFX_report_event_generic_diplomacy2

	trigger = {
		has_country_flag = CAN_joined_iedc
		has_global_flag = CAN_iedc_created
		NOT = {
			has_idea = CAN_iedc_main
			AND = {
				is_in_faction = yes
				any_allied_country = { has_idea = CAN_iedc_main }
			}
		}
	}

	mean_time_to_happen = {
		days = 3
	}

	immediate = {
		clr_country_flag = CAN_joined_iedc
		set_country_flag = CAN_refused_iedc
		remove_from_array = { array = global.iedc_members value = ROOT }
	}

	option = {
		log = "[GetLogInfo]: event entente.12 option entente.12.a"
		name = entente.12.a
		CAN_remove_from_iedc_effect = yes
	}
}

# IEDC shut down
country_event = {
	id = entente.13
	title = entente.13.t
	desc = entente.13.d
	picture = GFX_report_event_CAN_commission

	fire_only_once = yes

	trigger = {
		tag = ENT
		has_idea = CAN_iedc_main
		check_variable = { global.iedc_members^num < 2 }
		has_global_flag = { flag = CAN_iedc_created days > 180 }
	}

	mean_time_to_happen = {
		days = 7
	}

	option = {
		log = "[GetLogInfo]: event entente.13 option entente.13.a"
		name = entente.13.a
		clr_global_flag = CAN_iedc_created
		clr_country_flag = CAN_joined_iedc
		clear_variable = iedc_contribution
		if = {
			limit = { has_idea = CAN_iedc_main }
			remove_ideas = CAN_iedc_main
		}
		if = {
			limit = { has_idea = CAN_iedc_econ1 }
			remove_ideas = CAN_iedc_econ1
		}
		if = {
			limit = { has_idea = CAN_iedc_econ2 }
			remove_ideas = CAN_iedc_econ2
		}
		if = {
			limit = { has_idea = CAN_iedc_econ3 }
			remove_ideas = CAN_iedc_econ3
		}
		if = {
			limit = { has_idea = CAN_iedc_naval1 }
			remove_ideas = CAN_iedc_naval1
		}
		if = {
			limit = { has_idea = CAN_iedc_naval2 }
			remove_ideas = CAN_iedc_naval2
		}
		if = {
			limit = { has_idea = CAN_iedc_naval3 }
			remove_ideas = CAN_iedc_naval3
		}
		if = {
			limit = { has_idea = CAN_iedc_const1 }
			remove_ideas = CAN_iedc_const1
		}
		if = {
			limit = { has_idea = CAN_iedc_const2 }
			remove_ideas = CAN_iedc_const2
		}
		if = {
			limit = { has_idea = CAN_iedc_const3 }
			remove_ideas = CAN_iedc_const3
		}
		if = {
			limit = { check_variable = { iedc_civ_factories > 0 } }
			custom_effect_tooltip = CAN_remove_iedc_civ
			hidden_effect = {
				set_variable = { tempvar1 = 0 }
				subtract_from_variable = { var = tempvar1 value = iedc_civ_factories }
				add_offsite_building = { type = industrial_complex level = tempvar1 }
				clear_variable = tempvar1
			}
		}
		if = {
			limit = { check_variable = { iedc_mil_factories > 0 } }
			custom_effect_tooltip = CAN_remove_iedc_mil
			hidden_effect = {
				set_variable = { tempvar2 = 0 }
				subtract_from_variable = { var = tempvar2 value = iedc_mil_factories }
				add_offsite_building = { type = arms_factory level = tempvar2 }
				clear_variable = tempvar2
			}
		}
		if = {
			limit = { check_variable = { iedc_nav_factories > 0 } }
			custom_effect_tooltip = CAN_remove_iedc_nav
			hidden_effect = {
				set_variable = { tempvar3 = 0 }
				subtract_from_variable = { var = tempvar3 value = iedc_nav_factories }
				add_offsite_building = { type = dockyard level = tempvar3 }
				clear_variable = tempvar3
			}
		}
		hidden_effect = {
			clear_variable = iedc_civ_factories
			clear_variable = iedc_mil_factories
			clear_variable = iedc_nav_factories
			clear_variable = global.iedc_pp
			clear_array = global.iedc_members
		}
	}
}

# ISAC created
country_event = {
	id = entente.15
	title = entente.15.t
	desc = entente.15.d
	picture = GFX_report_event_CAN_commission

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.15 option entente.15.a"
		name = entente.15.a
		effect_tooltip = { add_to_tech_sharing_group = entente_research }
	}
}

### Influence of the Monarchy Events

# King addresses the Entente (fired by decision)
country_event = {
	id = entente.20
	title = entente.20.t
	picture = GFX_report_event_CAN_microphone

	desc = {
		text = entente.20.d.home_isles
		trigger = {
			event_target:KR_king_base = {
				tag = GBR
				NOT = { has_country_flag = CAN_speech_home_isles }
			}
		}
	}
	desc = {
		text = entente.20.d.war_eng
		trigger = {
			event_target:KR_king_base = {
				has_war_with = ENG
				NOT = {
					has_country_flag = CAN_speech_war_eng
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.war_ger
		trigger = {
			event_target:KR_king_base = {
				has_war_with = GER
				NOT = {
					has_country_flag = CAN_speech_war_ger
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.war_acw
		trigger = {
			event_target:KR_king_base = {
				OR = {
					has_war_with = USA
					has_war_with = CSA
					has_war_with = TEX
					has_war_with = PSA
				}
				NOT = {
					has_country_flag = CAN_speech_war_acw
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.france_taken
		trigger = {
			NFA = {
				is_in_faction_with = event_target:KR_king_base
				owns_state = 16
			}
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_france_taken
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.france_mainland
		trigger = {
			NFA = {
				owns_state = 21
				NOT = { owns_state = 16 }
				is_in_faction_with = event_target:KR_king_base
			}
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_france_mainland
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.india_united
		trigger = {
			RAJ = {
				is_in_faction_with = event_target:KR_king_base
				owns_state = 431
				owns_state = 427
			}
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_india_united
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.italy_united
		trigger = {
			SRD = {
				is_in_faction_with = event_target:KR_king_base
				owns_state = 158
			}
			NOT = { country_exists = SRI }
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_italy_united
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.india_defeated
		trigger = {
			NOT = { country_exists = RAJ }
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_india_defeated
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
					AND = {
						SRD = {
							is_in_faction_with = PREV
							owns_state = 158
						}
						NOT = { has_country_flag = CAN_speech_italy_united }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.aus_syndicalist
		trigger = {
			AST = { has_socialist_government = yes }
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_aus_syndicalist
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
					AND = {
						SRD = {
							is_in_faction_with = PREV
							owns_state = 158
						}
						NOT = { has_country_flag = CAN_speech_italy_united }
					}
					AND = {
						NOT = { country_exists = RAJ }
						NOT = { has_country_flag = CAN_speech_india_defeated }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.wif_syndicalist
		trigger = {
			WIF = { has_socialist_government = yes }
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_wif_syndicalist
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
					AND = {
						SRD = {
							is_in_faction_with = PREV
							owns_state = 158
						}
						NOT = { has_country_flag = CAN_speech_italy_united }
					}
					AND = {
						NOT = { country_exists = RAJ }
						NOT = { has_country_flag = CAN_speech_india_defeated }
					}
					AND = {
						AST = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_aus_syndicalist }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.acw_begins
		trigger = {
			CSA = {
				has_war_with = USA
				NOT = { has_war_with = event_target:KR_king_base }
			}
			event_target:KR_king_base = {
				NOT = {
					has_country_flag = CAN_speech_acw_begins
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
					AND = {
						SRD = {
							is_in_faction_with = PREV
							owns_state = 158
						}
						NOT = { has_country_flag = CAN_speech_italy_united }
					}
					AND = {
						NOT = { country_exists = RAJ }
						NOT = { has_country_flag = CAN_speech_india_defeated }
					}
					AND = {
						AST = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_aus_syndicalist }
					}
					AND = {
						WIF = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_wif_syndicalist }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.war
		trigger = {
			event_target:KR_king_base = {
				has_war = yes
				NOT = {
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
					AND = {
						SRD = {
							is_in_faction_with = PREV
							owns_state = 158
						}
						NOT = { has_country_flag = CAN_speech_italy_united }
					}
					AND = {
						NOT = { country_exists = RAJ }
						NOT = { has_country_flag = CAN_speech_india_defeated }
					}
					AND = {
						AST = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_aus_syndicalist }
					}
					AND = {
						WIF = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_wif_syndicalist }
					}
					AND = {
						CSA = {
							has_war_with = USA
							NOT = { has_war_with = PREV }
						}
						NOT = { has_country_flag = CAN_speech_acw_begins }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.peace1
		trigger = {
			country_exists = ENG
			event_target:KR_king_base = {
				has_war = no
				NOT = {
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
					AND = {
						SRD = {
							is_in_faction_with = PREV
							owns_state = 158
						}
						NOT = { has_country_flag = CAN_speech_italy_united }
					}
					AND = {
						NOT = { country_exists = RAJ }
						NOT = { has_country_flag = CAN_speech_india_defeated }
					}
					AND = {
						AST = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_aus_syndicalist }
					}
					AND = {
						WIF = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_wif_syndicalist }
					}
					AND = {
						CSA = {
							has_war_with = USA
							NOT = { has_war_with = PREV }
						}
						NOT = { has_country_flag = CAN_speech_acw_begins }
					}
				}
			}
		}
	}
	desc = {
		text = entente.20.d.peace2
		trigger = {
			NOT = { country_exists = ENG }
			event_target:KR_king_base = {
				has_war = no
				NOT = {
					AND = {
						tag = GBR
						NOT = { has_country_flag = CAN_speech_home_isles }
					}
					AND = {
						has_war_with = ENG
						NOT = { has_country_flag = CAN_speech_war_eng }
					}
					AND = {
						has_war_with = GER
						NOT = { has_country_flag = CAN_speech_war_ger }
					}
					AND = {
						OR = {
							has_war_with = USA
							has_war_with = CSA
							has_war_with = TEX
							has_war_with = PSA
						}
						NOT = { has_country_flag = CAN_speech_war_acw }
					}
					AND = {
						NFA = {
							owns_state = 16
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_taken }
					}
					AND = {
						NFA = {
							owns_state = 21
							NOT = { owns_state = 16 }
							is_in_faction_with = PREV
						}
						NOT = { has_country_flag = CAN_speech_france_mainland }
					}
					AND = {
						RAJ = {
							is_in_faction_with = PREV
							owns_state = 431
							owns_state = 427
						}
						NOT = { has_country_flag = CAN_speech_india_united }
					}
					AND = {
						SRD = {
							is_in_faction_with = PREV
							owns_state = 158
						}
						NOT = { has_country_flag = CAN_speech_italy_united }
					}
					AND = {
						NOT = { country_exists = RAJ }
						NOT = { has_country_flag = CAN_speech_india_defeated }
					}
					AND = {
						AST = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_aus_syndicalist }
					}
					AND = {
						WIF = { has_socialist_government = yes }
						NOT = { has_country_flag = CAN_speech_wif_syndicalist }
					}
					AND = {
						CSA = {
							has_war_with = USA
							NOT = { has_war_with = PREV }
						}
						NOT = { has_country_flag = CAN_speech_acw_begins }
					}
				}
			}
		}
	}

	is_triggered_only = yes
	major = yes

	show_major = {
		is_in_faction_with = ROOT
	}

	option = {
		log = "[GetLogInfo]: event entente.20 option entente.20.a"
		name = entente.20.a
		trigger = { tag = event_target:KR_king_base }
		if = {
			limit = {
				tag = GBR
				NOT = { has_country_flag = CAN_speech_home_isles }
			}
			set_country_flag = CAN_speech_home_isles
		}
		else_if = {
			limit = {
				has_war_with = ENG
				NOT = { has_country_flag = CAN_speech_war_eng }
			}
			set_country_flag = CAN_speech_war_eng
		}
		else_if = {
			limit = {
				has_war_with = GER
				NOT = { has_country_flag = CAN_speech_war_ger }
			}
			set_country_flag = CAN_speech_war_ger
		}
		else_if = {
			limit = {
				OR = {
					has_war_with = USA
					has_war_with = CSA
					has_war_with = TEX
					has_war_with = PSA
				}
				NOT = { has_country_flag = CAN_speech_war_acw }
			}
			set_country_flag = CAN_speech_war_acw
		}
		else_if = {
			limit = {
				NFA = {
					owns_state = 16
					is_in_faction_with = event_target:KR_king_base
				}
				NOT = { has_country_flag = CAN_speech_france_taken }
			}
			set_country_flag = CAN_speech_france_taken
		}
		else_if = {
			limit = {
				NFA = {
					owns_state = 21
					NOT = { owns_state = 16 }
					is_in_faction_with = event_target:KR_king_base
				}
				NOT = { has_country_flag = CAN_speech_france_mainland }
			}
			set_country_flag = CAN_speech_france_mainland
		}
		else_if = {
			limit = {
				RAJ = {
					is_in_faction_with = event_target:KR_king_base
					owns_state = 431
					owns_state = 427
				}
				NOT = { has_country_flag = CAN_speech_india_united }
			}
			set_country_flag = CAN_speech_india_united
		}
		else_if = {
			limit = {
				SRD = {
					is_in_faction_with = event_target:KR_king_base
					owns_state = 158
				}
				NOT = { country_exists = SRI }
				NOT = { has_country_flag = CAN_speech_italy_united }
			}
			set_country_flag = CAN_speech_italy_united
		}
		else_if = {
			limit = {
				NOT = { country_exists = RAJ }
				NOT = { has_country_flag = CAN_speech_india_defeated }
			}
			set_country_flag = CAN_speech_india_defeated
		}
		else_if = {
			limit = {
				AST = { has_socialist_government = yes }
				NOT = { has_country_flag = CAN_speech_aus_syndicalist }
			}
			set_country_flag = CAN_speech_aus_syndicalist
		}
		else_if = {
			limit = {
				WIF = { has_socialist_government = yes }
				NOT = { has_country_flag = CAN_speech_wif_syndicalist }
			}
			set_country_flag = CAN_speech_wif_syndicalist
		}
		else_if = {
			limit = {
				CSA = {
					has_war_with = USA
					NOT = { has_war_with = event_target:KR_king_base }
				}
				NOT = { has_country_flag = CAN_speech_acw_begins }
			}
			set_country_flag = CAN_speech_acw_begins
		}
		clr_global_flag = CAN_king_busy
		CAN_add_ws_based_on_popularity_cw = yes
	}
	option = {
		log = "[GetLogInfo]: event entente.20 option entente.20.b"
		name = entente.20.b
		trigger = {
			NOT = { tag = event_target:KR_king_base }
			CAN_is_commonwealth_tag = yes
		}
		CAN_add_ws_based_on_popularity_cw = yes
	}
	option = {
		log = "[GetLogInfo]: event entente.20 option entente.20.c"
		name = entente.20.c
		trigger = {
			NOT = { tag = event_target:KR_king_base }
			CAN_is_commonwealth_tag = no
		}
		CAN_add_ws_based_on_popularity = yes
	}
}

# King tours country (fired by decision)
country_event = {
	id = entente.21
	title = entente.21.t
	picture = GFX_report_event_CAN_royal_tour

	desc = {
		text = entente.21.d.high
		trigger = { check_variable = { event_target:KR_king_base.king_popularity > 3 } }
	}
	desc = {
		text = entente.21.d.med
		trigger = {
			check_variable = { event_target:KR_king_base.king_popularity > 1 }
			check_variable = { event_target:KR_king_base.king_popularity < 4 }
		}
	}
	desc = {
		text = entente.21.d.low
		trigger = { check_variable = { event_target:KR_king_base.king_popularity < 2 } }
	}

	is_triggered_only = yes

	immediate = {
		CAN_calc_royal_visit_effects = yes
		set_country_flag = CAN_king_toured
		hidden_effect = {
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					industrial_complex > 0
				}
				save_event_target_as = parade_state
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.21 option entente.21.a"
		name = entente.21.a
		trigger = { NOT = { tag = IRE } }
		custom_effect_tooltip = CAN_king_three_month_tour
		add_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
		hidden_effect = {
			FROM = { save_event_target_as = original_home_country }
			save_event_target_as = tour_country
			country_event = { id = entente.29 days = 365 }
			random_other_country = {
				limit = { is_ai = yes }
				country_event = entente.22
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.21 option entente.21.b"
		name = entente.21.b
		trigger = {
			tag = IRE
			ENT_king_edward_viii = yes
		}
		custom_effect_tooltip = CAN_king_three_month_tour
		add_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
		hidden_effect = {
			FROM = { save_event_target_as = original_home_country }
			save_event_target_as = tour_country
			country_event = { id = entente.29 days = 365 }
			random_other_country = {
				limit = { is_ai = yes }
				country_event = entente.22
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.21 option entente.21.c"
		name = entente.21.c
		trigger = {
			tag = IRE
			ENT_king_edward_viii = no
		}
		custom_effect_tooltip = CAN_king_three_month_tour
		add_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
		hidden_effect = {
			FROM = { save_event_target_as = original_home_country }
			save_event_target_as = tour_country
			country_event = { id = entente.29 days = 365 }
			random_other_country = {
				limit = { is_ai = yes }
				country_event = entente.22
			}
		}
	}
}

# Bounce event for random tour events
country_event = {
	id = entente.22

	hidden = yes
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.22 option AI_OPTION"
		name = AI_OPTION #Minor Scandal
		ai_chance = {
			base = 10
			modifier = {
				factor = 0.5
				ENT_king_albert_i = yes
			}
			modifier = {
				factor = 0.75
				check_variable = { event_target:KR_king_base.king_popularity > 3 }
			}
		}
		FROM = {
			country_event = { id = entente.23 days = 10 random_days = 50 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.22 option AI_OPTION"
		name = AI_OPTION #MAJOR_SCANDAL
		ai_chance = {
			base = 5
			modifier = {
				factor = 0.5
				ENT_king_albert_i = yes
			}
			modifier = {
				factor = 2
				ENT_king_george_vi = yes
			}
			modifier = {
				factor = 0.75
				check_variable = { event_target:KR_king_base.king_popularity > 3 }
			}
		}
		FROM = {
			country_event = { id = entente.24 days = 10 random_days = 50 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.22 option AI_OPTION"
		name = AI_OPTION #ASSASSINATION_ATTEMPT
		trigger = {
			check_variable = { event_target:KR_king_base.king_popularity < 4 }
		}
		ai_chance = {
			base = 2
			modifier = {
				factor = 2
				check_variable = { event_target:KR_king_base.king_popularity < 2 }
			}
		}
		FROM = {
			country_event = { id = entente.25 days = 10 random_days = 50 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.22 option AI_OPTION"
		name = AI_OPTION #ILLNESS
		ai_chance = {
			base = 5
			modifier = {
				factor = 0.5
				ENT_king_george_vi = yes
			}
		}
		FROM = {
			country_event = { id = entente.26 days = 10 random_days = 50 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.22 option AI_OPTION"
		name = AI_OPTION #GREAT_SPEECH
		ai_chance = {
			base = 7
			modifier = {
				factor = 0.5
				OR = {
					ENT_king_albert_i = yes
					ENT_king_henry_ix = yes
				}
			}
			modifier = {
				factor = 1.5
				check_variable = { event_target:KR_king_base.king_popularity > 4 }
			}
			modifier = {
				factor = 0.75
				check_variable = { event_target:KR_king_base.king_popularity < 3 }
			}
			modifier = {
				factor = 0.75
				check_variable = { event_target:KR_king_base.king_popularity > 2 }
			}
		}
		FROM = {
			country_event = { id = entente.27 days = 10 random_days = 50 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.22 option AI_OPTION"
		name = AI_OPTION #POOR_SPEECH
		ai_chance = {
			base = 7
			modifier = {
				factor = 1.5
				ENT_king_albert_i = yes
			}
			modifier = {
				factor = 0.75
				check_variable = { event_target:KR_king_base.king_popularity > 4 }
			}
			modifier = {
				factor = 1.25
				check_variable = { event_target:KR_king_base.king_popularity < 3 }
			}
			modifier = {
				factor = 1.25
				check_variable = { event_target:KR_king_base.king_popularity > 2 }
			}
		}
		FROM = {
			country_event = { id = entente.28 days = 10 random_days = 50 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.22 option AI_OPTION"
		name = AI_OPTION #NO_EVENT
		ai_chance = {
			base = 65
			modifier = {
				factor = 1.2
				ENT_king_henry_ix = yes
			}
		}
	}
}

# Visit - minor scandal
country_event = {
	id = entente.23
	title = entente.23.t
	desc = entente.23.d
	picture = GFX_report_event_CAN_royal_tour

	is_triggered_only = yes
	major = yes

	trigger = {
		event_target:original_home_country = {
			NOT = { has_country_flag = CAN_visit_cancel }
			surrender_progress < 0.50
		}
		event_target:tour_country = {
			has_capitulated = no
			OR = {
				tag = event_target:KR_king_base
				is_in_faction_with = event_target:KR_king_base
			}
			surrender_progress < 0.50
		}
	}

	show_major = {
		OR = {
			tag = event_target:KR_king_base
			tag = event_target:tour_country
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.23 option entente.23.a"
		name = entente.23.a
		trigger = {
			tag = event_target:KR_king_base
			NOT = { tag = event_target:tour_country }
		}
		effect_tooltip = {
			event_target:tour_country = {
				remove_dynamic_modifier = {
					modifier = CAN_royal_visit_effect
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.23 option entente.23.a"
		name = entente.23.a
		trigger = { tag = event_target:tour_country }
		remove_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
	}
}

# Visit - major scandal
country_event = {
	id = entente.24
	title = entente.24.t
	desc = entente.24.d
	picture = GFX_report_event_CAN_royal_tour

	is_triggered_only = yes
	major = yes

	trigger = {
		event_target:original_home_country = {
			NOT = { has_country_flag = CAN_visit_cancel }
			surrender_progress < 0.50
		}
		event_target:tour_country = {
			has_capitulated = no
			OR = {
				tag = event_target:KR_king_base
				is_in_faction_with = event_target:KR_king_base
			}
			surrender_progress < 0.50
		}
	}

	show_major = {
		OR = {
			tag = event_target:KR_king_base
			tag = event_target:tour_country
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.24 option entente.24.a"
		name = entente.24.a
		trigger = {
			tag = event_target:KR_king_base
			NOT = { tag = event_target:tour_country }
		}
		custom_effect_tooltip = CAN_king_popularity_decrease
		effect_tooltip = {
			event_target:tour_country = {
				remove_dynamic_modifier = {
					modifier = CAN_royal_visit_effect
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.24 option entente.24.a"
		name = entente.24.a
		trigger = { tag = event_target:tour_country }
		remove_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
		custom_effect_tooltip = CAN_king_popularity_decrease
		hidden_effect = {
			subtract_from_variable = { event_target:KR_king_base.king_popularity = 1 }
			CAN_calc_royal_visit_effects = yes
			clr_global_flag = CAN_king_busy
			event_target:KR_king_base = { set_country_flag = CAN_visit_cancel }
			set_global_flag = { flag = CAN_king_busy days = 90 value = 1 }
		}
	}
}

# Visit - assassination attempt
country_event = {
	id = entente.25
	title = entente.25.t
	desc = entente.25.d
	picture = GFX_report_event_CAN_royal_tour

	is_triggered_only = yes
	major = yes

	trigger = {
		event_target:original_home_country = {
			NOT = { has_country_flag = CAN_visit_cancel }
			surrender_progress < 0.50
		}
		event_target:tour_country = {
			OR = {
				tag = event_target:KR_king_base
				is_in_faction_with = event_target:KR_king_base
			}
			surrender_progress < 0.50
		}
	}

	show_major = {
		OR = {
			tag = event_target:KR_king_base
			tag = event_target:tour_country
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.25 option entente.25.a"
		name = entente.25.a
		trigger = {
			tag = event_target:KR_king_base
			NOT = { tag = event_target:tour_country }
		}
		effect_tooltip = {
			event_target:tour_country = {
				add_stability = -0.03
				add_war_support = 0.05
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.25 option entente.25.a"
		name = entente.25.a
		trigger = { tag = event_target:tour_country }
		add_stability = -0.03
		add_war_support = 0.05
		hidden_effect = {
			clr_global_flag = CAN_king_busy
			event_target:KR_king_base = { set_country_flag = CAN_visit_cancel }
			set_global_flag = { flag = CAN_king_busy days = 90 value = 1 }
		}
	}
}

# Visit - king becomes ill
country_event = {
	id = entente.26
	title = entente.26.t
	desc = entente.26.d
	picture = GFX_report_event_CAN_royal_tour

	is_triggered_only = yes
	major = yes

	trigger = {
		event_target:original_home_country = {
			NOT = { has_country_flag = CAN_visit_cancel }
			surrender_progress < 0.50
		}
		event_target:tour_country = {
			OR = {
				tag = event_target:KR_king_base
				is_in_faction_with = event_target:KR_king_base
			}
			surrender_progress < 0.50
		}
	}

	show_major = {
		OR = {
			tag = event_target:KR_king_base
			tag = event_target:tour_country
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.26 option entente.26.a"
		name = entente.26.a
		trigger = {
			tag = event_target:KR_king_base
			NOT = { tag = event_target:tour_country }
		}
		effect_tooltip = {
			event_target:tour_country = {
				remove_dynamic_modifier = {
					modifier = CAN_royal_visit_effect
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.26 option entente.26.a"
		name = entente.26.a
		trigger = { tag = event_target:tour_country }
		hidden_effect = {
			clr_global_flag = CAN_king_busy
			event_target:KR_king_base = { set_country_flag = CAN_visit_cancel }
			set_global_flag = { flag = CAN_king_busy days = 90 value = 1 }
			country_event = { id = entente.29 days = 120 }
		}
		remove_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
	}
}

# Visit - great speech
country_event = {
	id = entente.27
	title = entente.27.t
	desc = entente.27.d
	picture = GFX_report_event_CAN_royal_tour

	is_triggered_only = yes
	major = yes

	trigger = {
		event_target:original_home_country = {
			NOT = { has_country_flag = CAN_visit_cancel }
			surrender_progress < 0.50
		}
		event_target:tour_country = {
			OR = {
				tag = event_target:KR_king_base
				is_in_faction_with = event_target:KR_king_base
			}
			surrender_progress < 0.50
		}
	}

	show_major = {
		OR = {
			tag = event_target:KR_king_base
			tag = event_target:tour_country
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.27 option entente.27.a"
		name = entente.27.a
		trigger = {
			tag = event_target:KR_king_base
			NOT = { tag = event_target:tour_country }
		}
		effect_tooltip = {
			event_target:tour_country = {
				add_war_support = 0.05
				add_political_power = 25
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.27 option entente.27.a"
		name = entente.27.a
		trigger = { tag = event_target:tour_country }
		add_war_support = 0.05
		add_political_power = 25
	}
}

# Visit - poor speech
country_event = {
	id = entente.28
	title = entente.28.t
	desc = entente.28.d
	picture = GFX_report_event_CAN_royal_tour

	is_triggered_only = yes
	major = yes

	trigger = {
		event_target:original_home_country = {
			NOT = { has_country_flag = CAN_visit_cancel }
			surrender_progress < 0.50
		}
		event_target:tour_country = {
			OR = {
				tag = event_target:KR_king_base
				is_in_faction_with = event_target:KR_king_base
			}
			surrender_progress < 0.50
		}
	}

	show_major = {
		OR = {
			tag = event_target:KR_king_base
			tag = event_target:tour_country
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.28 option entente.28.a"
		name = entente.28.a
		trigger = {
			tag = event_target:KR_king_base
			NOT = { tag = event_target:tour_country }
		}
		effect_tooltip = {
			event_target:tour_country = {
				add_war_support = -0.05
				add_political_power = -25
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.28 option entente.28.a"
		name = entente.28.a
		trigger = { tag = event_target:tour_country }
		add_war_support = -0.05
		add_political_power = -25
	}
}

# Removing the tour modifier
country_event = {
	id = entente.29

	hidden = yes
	is_triggered_only = yes

	trigger = {
		has_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
	}

	immediate = {
		remove_dynamic_modifier = {
			modifier = CAN_royal_visit_effect
		}
	}
}

# Directing the Exies (fired by decision)
country_event = {
	id = entente.30
	title = entente.30.t
	picture = GFX_report_event_CAN_cabinet

	desc = {
		text = entente.30.d.low
		trigger = {
			check_variable = { king_influence < 2 }
		}
	}
	desc = {
		text = entente.30.d.med
		trigger = {
			check_variable = { king_influence < 4 }
			check_variable = { king_influence > 1 }
		}
	}
	desc = {
		text = entente.30.d.high
		trigger = {
			check_variable = { king_influence > 3 }
		}
	}

	is_triggered_only = yes

	immediate = {
		CAN_calc_exile_influence_effects = yes
	}

	option = {
		log = "[GetLogInfo]: event entente.30 option entente.30.a"
		name = entente.30.a #increase influence
		trigger = {
			check_variable = { king_influence < 6 }
		}
		ai_chance = {
			base = 20
			modifier = {
				factor = 0.5
				check_variable = { king_influence > 4 }
			}
			modifier = {
				factor = 1.5
				check_variable = { king_influence < 4 }
			}
			modifier = {
				factor = 2
				check_variable = { king_influence < 3 }
			}
			modifier = {
				factor = 2
				check_variable = { king_influence < 2 }
			}
		}
		set_country_flag = CAN_exile_inc_influence
		custom_effect_tooltip = CAN_exiles_increasing_influence
	}
	option = {
		log = "[GetLogInfo]: event entente.30 option entente.30.b"
		name = entente.30.b #assist government
		trigger = {
			check_variable = { king_influence > 1 }
		}
		ai_chance = {
			base = 20
			modifier = {
				factor = 10
				has_political_power < 0
			}
			modifier = {
				factor = 2
				has_political_power < -100
			}
			modifier = {
				factor = 0
				has_political_power > 150
			}
		}
		if = {
			limit = {
				check_variable = { king_influence > 4 }
			}
			add_political_power = 50
		}
		else_if = {
			limit = {
				check_variable = { king_influence > 3 }
				check_variable = { king_influence < 5 }
			}
			add_political_power = 40
		}
		else_if = {
			limit = {
				check_variable = { king_influence > 2 }
				check_variable = { king_influence < 4 }
			}
			add_political_power = 30
		}
		else_if = {
			limit = {
				check_variable = { king_influence > 1 }
				check_variable = { king_influence < 3 }
			}
			add_political_power = 25
		}
		add_dynamic_modifier = {
			modifier = CAN_exile_government_effect
		}
		hidden_effect = {
			country_event = { id = entente.32 days = 364 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.30 option entente.30.c"
		name = entente.30.c #assist industry
		trigger = {
			check_variable = { king_influence > 2 }
			set_temp_variable = { temp = king_civ_factories }
			add_to_temp_variable = { temp = king_mil_factories }
			check_variable = { var = temp value = king_influence compare = less_than }
		}
		ai_chance = { base = 50 }
		set_country_flag = CAN_exile_inc_industry
		custom_effect_tooltip = CAN_exiles_increasing_industry
	}
	option = {
		log = "[GetLogInfo]: event entente.30 option entente.30.c"
		name = entente.30.c #assist industry
		trigger = {
			check_variable = { king_influence > 2 }
			set_temp_variable = { temp = king_civ_factories }
			add_to_temp_variable = { temp = king_mil_factories }
			check_variable = { var = temp value = king_influence compare = greater_than_or_equals }
		}
		ai_chance = { base = 20 }
		add_dynamic_modifier = {
			modifier = CAN_exile_industry_effect
		}
		hidden_effect = {
			country_event = { id = entente.33 days = 364 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.30 option entente.30.e"
		name = entente.30.e #increase popularity
		trigger = {
			check_variable = { king_influence > 3 }
			check_variable = { king_popularity < 5 }
		}
		ai_chance = {
			base = 20
			modifier = {
				factor = 0
				check_variable = { king_popularity > 3 }
			}
			modifier = {
				factor = 2
				check_variable = { king_popularity < 3 }
			}
			modifier = {
				factor = 2
				check_variable = { king_popularity < 2 }
			}
		}
		set_country_flag = CAN_exile_inc_popularity
		custom_effect_tooltip = CAN_exiles_increasing_popularity
	}
}

# Exiles build an offmap factory
country_event = {
	id = entente.31
	title = entente.31.t
	desc = entente.31.d
	picture = GFX_report_event_generic_factory

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.31 option entente.31.a"
		name = entente.31.a #civ factory
		add_offsite_building = { type = industrial_complex level = 1 }
		add_to_variable = { king_civ_factories = 1 }
	}
	option = {
		log = "[GetLogInfo]: event entente.31 option entente.31.b"
		name = entente.31.b #mil factory
		add_offsite_building = { type = arms_factory level = 1 }
		add_to_variable = { king_mil_factories = 1 }
	}
}

# Removing exile government modifier
country_event = {
	id = entente.32

	hidden = yes
	is_triggered_only = yes

	trigger = {
		has_dynamic_modifier = {
			modifier = CAN_exile_government_effect
		}
	}

	immediate = {
		remove_dynamic_modifier = {
			modifier = CAN_exile_government_effect
		}
	}
}

# Removing exile industry modifier
country_event = {
	id = entente.33

	hidden = yes
	is_triggered_only = yes

	trigger = {
		has_dynamic_modifier = {
			modifier = CAN_exile_industry_effect
		}
	}

	immediate = {
		remove_dynamic_modifier = {
			modifier = CAN_exile_industry_effect
		}
	}
}

### Royal Events

# Main hidden event
country_event = {
	id = entente.50

	hidden = yes
	is_triggered_only = yes

	trigger = {
		has_country_flag = KR_british_king_base
		event_target:KR_king_base = { tag = ROOT }
		has_socialist_government = no
	}

	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #EXILE_ARRESTED #once only
		trigger = {
			NOT = {
				has_global_flag = KR_exile_arrested
				has_global_flag = { flag = CAN_king_on_tour value > 0 }
			}
			event_target:KR_king_base = {
				surrender_progress < 0.15
				NOT = { tag = GBR }
				check_variable = { king_influence > 1 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				date > 1937.1.1
			}
			modifier = {
				factor = 2
				date > 1938.1.1
			}
			modifier = {
				factor = 2
				date > 1939.1.1
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.52
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #EXILE_SUSPECTED_OF_SPYING #once only
		trigger = {
			NOT = { has_global_flag = KR_exile_spying }
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			event_target:KR_king_base = {
				has_war_with = ENG
				surrender_progress < 0.15
				NOT = { tag = GBR }
				check_variable = { king_influence > 2 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				date > 1939.1.1
			}
			modifier = {
				factor = 2
				date > 1940.1.1
			}
			modifier = {
				factor = 2
				date > 1941.1.1
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.53
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #EXILE_CONFLICT_WITH_GOVT
		trigger = {
			event_target:KR_king_base = {
				surrender_progress < 0.15
				has_elected_government = yes
				NOT = { tag = GBR }
				check_variable = { king_influence > 1 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 0.5
				event_target:KR_king_base = {
					check_variable = { king_influence < 3 }
				}
			}
			modifier = {
				factor = 0.2
				event_target:KR_king_base = {
					has_country_flag = CAN_was_exile_govt_conflict
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.54
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #EXILE_CONFLICT_WITH_KING
		trigger = {
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			event_target:KR_king_base = {
				surrender_progress < 0.15
				NOT = { tag = GBR }
				check_variable = { king_influence > 3 }
			}
		}
		ai_chance = {
			base = 3
			modifier = {
				factor = 0.5
				event_target:KR_king_base = {
					check_variable = { king_influence < 5 }
				}
			}
			modifier = {
				factor = 0
				event_target:KR_king_base = {
					has_country_flag = CAN_was_exile_king_conflict
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.55
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #EXILE_GOOD_FORTUNE
		trigger = {
			event_target:KR_king_base = {
				surrender_progress < 0.15
				NOT = { tag = GBR }
				check_variable = { king_influence < 4 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 0.5
				event_target:KR_king_base = {
					check_variable = { king_influence > 2 }
				}
			}
			modifier = {
				factor = 2
				event_target:KR_king_base = {
					check_variable = { king_influence < 1 }
				}
			}
			modifier = {
				factor = 0.2
				event_target:KR_king_base = {
					has_country_flag = CAN_was_exile_improve
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.56
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #EXILE_POOR_FORTUNE
		trigger = {
			event_target:KR_king_base = {
				surrender_progress < 0.15
				NOT = { tag = GBR }
				check_variable = { king_influence > 2 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 0.5
				event_target:KR_king_base = {
					check_variable = { king_influence < 4 }
				}
			}
			modifier = {
				factor = 2
				event_target:KR_king_base = {
					check_variable = { king_influence > 4 }
				}
			}
			modifier = {
				factor = 0.2
				event_target:KR_king_base = {
					has_country_flag = CAN_was_exile_worsen
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.57
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #KING_LOCAL_SCANDAL
		trigger = {
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			event_target:KR_king_base = {
				surrender_progress < 0.15
				check_variable = { king_popularity > 1 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				ENT_king_george_vi = yes
			}
			modifier = {
				factor = 0.5
				ENT_king_henry_ix = yes
			}
			modifier = {
				factor = 0.2
				event_target:KR_king_base = {
					has_country_flag = CAN_was_king_scandal
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.58
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #KING_GAINS_POPULARITY
		trigger = {
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			event_target:KR_king_base = {
				surrender_progress < 0.15
				check_variable = { king_popularity < 4 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				ENT_king_albert_i = yes
			}
			modifier = {
				factor = 0.5
				ENT_king_henry_ix = yes
			}
			modifier = {
				factor = 0.2
				event_target:KR_king_base = {
					has_country_flag = CAN_was_king_gains_popularity
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_gains_popularity
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.59
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #KING_TIME_OFF
		trigger = {
			event_target:KR_king_base = { surrender_progress < 0.15 }
			NOT = {
				has_global_flag = { flag = CAN_king_on_tour value > 0 }
				has_global_flag = { flag = CAN_king_busy value > 0 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				ENT_king_george_vi = yes
			}
			modifier = {
				factor = 2
				ENT_king_edward_viii = yes
			}
			modifier = {
				factor = 0
				event_target:KR_king_base = {
					has_country_flag = CAN_was_king_needs_time_off
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.60
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #KING_MEETS_WITH_TROOPS
		trigger = {
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			event_target:KR_king_base = {
				surrender_progress < 0.15
				has_war_support < 0.75
				check_variable = { king_popularity > 1 }
			}
		}
		ai_chance = {
			base = 5
			modifier = {
				factor = 2
				ENT_king_henry_ix = yes
			}
			modifier = {
				factor = 2
				event_target:KR_king_base = {
					has_war_support < 0.35
				}
			}
			modifier = {
				factor = 0.5
				event_target:KR_king_base = {
					check_variable = { king_popularity < 3 }
				}
			}
			modifier = {
				factor = 0.2
				event_target:KR_king_base = {
					has_country_flag = CAN_was_king_meets_troops
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.61
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #EDWARD_STORYLINE
		trigger = {
			event_target:KR_king_base = { surrender_progress < 0.15 }
			ENT_king_edward_viii = yes
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			check_variable = { var = global.king_edward_story value = 12 compare = less_than }
			if = {
				limit = { check_variable = { var = global.king_edward_story value = 0 compare = equals } }
				date > 1936.6.1
			}
			else_if = {
				limit = { check_variable = { var = global.king_edward_story value = 1 compare = equals } }
				OR = {
					AND = {
						date > 1937.6.1
						event_target:KR_king_base = { tag = CAN }
						has_global_flag = USA_civil_war_begun_flag
						NOT = { has_global_flag = USA_civil_war_over_flag }
					}
					AND = {
						date > 1938.1.1
						NOT = {
							AND = {
								event_target:KR_king_base = { tag = CAN }
								has_global_flag = USA_civil_war_begun_flag
								NOT = { has_global_flag = USA_civil_war_over_flag }
							}
						}
					}
				}
			}
			else_if = {
				limit = { check_variable = { var = global.king_edward_story value = 2 compare = equals } }
				OR = {
					AND = {
						date > 1938.1.1
						check_variable = { var = global.king_edward_story value = 2 compare = equals }
						has_game_rule = { rule = CAN_king option = CAN_KING_EDWARD }
					}
					AND = {
						date > 1938.6.1
						event_target:KR_king_base = { tag = CAN }
						NOT = {
							has_game_rule = { rule = CAN_king option = CAN_KING_EDWARD }
						}
					}
					AND = {
						date > 1939.1.1
						NOT = {
							event_target:KR_king_base = { tag = CAN }
						}
					}
				}
			}
			else_if = {
				limit = { check_variable = { var = global.king_edward_story value = 3 compare = equals } }
				date > 1939.1.1
				has_global_flag = CAN_edward_met_constance
				NOT = { has_global_flag = { flag = CAN_king_busy value > 0 } }
			}
			else_if = {
				limit = { check_variable = { var = global.king_edward_story value = 4 compare = equals } }
				date > 1939.6.1
			}
			else_if = {
				limit = { check_variable = { var = global.king_edward_story value = 10 compare = equals } }
				date > 1940.1.1
			}
			else_if = {
				limit = { check_variable = { var = global.king_edward_story value = 11 compare = equals } }
				date > 1942.1.1
			}
		}
		ai_chance = {
			base = 50
			modifier = {
				factor = 3
				has_global_flag = CAN_edward_met_constance
			}
			modifier = {
				factor = 10
				OR = {
					has_game_rule = { rule = CAN_king option = CAN_KING_ABDICATES }
					has_game_rule = { rule = CAN_king option = CAN_KING_ALBERT }
					has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
					has_game_rule = { rule = CAN_king option = CAN_KING_GEORGE }
				}
			}
		}
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.62
			country_event = entente.63
			country_event = entente.64
			country_event = entente.65
			country_event = entente.66
			country_event = entente.67
			country_event = entente.68
			country_event = entente.69
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #ALBERT_STORYLINE
		trigger = {
			event_target:KR_king_base = { surrender_progress < 0.15 }
			ENT_king_albert_i = yes
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			check_variable = { var = global.king_albert_story value = 3 compare = less_than }
			if = {
				limit = { check_variable = { var = global.king_albert_story value = 0 compare = equals } }
				event_target:KR_king_base = {
					has_war = yes
					any_enemy_country = { is_actual_major = yes }
				}
			}
			if = {
				limit = { check_variable = { var = global.king_albert_story value = 1 compare = equals } }
				date > 1940.1.1
			}
			if = {
				limit = { check_variable = { var = global.king_albert_story value = 2 compare = equals } }
				GBR = { GBR_albert_windsor = { has_character_flag = { flag = GBR_british_king days > 1095 } } }
			}
		}
		ai_chance = { base = 50 }
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.70
			country_event = entente.71
			country_event = entente.72
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #HENRY_STORYLINE
		trigger = {
			event_target:KR_king_base = { surrender_progress < 0.15 }
			ENT_king_henry_ix = yes
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			check_variable = { var = global.king_henry_story value = 3 compare = less_than }
			if = {
				limit = { check_variable = { var = global.king_henry_story value = 0 compare = equals } }
				event_target:KR_king_base = {
					has_war = yes
					any_enemy_country = { is_actual_major = yes }
				}
			}
			if = {
				limit = { check_variable = { var = global.king_henry_story value = 1 compare = equals } }
				GBR = { GBR_henry_windsor = { has_character_flag = { flag = GBR_british_king days > 120 } } }
				date > 1940.1.1
			}
			if = {
				limit = { check_variable = { var = global.king_henry_story value = 2 compare = equals } }
				date > 1943.6.1
			}
		}
		ai_chance = { base = 50 }
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.73
			country_event = entente.74
			country_event = entente.75
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #GEORGE_STORYLINE
		trigger = {
			event_target:KR_king_base = { surrender_progress < 0.15 }
			ENT_king_george_vi = yes
			NOT = { has_global_flag = { flag = CAN_king_on_tour value > 0 } }
			check_variable = { var = global.king_george_story value = 3 compare = less_than }
			if = {
				limit = { check_variable = { var = global.king_george_story value = 0 compare = equals } }
				event_target:KR_king_base = {
					has_war = yes
					any_enemy_country = { is_actual_major = yes }
				}
			}
			if = {
				limit = { check_variable = { var = global.king_george_story value = 1 compare = equals } }
				GBR = { GBR_george_windsor = { has_character_flag = { flag = GBR_british_king days > 120 } } }
			}
			if = {
				limit = { check_variable = { var = global.king_george_story value = 2 compare = equals } }
				GBR = { GBR_george_windsor = { has_character_flag = { flag = GBR_british_king days > 730 } } }
				NOT = { has_global_flag = { flag = CAN_king_busy value > 0 } }
			}
		}
		ai_chance = { base = 50 }
		event_target:KR_king_base = {
			clr_country_flag = CAN_was_exile_govt_conflict
			clr_country_flag = CAN_was_exile_king_conflict
			clr_country_flag = CAN_was_exile_improve
			clr_country_flag = CAN_was_exile_worsen
			clr_country_flag = CAN_was_king_scandal
			clr_country_flag = CAN_was_king_needs_time_off
			clr_country_flag = CAN_was_king_meets_troops
			country_event = entente.76
			country_event = entente.77
			country_event = entente.78
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.50 option AI_OPTION"
		name = AI_OPTION #NOTHING
		ai_chance = {
			base = 35
			modifier = {
				add = 5
				event_target:KR_king_base = {
					has_elected_government = no
				}
			}
			modifier = {
				add = 5
				event_target:KR_king_base = {
					has_war_support > 0.75
				}
			}
			modifier = {
				add = 20
				event_target:KR_king_base = {
					tag = GBR
				}
			}
			modifier = {
				add = 10
				has_global_flag = { flag = CAN_king_on_tour value > 0 }
			}
		}
		event_target:KR_king_base = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# Member of the Exiles Arrested
country_event = {
	id = entente.52
	title = entente.52.t
	picture = GFX_report_event_generic_reporters

	desc = {
		text = entente.52.d.king
		trigger = {
			check_variable = { king_popularity > 1 }
		}
	}
	desc = {
		text = entente.52.d.noking
		trigger = {
			check_variable = { king_popularity < 2 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_global_flag = KR_exile_arrested
	}

	option = {
		log = "[GetLogInfo]: event entente.52 option entente.52.a"
		name = entente.52.a #Allow the king to intervene personally
		trigger = { check_variable = { king_popularity > 1 } }
		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				check_variable = { king_popularity > 3 }
			}
		}
		custom_effect_tooltip = CAN_king_popularity_decrease
		subtract_from_variable = { king_popularity = 2 }
		CAN_calc_royal_visit_effects = yes
		add_war_support = -0.05
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.52 option entente.52.b"
		name = entente.52.b #Let the trial play out
		ai_chance = {
			base = 50
			modifier = {
				factor = 2
				check_variable = { king_influence > 3 }
			}
		}
		custom_effect_tooltip = CAN_exile_influence_decrease
		if = {
			limit = { check_variable = { king_influence > 1 } }
			subtract_from_variable = { king_influence = 2 }
		}
		else = {
			set_variable = { king_influence = 0 }
		}
		CAN_calc_exile_influence_effects = yes
		add_stability = -0.05
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.52 option entente.52.c"
		name = entente.52.c #The government intervenes
		ai_chance = {
			base = 30
			modifier = {
				factor = 0.5
				has_political_power < 100
			}
			modifier = {
				factor = 0.5
				has_political_power < 0
			}
			modifier = {
				factor = 3
				has_government = paternal_autocrat
			}
			modifier = {
				factor = 2
				OR = {
					has_government = social_conservative
					has_government = authoritarian_democrat
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					has_government = social_liberal
					has_government = market_liberal
				}
			}
			modifier = {
				factor = 0
				OR = {
					has_government = social_democrat
					has_government = national_populist
				}
			}
		}
		add_political_power = -100
		set_temp_variable = { ideology_change_var = -0.1 }
		change_ruling_party_popularity = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# Member of the Exiles Suspected of Spying
country_event = {
	id = entente.53
	title = entente.53.t
	picture = GFX_report_event_generic_scandal

	desc = {
		text = entente.53.d.king
		trigger = {
			check_variable = { king_popularity > 1 }
		}
	}
	desc = {
		text = entente.53.d.noking
		trigger = {
			check_variable = { king_popularity < 2 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_global_flag = KR_exile_spying
	}

	option = {
		log = "[GetLogInfo]: event entente.53 option entente.53.a"
		name = entente.53.a #Allow the king to intervene personally
		trigger = { check_variable = { king_popularity > 1 } }
		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				check_variable = { king_popularity > 3 }
			}
		}
		custom_effect_tooltip = CAN_king_popularity_decrease
		subtract_from_variable = { king_popularity = 2 }
		CAN_calc_royal_visit_effects = yes
		add_war_support = -0.10
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.53 option entente.53.b"
		name = entente.53.b #Let the trial play out
		ai_chance = {
			base = 50
			modifier = {
				factor = 2
				check_variable = { king_influence > 3 }
			}
		}
		custom_effect_tooltip = CAN_exile_influence_decrease
		if = {
			limit = { check_variable = { king_influence > 1 } }
			subtract_from_variable = { king_influence = 2 }
		}
		else = {
			set_variable = { king_influence = 0 }
		}
		CAN_calc_exile_influence_effects = yes
		add_stability = -0.05
		add_war_support = -0.05
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.53 option entente.53.c"
		name = entente.53.c #Intervene and cover it up
		ai_chance = {
			base = 30
			modifier = {
				factor = 0.5
				has_political_power < 100
			}
			modifier = {
				factor = 0.5
				has_political_power < 0
			}
			modifier = {
				factor = 3
				has_government = paternal_autocrat
			}
			modifier = {
				factor = 2
				OR = {
					has_government = social_conservative
					has_government = authoritarian_democrat
				}
			}
			modifier = {
				factor = 0.5
				OR = {
					has_government = social_liberal
					has_government = market_liberal
				}
			}
			modifier = {
				factor = 0
				OR = {
					has_government = social_democrat
					has_government = national_populist
				}
			}
		}
		add_political_power = -100
		set_temp_variable = { ideology_change_var = -0.1 }
		change_ruling_party_popularity = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# Exiles conflict with government
country_event = {
	id = entente.54
	title = entente.54.t
	picture = GFX_report_event_CAN_cabinet

	desc = {
		text = entente.54.d.1
		trigger = {
			check_variable = { desc_num < 2 }
		}
	}
	desc = {
		text = entente.54.d.2
		trigger = {
			check_variable = { desc_num > 1 }
			check_variable = { desc_num < 3 }
		}
	}
	desc = {
		text = entente.54.d.3
		trigger = {
			check_variable = { desc_num > 2 }
			check_variable = { desc_num < 4 }
		}
	}
	desc = {
		text = entente.54.d.4
		trigger = {
			check_variable = { desc_num > 3 }
			check_variable = { desc_num < 5 }
		}
	}
	desc = {
		text = entente.54.d.5
		trigger = {
			check_variable = { desc_num > 4 }
			check_variable = { desc_num < 6 }
		}
	}
	desc = {
		text = entente.54.d.6
		trigger = {
			check_variable = { desc_num > 5 }
			check_variable = { desc_num < 7 }
		}
	}
	desc = {
		text = entente.54.d.7
		trigger = {
			check_variable = { desc_num > 6 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_exile_govt_conflict
		set_variable = { desc_num = random }
		multiply_variable = { desc_num = 8 }
		round_variable = desc_num
	}

	option = {
		log = "[GetLogInfo]: event entente.54 option entente.54.a"
		name = entente.54.a #Support the government
		ai_chance = {
			base = 25
			modifier = {
				factor = 3
				OR = {
					has_government = social_liberal
					has_government = market_liberal
				}
			}
		}
		add_war_support = -0.10
		custom_effect_tooltip = CAN_exile_influence_decrease
		if = {
			limit = { check_variable = { king_influence > 0 } }
			subtract_from_variable = { king_influence = 1 }
		}
		else = {
			set_variable = { king_influence = 0 }
		}
		CAN_calc_exile_influence_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.54 option entente.54.b"
		name = entente.54.b #Support the British Exiles
		ai_chance = {
			base = 25
			modifier = {
				factor = 3
				has_government = social_conservative
			}
			modifier = {
				factor = 0
				has_government = social_democrat
			}
		}
		add_political_power = -50
		set_temp_variable = { ideology_change_var = -0.05 }
		change_ruling_party_popularity = yes
		if = {
			limit = { check_variable = { king_influence < 5 } }
			custom_effect_tooltip = CAN_exile_influence_increase
			add_to_variable = { king_influence = 1 }
			CAN_calc_exile_influence_effects = yes
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.54 option entente.54.c"
		name = entente.54.c #Stand back and let the chips fall where they may
		ai_chance = { base = 50 }
		add_war_support = -0.05
		add_political_power = -50
		if = {
			limit = { check_variable = { king_influence > 0 } }
			custom_effect_tooltip = CAN_exile_influence_decrease_50
			hidden_effect = {
				set_variable = { event_num = random }
				multiply_variable = { event_num = 100 }
				round_variable = event_num
				if = {
					limit = { check_variable = { event_num < 50 } }
					subtract_from_variable = { king_influence = 1 }
					CAN_calc_exile_influence_effects = yes
				}
				clear_variable = event_num
			}
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# Exiles conflict with king
country_event = {
	id = entente.55
	title = entente.55.t
	desc = entente.55.d
	picture = GFX_report_event_CAN_cabinet

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_exile_king_conflict
	}

	option = {
		log = "[GetLogInfo]: event entente.55 option entente.55.a"
		name = entente.55.a
		custom_effect_tooltip = CAN_exile_influence_decrease
		if = {
			limit = { check_variable = { king_influence > 0 } }
			subtract_from_variable = { king_influence = 1 }
		}
		else = {
			set_variable = { king_influence = 0 }
		}
		CAN_calc_exile_influence_effects = yes
		if = {
			limit = { check_variable = { king_popularity > 0 } }
			custom_effect_tooltip = CAN_king_popularity_decrease_50
			hidden_effect = {
				set_variable = { event_num = random }
				multiply_variable = { event_num = 100 }
				round_variable = event_num
				if = {
					limit = { check_variable = { event_num < 50 } }
					subtract_from_variable = { king_popularity = 1 }
					CAN_calc_royal_visit_effects = yes
				}
				clear_variable = event_num
			}
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
			if = {
				limit = { tag = CAN }
				set_country_flag = CAN_king_replaces_pm
			}
		}
	}
}

# Exiles fortunes improve
country_event = {
	id = entente.56
	title = entente.56.t
	picture = GFX_report_event_CAN_cabinet

	desc = {
		text = entente.56.d.1
		trigger = {
			check_variable = { desc_num < 2 }
		}
	}
	desc = {
		text = entente.56.d.2
		trigger = {
			check_variable = { desc_num > 1 }
			check_variable = { desc_num < 3 }
		}
	}
	desc = {
		text = entente.56.d.3
		trigger = {
			check_variable = { desc_num > 2 }
			check_variable = { desc_num < 4 }
		}
	}
	desc = {
		text = entente.56.d.4
		trigger = {
			check_variable = { desc_num > 3 }
			check_variable = { desc_num < 5 }
		}
	}
	desc = {
		text = entente.56.d.5
		trigger = {
			check_variable = { desc_num > 4 }
			check_variable = { desc_num < 6 }
		}
	}
	desc = {
		text = entente.56.d.6
		trigger = {
			check_variable = { desc_num > 5 }
			check_variable = { desc_num < 7 }
		}
	}
	desc = {
		text = entente.56.d.7
		trigger = {
			check_variable = { desc_num > 6 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_exile_improve
		set_variable = { desc_num = random }
		multiply_variable = { desc_num = 8 }
		round_variable = desc_num
	}

	option = {
		log = "[GetLogInfo]: event entente.56 option entente.56.a"
		name = entente.56.a
		if = {
			limit = { check_variable = { king_influence < 5 } }
			custom_effect_tooltip = CAN_exile_influence_increase
			add_to_variable = { king_influence = 1 }
			CAN_calc_exile_influence_effects = yes
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# Exiles fortunes worsen
country_event = {
	id = entente.57
	title = entente.57.t
	picture = GFX_report_event_CAN_cabinet

	desc = {
		text = entente.57.d.1
		trigger = {
			check_variable = { desc_num < 2 }
		}
	}
	desc = {
		text = entente.57.d.2
		trigger = {
			check_variable = { desc_num > 1 }
			check_variable = { desc_num < 3 }
		}
	}
	desc = {
		text = entente.57.d.3
		trigger = {
			check_variable = { desc_num > 2 }
			check_variable = { desc_num < 4 }
		}
	}
	desc = {
		text = entente.57.d.4
		trigger = {
			check_variable = { desc_num > 3 }
			check_variable = { desc_num < 5 }
		}
	}
	desc = {
		text = entente.57.d.5
		trigger = {
			check_variable = { desc_num > 4 }
			check_variable = { desc_num < 6 }
		}
	}
	desc = {
		text = entente.57.d.6
		trigger = {
			check_variable = { desc_num > 5 }
			check_variable = { desc_num < 7 }
		}
	}
	desc = {
		text = entente.57.d.7
		trigger = {
			check_variable = { desc_num > 6 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_exile_worsen
		set_variable = { desc_num = random }
		multiply_variable = { desc_num = 8 }
		round_variable = desc_num
	}

	option = {
		log = "[GetLogInfo]: event entente.57 option entente.57.a"
		name = entente.57.a
		custom_effect_tooltip = CAN_exile_influence_decrease
		if = {
			limit = { check_variable = { king_influence > 0 } }
			subtract_from_variable = { king_influence = 1 }
		}
		else = {
			set_variable = { king_influence = 0 }
		}
		CAN_calc_exile_influence_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King in scandal
country_event = {
	id = entente.58
	title = entente.58.t
	picture = GFX_report_event_generic_scandal

	desc = {
		text = entente.58.d.1
		trigger = {
			check_variable = { desc_num < 2 }
		}
	}
	desc = {
		text = entente.58.d.2
		trigger = {
			check_variable = { desc_num > 1 }
			check_variable = { desc_num < 3 }
		}
	}
	desc = {
		text = entente.58.d.3
		trigger = {
			check_variable = { desc_num > 2 }
			check_variable = { desc_num < 4 }
		}
	}
	desc = {
		text = entente.58.d.4
		trigger = {
			check_variable = { desc_num > 3 }
			check_variable = { desc_num < 5 }
		}
	}
	desc = {
		text = entente.58.d.5
		trigger = {
			check_variable = { desc_num > 4 }
			check_variable = { desc_num < 6 }
		}
	}
	desc = {
		text = entente.58.d.6
		trigger = {
			check_variable = { desc_num > 5 }
			check_variable = { desc_num < 7 }
		}
	}
	desc = {
		text = entente.58.d.7
		trigger = {
			check_variable = { desc_num > 6 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_king_scandal
		set_variable = { desc_num = random }
		multiply_variable = { desc_num = 8 }
		round_variable = desc_num
	}

	option = {
		log = "[GetLogInfo]: event entente.58 option entente.58.a"
		name = entente.58.a
		custom_effect_tooltip = CAN_king_popularity_decrease
		if = {
			limit = { check_variable = { king_popularity > 0 } }
			subtract_from_variable = { king_popularity = 1 }
		}
		else = {
			set_variable = { king_popularity = 0 }
		}
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King's popularity increases
country_event = {
	id = entente.59
	title = entente.59.t
	picture = GFX_report_event_royal_visit

	desc = {
		text = entente.59.d.1
		trigger = {
			check_variable = { desc_num < 2 }
		}
	}
	desc = {
		text = entente.59.d.2
		trigger = {
			check_variable = { desc_num > 1 }
			check_variable = { desc_num < 3 }
		}
	}
	desc = {
		text = entente.59.d.3
		trigger = {
			check_variable = { desc_num > 2 }
			check_variable = { desc_num < 4 }
		}
	}
	desc = {
		text = entente.59.d.4
		trigger = {
			check_variable = { desc_num > 3 }
			check_variable = { desc_num < 5 }
		}
	}
	desc = {
		text = entente.59.d.5
		trigger = {
			check_variable = { desc_num > 4 }
			check_variable = { desc_num < 6 }
		}
	}
	desc = {
		text = entente.59.d.6
		trigger = {
			check_variable = { desc_num > 5 }
			check_variable = { desc_num < 7 }
		}
	}
	desc = {
		text = entente.59.d.7
		trigger = {
			check_variable = { desc_num > 6 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_king_gains_popularity
		set_variable = { desc_num = random }
		multiply_variable = { desc_num = 8 }
		round_variable = desc_num
	}

	option = {
		log = "[GetLogInfo]: event entente.59 option entente.59.a"
		name = entente.59.a
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King needs time off
country_event = {
	id = entente.60
	title = entente.60.t
	picture = GFX_report_event_royal_visit

	desc = {
		text = entente.60.d.1
		trigger = {
			check_variable = { desc_num < 2 }
		}
	}
	desc = {
		text = entente.60.d.2
		trigger = {
			check_variable = { desc_num > 1 }
			check_variable = { desc_num < 3 }
		}
	}
	desc = {
		text = entente.60.d.3
		trigger = {
			check_variable = { desc_num > 2 }
		}
	}

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_king_needs_time_off
		set_variable = { desc_num = random }
		multiply_variable = { desc_num = 3 }
		round_variable = desc_num
		set_variable = { time_off = random }
		multiply_variable = { time_off = 120 }
		round_variable = time_off
		clamp_variable = { var = time_off max = 120 min = 90 }
	}

	option = {
		log = "[GetLogInfo]: event entente.60 option entente.60.a"
		name = entente.60.a
		custom_effect_tooltip = CAN_king_takes_time_off
		hidden_effect = {
			meta_effect = {
				text = {
					set_global_flag = {
						flag = CAN_king_busy
						days = [time_off_var]
						value = 1
					}
				}
				time_off_var = "[?time_off|0]"
			}
			if = {
				limit = { check_variable = { desc_num < 2 } }
				meta_effect = {
					text = {
						set_global_flag = {
							flag = CAN_king_on_tour
							days = [time_off_var]
							value = 1
						}
					}
					time_off_var = "[?time_off|0]"
				}
			}
			clear_variable = time_off
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King meets with troops
country_event = {
	id = entente.61
	title = entente.61.t
	desc = entente.61.d
	picture = GFX_report_event_CAN_king_army

	is_triggered_only = yes

	immediate = {
		set_country_flag = CAN_was_king_meets_troops
	}

	option = {
		log = "[GetLogInfo]: event entente.61 option entente.61.a"
		name = entente.61.a
		add_war_support = 0.05
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Edward - story #1 party
country_event = {
	id = entente.62
	title = entente.62.t
	picture = GFX_report_event_CAN_edward_party

	desc = {
		text = entente.62.d.nothome
		trigger = { NOT = { tag = GBR } }
	}
	desc = {
		text = entente.62.d.home
		trigger = { tag = GBR }
	}

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_edward_story value = 0 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.62 option entente.62.a"
		name = entente.62.a
		set_variable = { global.king_edward_story = 1 }
		if = {
			limit = { check_variable = { king_popularity > 2 } }
			custom_effect_tooltip = CAN_king_popularity_decrease
			subtract_from_variable = { king_popularity = 1 }
			CAN_calc_royal_visit_effects = yes
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Edward - story #2 meet refugees
country_event = {
	id = entente.63
	title = entente.63.t
	desc = entente.63.d
	picture = GFX_report_event_CAN_edward_meet

	is_triggered_only = yes

	trigger = {
		tag = CAN
		check_variable = { var = global.king_edward_story value = 1 compare = equals }
		date > 1937.6.1
		has_global_flag = USA_civil_war_begun_flag
		NOT = { has_global_flag = USA_civil_war_over_flag }
	}

	option = {
		log = "[GetLogInfo]: event entente.63 option entente.63.a"
		name = entente.63.a
		set_variable = { global.king_edward_story = 2 }
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Edward - story #3 seen with Bennett
country_event = {
	id = entente.64
	title = entente.64.t
	picture = GFX_report_event_CAN_constance

	desc = {
		text = entente.64.d.nee
		trigger = {
			NOT = { has_global_flag = USA_civil_war_over_flag }
			country_exists = NEE
			is_in_faction_with = NEE
		}
	}
	desc = {
		text = entente.64.d.nonee
		trigger = {
			NOT = { has_global_flag = USA_civil_war_over_flag }
			OR = {
				NOT = { country_exists = NEE }
				NOT = { is_in_faction_with = NEE }
			}
		}
	}
	desc = {
		text = entente.64.d.noacw
		trigger = {
			has_global_flag = USA_civil_war_over_flag
		}
	}

	is_triggered_only = yes

	trigger = {
		tag = CAN
		check_variable = { var = global.king_edward_story value = 2 compare = equals }
		date > 1938.6.1
		NOT = {
			has_game_rule = { rule = CAN_king option = CAN_KING_EDWARD }
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.64 option entente.64.a"
		name = entente.64.a
		set_global_flag = CAN_edward_met_constance
		set_variable = { global.king_edward_story = 3 }
		if = {
			limit = { check_variable = { king_popularity > 0 } }
			custom_effect_tooltip = CAN_king_popularity_decrease
			subtract_from_variable = { king_popularity = 1 }
			CAN_calc_royal_visit_effects = yes
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Edward - story #4 wants to marry Bennett
country_event = {
	id = entente.65
	title = entente.65.t
	picture = GFX_report_event_CAN_edward2

	desc = {
		text = entente.65.d.norm
		trigger = { NOT = { has_government = paternal_autocrat } }
	}
	desc = {
		text = entente.65.d.pataut
		trigger = { has_government = paternal_autocrat }
	}

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_edward_story value = 3 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.65 option entente.65.a"
		name = entente.65.a
		set_variable = { global.king_edward_story = 4 }
		if = {
			limit = { check_variable = { king_popularity > 0 } }
			custom_effect_tooltip = CAN_king_popularity_decrease
			subtract_from_variable = { king_popularity = 1 }
			CAN_calc_royal_visit_effects = yes
		}

		if = {
			limit = {
				NOT = { tag = GBR }
				has_government = paternal_autocrat
				check_variable = { king_influence > 1 }
			}
			custom_effect_tooltip = CAN_exile_influence_decrease
			subtract_from_variable = { king_influence = 2 }
			CAN_calc_exile_influence_effects = yes
		}
		else_if = {
			limit = {
				NOT = { tag = GBR }
				has_government = paternal_autocrat
				check_variable = { king_influence > 0 }
			}
			custom_effect_tooltip = CAN_exile_influence_decrease
			subtract_from_variable = { king_influence = 1 }
			CAN_calc_exile_influence_effects = yes
		}

		if = {
			limit = { has_government = paternal_autocrat }
			add_stability = -0.05
			add_political_power = -100
			hidden_effect = {
				country_event = { id = entente.50 days = 90 random_days = 60 }
			}
		}
		else = {
			set_global_flag = CAN_king_busy
			country_event = { id = entente.100 days = 1 } #start the crisis
		}
	}
}

# King Edward - story #5 romance with Katherine
country_event = {
	id = entente.66
	title = entente.66.t
	desc = entente.66.d
	picture = GFX_report_event_CAN_katherine

	is_triggered_only = yes

	trigger = {
		OR = {
			AND = {
				date > 1938.1.1
				check_variable = { var = global.king_edward_story value = 2 compare = equals }
				has_game_rule = { rule = CAN_king option = CAN_KING_EDWARD }
			}
			AND = {
				date > 1938.1.1
				check_variable = { var = global.king_edward_story value = 1 compare = equals }
				NOT = {
					AND = {
						tag = CAN
						has_global_flag = USA_civil_war_begun_flag
						NOT = { has_global_flag = USA_civil_war_over_flag }
					}
				}
			}
			AND = {
				date > 1939.1.1
				check_variable = { var = global.king_edward_story value = 2 compare = equals }
				NOT = {
					tag = CAN
				}
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.66 option entente.66.a"
		name = entente.66.a
		set_variable = { global.king_edward_story = 10 }
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Edward - story #6 royal wedding - Bennett
country_event = {
	id = entente.67
	title = entente.67.t
	desc = entente.67.d
	picture = GFX_report_event_CAN_edward_wedding

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_edward_story value = 4 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.67 option entente.67.a"
		name = entente.67.a
		set_variable = { global.king_edward_story = 11 }
		if = {
			limit = { check_variable = { king_popularity < 5 } }
			custom_effect_tooltip = CAN_king_popularity_increase
			add_to_variable = { king_popularity = 1 }
			CAN_calc_royal_visit_effects = yes
		}
		hidden_effect = {
			save_event_target_as = wedding_country
			random_other_country = {
				limit = { is_ai = yes }
				news_event = entente.90
			}
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Edward - story #7 royal wedding - Katherine
country_event = {
	id = entente.68
	title = entente.68.t
	desc = entente.68.d
	picture = GFX_report_event_royal_parade

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_edward_story value = 10 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.68 option entente.68.a"
		name = entente.68.a
		set_variable = { global.king_edward_story = 11 }
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			save_event_target_as = wedding_country
			random_other_country = {
				limit = { is_ai = yes }
				news_event = entente.91
			}
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Edward - story #8 marriage issues
country_event = {
	id = entente.69
	title = entente.69.t
	picture = GFX_report_event_CAN_edward2

	is_triggered_only = yes

	desc = {
		text = entente.69.d.constance
		trigger = { has_global_flag = CAN_edward_met_constance }
	}
	desc = {
		text = entente.69.d.katherine
		trigger = { NOT = { has_global_flag = CAN_edward_met_constance } }
	}

	trigger = {
		check_variable = { var = global.king_edward_story value = 11 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.69 option entente.69.a"
		name = entente.69.a
		set_variable = { global.king_edward_story = 12 }
		if = {
			limit = { check_variable = { king_popularity > 2 } }
			custom_effect_tooltip = CAN_king_popularity_decrease
			subtract_from_variable = { king_popularity = 1 }
			CAN_calc_royal_visit_effects = yes
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Albert - story #1 war address
country_event = {
	id = entente.70
	title = entente.70.t
	desc = entente.70.d
	picture = GFX_report_event_CAN_albert

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_albert_story value = 0 compare = equals }
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = { has_war_with = ENG }
				ENG = { save_event_target_as = war_country }
			}
			else_if = {
				limit = { has_war_with = GER }
				GER = { save_event_target_as = war_country }
			}
			else = {
				random_country = {
					limit = {
						is_actual_major = yes
						has_war_with = ROOT
					}
					save_event_target_as = war_country
				}
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.70 option entente.70.a"
		name = entente.70.a
		set_variable = { global.king_albert_story = 1 }
		add_war_support = 0.05
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Albert - story #2 princess elizabeth
country_event = {
	id = entente.71
	title = entente.71.t
	desc = entente.71.d
	picture = GFX_report_event_CAN_elizabeth

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_albert_story value = 1 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.71 option entente.71.a"
		name = entente.71.a
		set_variable = { global.king_albert_story = 2 }
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Albert - story #3 celebration
country_event = {
	id = entente.72
	title = entente.72.t
	desc = entente.72.d
	picture = GFX_report_event_CAN_albert

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_albert_story value = 2 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.72 option entente.72.a"
		name = entente.72.a
		set_variable = { global.king_albert_story = 3 }
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Henry - story #1 war address
country_event = {
	id = entente.73
	title = entente.73.t
	desc = entente.73.d
	picture = GFX_report_event_CAN_henry

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_henry_story value = 0 compare = equals }
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = { has_war_with = ENG }
				ENG = { save_event_target_as = war_country }
			}
			else_if = {
				limit = { has_war_with = GER }
				GER = { save_event_target_as = war_country }
			}
			else = {
				random_country = {
					limit = {
						is_actual_major = yes
						has_war_with = ROOT
					}
					save_event_target_as = war_country
				}
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.73 option entente.73.a"
		name = entente.73.a
		set_variable = { global.king_henry_story = 1 }
		add_war_support = 0.05
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Henry - story #2 Queen Alice
country_event = {
	id = entente.74
	title = entente.74.t
	desc = entente.74.d
	picture = GFX_report_event_CAN_alice

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_henry_story value = 1 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.74 option entente.74.a"
		name = entente.74.a
		set_variable = { global.king_henry_story = 2 }
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King Henry - story #3 birth of Prince William
country_event = {
	id = entente.75
	title = entente.75.t
	desc = entente.75.d
	picture = GFX_report_event_CAN_henry

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_henry_story value = 2 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.75 option entente.75.a"
		name = entente.75.a
		set_variable = { global.king_henry_story = 3 }
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King George - story #1 war address
country_event = {
	id = entente.76
	title = entente.76.t
	desc = entente.76.d
	picture = GFX_report_event_CAN_george

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_george_story value = 0 compare = equals }
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = { has_war_with = ENG }
				ENG = { save_event_target_as = war_country }
			}
			else_if = {
				limit = { has_war_with = GER }
				GER = { save_event_target_as = war_country }
			}
			else = {
				random_country = {
					limit = {
						is_actual_major = yes
						has_war_with = ROOT
					}
					save_event_target_as = war_country
				}
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.76 option entente.76.a"
		name = entente.76.a
		add_war_support = 0.05
		set_variable = { global.king_george_story = 1 }
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King George - story #2 Prince Edward
country_event = {
	id = entente.77
	title = entente.77.t
	desc = entente.77.d
	picture = GFX_report_event_CAN_edward_heir

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_george_story value = 1 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.77 option entente.77.a"
		name = entente.77.a
		set_variable = { global.king_george_story = 2 }
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# King George - story #3 plane crash
country_event = {
	id = entente.78
	title = entente.78.t
	desc = entente.78.d
	picture = GFX_report_event_CAN_george

	is_triggered_only = yes

	trigger = {
		check_variable = { var = global.king_george_story value = 2 compare = equals }
	}

	option = {
		log = "[GetLogInfo]: event entente.78 option entente.78.a"
		name = entente.78.a
		set_variable = { global.king_george_story = 3 }
		custom_effect_tooltip = CAN_king_takes_time_off
		set_global_flag = { flag = CAN_king_busy days = 180 value = 1 }
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# News - Edward marries Constance Bennett
news_event = {
	id = entente.90
	immediate = { log = "[GetLogInfo]: event entente.90" }
	title = entente.90.t
	desc = entente.90.d
	picture = GFX_news_event_CAN_constance

	major = yes
	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	show_major = {
		NOT = { tag = event_target:wedding_country }
		OR = {
			regional_europe_news = yes
			regional_north_america_news = yes
		}
	}
	option = {
		name = entente.90.a
		trigger = { CAN_is_commonwealth_tag = yes }
	}
	option = {
		name = entente.90.b
		trigger = { CAN_is_commonwealth_tag = no }
	}
}

# News - Edward marries Princess Katherine
news_event = {
	id = entente.91
	immediate = { log = "[GetLogInfo]: event entente.91" }
	title = entente.91.t
	desc = entente.91.d
	picture = GFX_news_event_royal_visit

	major = yes
	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	show_major = {
		NOT = { tag = event_target:wedding_country }
		OR = {
			regional_europe_news = yes
			regional_north_america_news = yes
		}
	}
	option = {
		name = entente.90.a
		trigger = { CAN_is_commonwealth_tag = yes }
	}
	option = {
		name = entente.90.b
		trigger = { CAN_is_commonwealth_tag = no }
	}
}

### Abdication Crisis

# Government divided over marriage
country_event = {
	id = entente.100
	title = entente.100.t
	picture = GFX_report_event_CAN_cabinet

	desc = {
		text = entente.100.d.exiles
		trigger = { NOT = { tag = GBR } }
	}
	desc = {
		text = entente.100.d.home
		trigger = { tag = GBR }
	}

	is_triggered_only = yes

	trigger = {
		has_country_flag = KR_british_king_base
	}

	option = {
		log = "[GetLogInfo]: event entente.100 option entente.100.a"
		name = entente.100.a
		if = {
			limit = {
				NOT = { tag = GBR }
				check_variable = { king_influence > 1 }
			}
			custom_effect_tooltip = CAN_exile_influence_decrease
			subtract_from_variable = { king_influence = 2 }
			CAN_calc_exile_influence_effects = yes
		}
		else_if = {
			limit = {
				NOT = { tag = GBR }
				check_variable = { king_influence > 0 }
			}
			custom_effect_tooltip = CAN_exile_influence_decrease
			subtract_from_variable = { king_influence = 1 }
			CAN_calc_exile_influence_effects = yes
		}
		add_stability = -0.05
		set_variable = { king_support = king_popularity }
		every_other_country = {
			limit = {
				exists = yes
				CAN_is_commonwealth_tag = yes
				has_socialist_government = no
				is_in_faction_with = ROOT
			}
			country_event = entente.101
		}
		hidden_effect = {
			country_event = { id = entente.104 days = 5 }
		}
	}
}

# Dominions informed of crisis
country_event = {
	id = entente.101
	title = entente.101.t
	desc = entente.101.d
	picture = GFX_report_event_CAN_edward2

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.101 option entente.101.a"
		name = entente.101.a #We support the king, no matter what
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				OR = {
					tag = RAJ
					tag = JAM
				}
			}
			modifier = {
				factor = 0
				tag = CAN
				OR = {
					has_government = market_liberal
					has_government = social_liberal
				}
			}
			modifier = {
				factor = 0
				tag = SAF
				has_government = authoritarian_democrat
			}
			modifier = {
				factor = 2
				NOT = { tag = SAF }
				has_government = authoritarian_democrat
			}
			modifier = {
				factor = 0
				has_government = social_democrat
			}
			modifier = {
				factor = 2
				has_government = social_conservative
			}
			modifier = {
				factor = 3
				has_government = paternal_autocrat
			}
		}
		FROM = {
			country_event = { id = entente.102 days = 1 random_hours = 72 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.101 option entente.101.b"
		name = entente.101.b #If he pursues this, he must abdicate
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				OR = {
					tag = RAJ
					tag = JAM
				}
			}
			modifier = {
				factor = 2
				NOT = { tag = CAN }
				OR = {
					has_government = market_liberal
					has_government = social_liberal
				}
			}
			modifier = {
				factor = 0
				tag = AST
				has_government = national_populist
			}
			modifier = {
				factor = 2
				NOT = { tag = AST }
				has_government = national_populist
			}
		}
		FROM = {
			country_event = { id = entente.103 days = 1 random_hours = 72 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.101 option entente.101.c"
		name = entente.101.c #We have no interest in weighing in on the matter
		ai_chance = {
			base = 10
			modifier = {
				factor = 0
				OR = {
					tag = CAN
					tag = GBR
					tag = AST
					tag = NZL
					tag = SAF
					tag = WIF
				}
			}
		}
	}
}

# Dominion supports the king
country_event = {
	id = entente.102
	title = entente.102.t
	desc = entente.102.d
	picture = GFX_report_event_CAN_edward_meet

	is_triggered_only = yes

	trigger = {
		has_country_flag = KR_british_king_base
	}

	option = {
		log = "[GetLogInfo]: event entente.102 option entente.102.a"
		name = entente.102.a
		add_to_variable = { king_support = 1 }
	}
}

# Dominion believes the king should abdicate
country_event = {
	id = entente.103
	title = entente.103.t
	desc = entente.103.d
	picture = GFX_report_event_CAN_edward_party

	is_triggered_only = yes

	trigger = {
		has_country_flag = KR_british_king_base
	}

	option = {
		log = "[GetLogInfo]: event entente.103 option entente.103.a"
		name = entente.103.a
		subtract_from_variable = { king_support = 1 }
	}
}

# King makes plea
country_event = {
	id = entente.104
	title = entente.104.t
	desc = entente.104.d
	picture = GFX_report_event_CAN_edward2

	is_triggered_only = yes

	trigger = {
		has_country_flag = KR_british_king_base
	}

	option = {
		log = "[GetLogInfo]: event entente.104 option entente.104.a"
		name = entente.104.a
		add_political_power = -100
		hidden_effect = {
			if = {
				limit = {
					check_variable = { king_popularity > 1 }
					check_variable = { king_support > 3 }
					NOT = {
						has_game_rule = { rule = CAN_king option = CAN_KING_ABDICATES }
						has_game_rule = { rule = CAN_king option = CAN_KING_ALBERT }
						has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
						has_game_rule = { rule = CAN_king option = CAN_KING_GEORGE }
					}
				}
				# king is too popular to abdicate
				country_event = { id = entente.105 days = 1 }
			}
			else_if = {
				limit = {
					NOT = { tag = GBR }
					NOT = { has_government = authoritarian_democrat }
					check_variable = { king_influence > 3 }
					NOT = {
						has_game_rule = { rule = CAN_king option = CAN_KING_ABDICATES }
						has_game_rule = { rule = CAN_king option = CAN_KING_ALBERT }
						has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
						has_game_rule = { rule = CAN_king option = CAN_KING_GEORGE }
					}
				}
				# king's allies prevent him from abdicating
				country_event = { id = entente.106 days = 1 }
			}
			else_if = {
				limit = {
					NOT = { tag = GBR }
					has_government = authoritarian_democrat
					check_variable = { king_influence > 2 }
					NOT = {
						has_game_rule = { rule = CAN_king option = CAN_KING_ABDICATES }
						has_game_rule = { rule = CAN_king option = CAN_KING_ALBERT }
						has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
						has_game_rule = { rule = CAN_king option = CAN_KING_GEORGE }
					}
				}
				# king's allies prevent him from abdicating
				country_event = { id = entente.106 days = 1 }
			}
			else = {
				# abdication decision event
				country_event = { id = entente.107 days = 1 }
			}
		}
	}
}

# King too popular to abdicate
country_event = {
	id = entente.105
	title = entente.105.t
	desc = entente.105.d
	picture = GFX_report_event_CAN_crowd2

	trigger = {
		FROM = { has_country_flag = KR_british_king_base }
	}

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			tag = FROM
			AND = {
				CAN_is_commonwealth_tag = yes
				has_socialist_government = no
				is_in_faction_with = FROM
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.105 option entente.105.a"
		name = entente.105.a
		trigger = { tag = FROM }
		clr_global_flag = CAN_king_busy
		add_political_power = 50
		custom_effect_tooltip = CAN_king_popularity_increase
		add_to_variable = { king_popularity = 1 }
		CAN_calc_royal_visit_effects = yes
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.105 option entente.105.a"
		name = entente.105.a
		trigger = { NOT = { tag = FROM } }
	}
}

# King's allies prevent him from abdicating
country_event = {
	id = entente.106
	title = entente.106.t
	desc = entente.106.d
	picture = GFX_report_event_CAN_cabinet

	trigger = {
		FROM = { has_country_flag = KR_british_king_base }
	}

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			tag = FROM
			AND = {
				CAN_is_commonwealth_tag = yes
				has_socialist_government = no
				is_in_faction_with = FROM
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.106 option entente.106.a"
		name = entente.106.a
		trigger = { tag = FROM }
		add_political_power = -50
		clr_global_flag = CAN_king_busy
		CAN_king_becomes_unpopular = yes
		custom_effect_tooltip = CAN_exile_influence_decrease
		set_variable = { king_influence = 0 }
		CAN_calc_exile_influence_effects = yes
		if = {
			limit = { check_variable = { king_popularity > 0 } }
			custom_effect_tooltip = CAN_king_popularity_decrease
			subtract_from_variable = { king_popularity = 1 }
			CAN_calc_royal_visit_effects = yes
		}
		hidden_effect = {
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.106 option entente.106.a"
		name = entente.106.a
		trigger = { NOT = { tag = FROM } }
	}
}

# Abdication possible
country_event = {
	id = entente.107
	title = entente.107.t
	desc = entente.107.d
	picture = GFX_report_event_CAN_commons2

	is_triggered_only = yes

	trigger = {
		has_country_flag = KR_british_king_base
	}

	option = {
		log = "[GetLogInfo]: event entente.107 option entente.107.a"
		name = entente.107.a #For the good of the Empire, he must abdicate
		ai_chance = {
			base = 80
			modifier = {
				factor = 0.5
				check_variable = { king_support > 3 }
			}
			modifier = {
				factor = 0.5
				check_variable = { king_popularity > 1 }
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_king option = CAN_KING_EDWARD }
			}
		}
		custom_effect_tooltip = CAN_edward_will_step_down
		if = {
			limit = {
				check_variable = { king_popularity > 1 }
			}
			add_stability = -0.10
			add_political_power = -100
			set_temp_variable = { ideology_change_var = -0.1 }
			change_ruling_party_popularity = yes
		}
		else_if = {
			limit = {
				check_variable = { king_popularity < 2 }
				check_variable = { king_popularity > 0 }
			}
			add_stability = -0.10
			add_political_power = -50
			set_temp_variable = { ideology_change_var = -0.05 }
			change_ruling_party_popularity = yes
		}
		else = {
			add_stability = -0.05
		}
		country_event = entente.108
	}
	option = {
		log = "[GetLogInfo]: event entente.107 option entente.107.b"
		name = entente.107.b #He is our King, and he remains so!
		ai_chance = {
			base = 20
			modifier = {
				factor = 0.5
				check_variable = { king_popularity < 1 }
			}
			modifier = {
				factor = 0.5
				check_variable = { king_support < 0 }
			}
			modifier = {
				factor = 1.5
				check_variable = { king_support > 2 }
			}
			modifier = {
				factor = 2
				check_variable = { king_popularity > 0 }
			}
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = CAN_king option = CAN_KING_ABDICATES }
					has_game_rule = { rule = CAN_king option = CAN_KING_ALBERT }
					has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
					has_game_rule = { rule = CAN_king option = CAN_KING_GEORGE }
				}
			}
		}
		clr_global_flag = CAN_king_busy
		CAN_king_becomes_unpopular = yes
		if = {
			limit = {
				check_variable = { king_popularity < 2 }
				check_variable = { king_popularity > 0 }
			}
			add_political_power = -100
			set_temp_variable = { ideology_change_var = -0.1 }
			change_ruling_party_popularity = yes
		}
		else_if = {
			limit = {
				check_variable = { king_popularity < 1 }
			}
			add_stability = -0.05
			add_political_power = -200
			set_temp_variable = { ideology_change_var = -0.2 }
			change_ruling_party_popularity = yes
		}
		else = {
			add_political_power = -50
		}
		hidden_effect = {
			news_event = { id = entente.110 days = 1 }
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# Choosing the new king
country_event = {
	id = entente.108
	title = entente.108.t
	picture = GFX_report_event_CAN_commons2

	desc = {
		text = entente.108.d.george
		trigger = { ENT_prince_george_is_dead = no }
	}
	desc = {
		text = entente.108.d.nogeorge
		trigger = { ENT_prince_george_is_dead = yes }
	}

	is_triggered_only = yes

	trigger = {
		has_country_flag = KR_british_king_base
	}

	option = {
		log = "[GetLogInfo]: event entente.108 option entente.108.a"
		name = entente.108.a #Albert
		ai_chance = {
			base = 70
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_king option = CAN_KING_GEORGE }
			}
		}
		custom_effect_tooltip = CAN_prince_albert_king
		hidden_effect = {
			clr_global_flag = CAN_king_busy
			set_variable = { king_popularity = 2 }
			set_variable = { global.king_albert_story = 0 }
			GBR_create_albert = yes

			news_event = { id = entente.111 days = 1 }
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.108 option entente.108.b"
		name = entente.108.b #Henry
		ai_chance = {
			base = 20
			modifier = {
				factor = 0
				tag = GBR
				NOT = {
					has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
				}
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_king option = CAN_KING_GEORGE }
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_king option = CAN_KING_ALBERT }
			}
		}
		custom_effect_tooltip = CAN_prince_henry_king
		hidden_effect = {
			clr_global_flag = CAN_king_busy
			set_variable = { king_popularity = 2 }
			set_variable = { global.king_henry_story = 0 }
			AST = {
				if = {
					limit = { has_country_leader = { character = GBR_henry_windsor } }
					random_character = {
						limit = { is_country_leader = yes }
						save_event_target_as = windsor
					}
					country_event = entente.113
				}
			}
			GBR_create_henry = yes

			news_event = { id = entente.111 days = 1 }
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.108 option entente.108.c"
		name = entente.108.c #George
		trigger = { ENT_prince_george_is_dead = no }
		ai_chance = {
			base = 10
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_king option = CAN_KING_HENRY }
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_king option = CAN_KING_ALBERT }
			}
		}
		custom_effect_tooltip = CAN_prince_george_king
		hidden_effect = {
			clr_global_flag = CAN_king_busy
			set_variable = { king_popularity = 2 }
			set_variable = { global.king_george_story = 0 }
			AST = {
				if = {
					limit = { has_country_leader = { character = GBR_george_windsor } }
					random_character = {
						limit = { is_country_leader = yes }
						save_event_target_as = windsor
					}
					country_event = entente.113
				}
			}
			GBR_create_george = yes

			news_event = { id = entente.111 days = 1 }
			country_event = { id = entente.50 days = 90 random_days = 60 }
		}
	}
}

# News - King Edward survives abdication crisis
news_event = {
	id = entente.110
	immediate = { log = "[GetLogInfo]: event entente.110" }
	title = entente.110.t
	desc = entente.110.d
	picture = GFX_news_event_CAN_edward

	major = yes
	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	show_major = {
		OR = {
			regional_europe_news = yes
			regional_north_america_news = yes
		}
	}

	option = {
		name = entente.110.a
		trigger = { CAN_is_commonwealth_tag = yes }
	}
	option = {
		name = entente.110.b
		trigger = {
			CAN_is_commonwealth_tag = no
			has_socialist_government = no
		}
	}
	option = {
		name = entente.110.c
		trigger = {
			CAN_is_commonwealth_tag = no
			has_socialist_government = yes
		}
	}
}

# News - New king coronated
news_event = {
	id = entente.111
	immediate = { log = "[GetLogInfo]: event entente.111" }
	title = entente.111.t
	picture = GFX_news_event_CAN_edward

	desc = {
		text = entente.111.d.albert
		trigger = { ENT_king_albert_i = yes }
	}
	desc = {
		text = entente.111.d.henry
		trigger = { ENT_king_henry_ix = yes }
	}
	desc = {
		text = entente.111.d.george
		trigger = { ENT_king_george_vi = yes }
	}

	major = yes
	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	show_major = {
		OR = {
			regional_europe_news = yes
			regional_north_america_news = yes
		}
	}

	option = {
		name = entente.111.a
		trigger = { CAN_is_commonwealth_tag = yes }
	}
	option = {
		name = entente.111.b
		trigger = {
			CAN_is_commonwealth_tag = no
			has_socialist_government = no
		}
	}
	option = {
		name = entente.111.c
		trigger = {
			CAN_is_commonwealth_tag = no
			has_socialist_government = yes
		}
	}
}

# Henry goes to become Governor-General of Australasia
unit_leader_event = {
	id = entente.112
	title = entente.112.t
	desc = entente.112.d
	picture = GFX_report_event_military_planning

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.112 option entente.112.a"
		name = entente.112.a
		effect_tooltip = {
			THIS = { set_nationality = AST }
		}
	}
}

# Henry/George has left Australasia to become king
country_event = {
	id = entente.113
	title = entente.113.t
	desc = entente.113.d
	picture = GFX_report_event_royal_parade

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.113 option entente.113.a"
		name = entente.113.a
		add_stability = 0.05
		effect_tooltip = {
			event_target:windsor = { set_nationality = FROM }
		}
		AST_create_governor_general_hore_ruthven = yes
	}
}

### Imperial Conference

# Invitations to the Conference
country_event = {
	id = entente.200
	title = entente.200.t
	desc = entente.200.d
	picture = GFX_report_event_CAN_parliament1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.200 option entente.200.a"
		name = entente.200.a
		add_to_array = { global.CAN_imperial_conference = ROOT }
	}
}

# CAN - Preparing for the Conference
country_event = {
	id = entente.201
	title = entente.201.t
	desc = entente.201.d

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.201 option entente.201.a"
		name = entente.201.a #Canada is the key to retaking the Home Isles
		ai_chance = {
			base = 40
			modifier = {
				factor = 0
				any_of = {
					array = global.CAN_imperial_conference
					var:v = { is_ai = no }
				}
			}
		}
		add_political_power = 100
		add_timed_idea = {
			idea = CAN_imp_trade
			days = 180
		}
		hidden_effect = {
			country_event = { id = entente.202 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.201 option entente.201.b"
		name = entente.201.b #We must first improve the other Dominions
		ai_chance = { base = 60 }
		set_global_flag = CAN_improve_dominions
		custom_effect_tooltip = CAN_imp_better_bonus
		every_country = {
			limit = {
				is_in_array = { global.CAN_imperial_conference = THIS }
			}
			add_political_power = 25
			add_opinion_modifier = { target = ROOT modifier = CAN_imperial_pride }
		}
		hidden_effect = {
			country_event = { id = entente.202 days = 1 }
		}
	}
}

# The Conference Begins
country_event = {
	id = entente.202
	title = entente.202.t
	picture = GFX_report_event_CAN_commission

	desc = {
		text = entente.202.d.dominion
		trigger = { has_global_flag = CAN_improve_dominions }
	}
	desc = {
		text = entente.202.d.isles
		trigger = { NOT = { has_global_flag = CAN_improve_dominions } }
	}

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			tag = CAN
			is_in_array = { global.CAN_imperial_conference = THIS }
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.202 option entente.202.a"
		name = entente.202.a
		trigger = { tag = CAN }
		hidden_effect = {
			random_country = {
				limit = {
					NOT = { tag = CAN }
					is_in_array = { global.CAN_imperial_conference = THIS }
				}
				country_event = { id = entente.203 days = 1 random_hours = 24 }
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.202 option entente.202.b"
		name = entente.202.b
		trigger = {
			NOT = { tag = CAN }
			has_global_flag = CAN_improve_dominions
		}
		custom_effect_tooltip = CAN_imp_better_bonus
		effect_tooltip = { add_political_power = 25 }
	}
	option = {
		log = "[GetLogInfo]: event entente.202 option entente.202.c"
		name = entente.202.c
		trigger = {
			NOT = {
				tag = CAN
				has_global_flag = CAN_improve_dominions
			}
		}
		CAN = {
			effect_tooltip = {
				add_political_power = 100
				add_timed_idea = {
					idea = CAN_imp_trade
					days = 180
				}
			}
		}
	}
}

# Attending nation plans to speak
country_event = {
	id = entente.203
	title = entente.203.t
	desc = entente.203.d

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.203 option entente.203.a"
		name = entente.203.a #Military
		ai_chance = {
			base = 50
			modifier = {
				factor = 3
				tag = RAJ
			}
			modifier = {
				factor = 0.1
				any_of = {
					array = global.CAN_imperial_conference
					var:v = { has_country_flag = CAN_chose_advisors }
				}
			}
		}
		set_country_flag = CAN_spoke_at_conference
		set_country_flag = CAN_chose_advisors
		if = {
			limit = { has_global_flag = CAN_improve_dominions }
			add_timed_idea = {
				idea = CAN_imp_advisors_2
				days = 180
			}
		}
		else = {
			add_timed_idea = {
				idea = CAN_imp_advisors_1
				days = 180
			}
		}
		hidden_effect = {
			country_event = entente.204
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.203 option entente.203.b"
		name = entente.203.b #Economy
		ai_chance = {
			base = 50
			modifier = {
				factor = 3
				tag = WIF
			}
			modifier = {
				factor = 0.1
				any_of = {
					array = global.CAN_imperial_conference
					var:v = { has_country_flag = CAN_chose_investment }
				}
			}
		}
		set_country_flag = CAN_spoke_at_conference
		set_country_flag = CAN_chose_investment
		if = {
			limit = { has_global_flag = CAN_improve_dominions }
			add_timed_idea = {
				idea = CAN_imp_investment_2
				days = 180
			}
		}
		else = {
			add_timed_idea = {
				idea = CAN_imp_investment_1
				days = 180
			}
		}
		hidden_effect = {
			country_event = entente.204
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.203 option entente.203.c"
		name = entente.203.c #Research
		ai_chance = {
			base = 50
			modifier = {
				factor = 3
				tag = AST
			}
			modifier = {
				factor = 0.1
				any_of = {
					array = global.CAN_imperial_conference
					var:v = { has_country_flag = CAN_chose_research }
				}
			}
		}
		set_country_flag = CAN_spoke_at_conference
		set_country_flag = CAN_chose_research
		if = {
			limit = { has_global_flag = CAN_improve_dominions }
			add_timed_idea = {
				idea = CAN_imp_research_2
				days = 180
			}
		}
		else = {
			add_timed_idea = {
				idea = CAN_imp_research_1
				days = 180
			}
		}
		hidden_effect = {
			country_event = entente.204
		}
	}
}

# Attending nation speaks
country_event = {
	id = entente.204
	title = entente.204.t
	picture = GFX_report_event_CAN_commission

	desc = {
		text = entente.204.d.adv_first
		trigger = {
			FROM = { has_country_flag = CAN_chose_advisors }
			NOT = {
				any_of = {
					array = global.CAN_imperial_conference
					var:v = {
						NOT = { tag = FROM }
						has_country_flag = CAN_chose_advisors
					}
				}
			}
		}
	}
	desc = {
		text = entente.204.d.adv
		trigger = {
			FROM = { has_country_flag = CAN_chose_advisors }
			any_of = {
				array = global.CAN_imperial_conference
				var:v = {
					NOT = { tag = FROM }
					has_country_flag = CAN_chose_advisors
				}
			}
		}
	}
	desc = {
		text = entente.204.d.inv_first
		trigger = {
			FROM = { has_country_flag = CAN_chose_investment }
			NOT = {
				any_of = {
					array = global.CAN_imperial_conference
					var:v = {
						NOT = { tag = FROM }
						has_country_flag = CAN_chose_investment
					}
				}
			}
		}
	}
	desc = {
		text = entente.204.d.inv
		trigger = {
			FROM = { has_country_flag = CAN_chose_investment }
			any_of = {
				array = global.CAN_imperial_conference
				var:v = {
					NOT = { tag = FROM }
					has_country_flag = CAN_chose_investment
				}
			}
		}
	}
	desc = {
		text = entente.204.d.res_first
		trigger = {
			FROM = { has_country_flag = CAN_chose_research }
			NOT = {
				any_of = {
					array = global.CAN_imperial_conference
					var:v = {
						NOT = { tag = FROM }
						has_country_flag = CAN_chose_research
					}
				}
			}
		}
	}
	desc = {
		text = entente.204.d.res
		trigger = {
			FROM = { has_country_flag = CAN_chose_research }
			any_of = {
				array = global.CAN_imperial_conference
				var:v = {
					NOT = { tag = FROM }
					has_country_flag = CAN_chose_research
				}
			}
		}
	}

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			tag = CAN
			is_in_array = { global.CAN_imperial_conference = THIS }
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.204 option entente.204.a"
		name = entente.204.a
		trigger = { tag = FROM }
		hidden_effect = {
			if = {
				limit = {
					any_country = {
						is_in_array = { global.CAN_imperial_conference = THIS }
						NOT = { has_country_flag = CAN_spoke_at_conference }
						NOT = { tag = CAN }
					}
				}
				random_other_country = {
					limit = {
						is_in_array = { global.CAN_imperial_conference = THIS }
						NOT = { has_country_flag = CAN_spoke_at_conference }
						NOT = { tag = CAN }
					}
					country_event = { id = entente.203 days = 1 random_hours = 24 }
				}
			}
			else = {
				CAN = {
					country_event = { id = entente.205 days = 1 random_hours = 72 }
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.204 option entente.204.b"
		name = entente.204.b
		trigger = {
			NOT = { tag = FROM }
			FROM = { has_country_flag = CAN_chose_advisors }
		}
		FROM = {
			effect_tooltip = {
				if = {
					limit = { has_global_flag = CAN_improve_dominions }
					add_timed_idea = {
						idea = CAN_imp_advisors_2
						days = 180
					}
				}
				else = {
					add_timed_idea = {
						idea = CAN_imp_advisors_1
						days = 180
					}
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.204 option entente.204.c"
		name = entente.204.c
		trigger = {
			NOT = { tag = FROM }
			FROM = { has_country_flag = CAN_chose_investment }
		}
		FROM = {
			effect_tooltip = {
				if = {
					limit = { has_global_flag = CAN_improve_dominions }
					add_timed_idea = {
						idea = CAN_imp_investment_2
						days = 180
					}
				}
				else = {
					add_timed_idea = {
						idea = CAN_imp_investment_1
						days = 180
					}
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.204 option entente.204.e"
		name = entente.204.e
		trigger = {
			NOT = { tag = FROM }
			FROM = { has_country_flag = CAN_chose_research }
		}
		FROM = {
			effect_tooltip = {
				if = {
					limit = { has_global_flag = CAN_improve_dominions }
					add_timed_idea = {
						idea = CAN_imp_research_2
						days = 180
					}
				}
				else = {
					add_timed_idea = {
						idea = CAN_imp_research_1
						days = 180
					}
				}
			}
		}
	}
}

# Imperial Conference Ends
country_event = {
	id = entente.205
	title = entente.205.t
	desc = entente.205.d
	picture = GFX_report_event_CAN_parliament1

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			tag = CAN
			is_in_array = { global.CAN_imperial_conference = THIS }
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.205 option entente.205.a"
		name = entente.205.a
		trigger = { tag = CAN }
		clr_global_flag = CAN_improve_dominions
		clear_array = global.CAN_imperial_conference
	}
	option = {
		log = "[GetLogInfo]: event entente.205 option entente.205.a"
		name = entente.205.a
		trigger = { NOT = { tag = CAN } }
		clr_country_flag = CAN_spoke_at_conference
		clr_country_flag = CAN_chose_advisors
		clr_country_flag = CAN_chose_investment
		clr_country_flag = CAN_chose_research
	}
}

### Entente Air Training

# Air training scheme created
country_event = {
	id = entente.210
	title = entente.210.t
	desc = entente.210.d
	picture = GFX_report_event_CUB_airforce

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.210 option entente.210.a"
		name = entente.210.a
		add_ace = {
			name = "George"
			surname = "Beurling"
			callsign = "Screwball"
			type = fighter_genius
		}
		add_ace = {
			name = "Robert"
			surname = "McNair"
			callsign = "Buck"
			type = support_unique
		}
		custom_effect_tooltip = tooltip_white_line
		every_other_country = {
			limit = {
				is_in_faction_with = CAN
				NOT = { tag = CAN }
			}
			country_event = entente.211
		}
	}
}

# Entente member invited to join
country_event = {
	id = entente.211
	title = entente.211.t
	desc = entente.211.d
	picture = GFX_report_event_CUB_airforce

	trigger = {
		NOT = {
			has_idea = CAN_air_training_plan_idea
			has_country_flag = CAN_refused_air_training_plan
		}
		ENT = { has_idea = CAN_air_training_plan_idea }
	}

	is_triggered_only = yes

	option = { # Agree
		log = "[GetLogInfo]: event entente.211 option entente.211.a"
		name = entente.211.a
		ai_chance = { base = 80 }
		air_experience = 20
		add_ideas = CAN_air_training_plan_idea
		ENT = {
			add_opinion_modifier = { target = ROOT modifier = KR_pleased }
			country_event = { id = entente.212 days = 1 random_days = 10 }
		}
	}
	option = { # Refuse
		log = "[GetLogInfo]: event entente.211 option entente.211.b"
		name = entente.211.b
		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				tag = NFA
			}
			modifier = {
				factor = 0
				OR = {
					tag = AST
					tag = WIF
				}
			}
		}
		set_country_flag = CAN_refused_air_training_plan
		add_political_power = 25
		reverse_add_opinion_modifier = { target = ENT modifier = KR_disapproves_of_govt }
	}
}

# Entente member joins the programme
country_event = {
	id = entente.212
	title = entente.212.t
	desc = entente.212.d
	picture = GFX_report_event_CUB_airforce

	is_triggered_only = yes

	trigger = {
		is_in_faction_with = FROM
	}

	option = {
		log = "[GetLogInfo]: event entente.212 option entente.212.a"
		name = entente.212.a
		air_experience = 20
	}
}

# RAAC Founded
country_event = {
	id = entente.213
	title = entente.213.t
	desc = entente.213.d
	picture = GFX_report_event_CUB_airforce

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.213 option entente.213.a"
		name = entente.213.a
		custom_effect_tooltip = available_designer
		show_ideas_tooltip = raac_west_indies
		custom_effect_tooltip = tooltip_white_line
		add_opinion_modifier = { target = CAN modifier = KR_pleased }
		every_owned_state = {
			limit = {
				is_controlled_by = ROOT
				OR = {
					state = 696 #Bermuda
					state = 690 #Northern Bahamas
					state = 689 #Jamaica
					state = 687 #West Guyana
				}
			}
			add_building_construction = {
				type = air_base
				level = 1
				instant_build = yes
			}
		}
		add_tech_bonus = {
			name = entente.213.t
			bonus = 1
			uses = 1
			category = air_equipment
		}
	}
}

### War Events

# King's home has been invaded
country_event = {
	id = entente.250
	title = entente.250.t
	desc = entente.250.d
	picture = GFX_report_event_canada_army

	trigger = {
		tag = event_target:KR_king_base
		surrender_progress > 0.05
		OR = {
			tag = CAN
			tag = AST
			tag = RAJ
			tag = GBR
			tag = SAF
		}
		has_country_flag = KR_british_king_base
		NOT = { has_idea = CAN_rally_the_country }
	}

	immediate = {
		hidden_effect = {
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					controller = { has_war_with = ROOT }
				}
				controller = {
					save_event_target_as = invader
				}
			}
			if = {
				limit = { has_idea = CAN_all_hands_on_deck_idea }
				swap_ideas = {
					remove_idea = CAN_all_hands_on_deck_idea
					add_idea = CAN_rally_the_country
				}
			}
			else_if = {
				limit = { has_idea = CAN_darkest_hour }
				swap_ideas = {
					remove_idea = CAN_darkest_hour
					add_idea = CAN_rally_the_country
				}
			}
			else_if = {
				limit = { has_idea = has_scripted_peace }
				swap_ideas = {
					remove_idea = has_scripted_peace
					add_idea = CAN_rally_the_country
				}
			}
			else = {
				add_ideas = CAN_rally_the_country
			}
		}
	}

	mean_time_to_happen = {
		days = 3
	}

	option = {
		log = "[GetLogInfo]: event entente.250 option entente.250.a"
		name = entente.250.a
		effect_tooltip = {
			add_ideas = CAN_rally_the_country
		}
	}
}

# King flees or is captured
country_event = {
	id = entente.251
	picture = GFX_report_event_CAN_fleeing

	title = {
		text = entente.251.t.flees
		trigger = { has_event_target = king_flees_to }
	}
	title = {
		text = entente.251.t.captured
		trigger = { NOT = { has_event_target = king_flees_to } }
	}

	desc = {
		text = entente.251.d.fleesandtransfer
		trigger = {
			has_event_target = king_flees_to
			has_event_target = entente_transfer_to
		}
	}
	desc = {
		text = entente.251.d.fleesandcollapse
		trigger = {
			has_event_target = king_flees_to
			has_event_target = entente_collapses
		}
	}
	desc = {
		text = entente.251.d.flees
		trigger = {
			has_event_target = king_flees_to
			NOT = {
				has_event_target = entente_transfer_to
				has_event_target = entente_collapses
			}
		}
	}
	desc = {
		text = entente.251.d.capturedandtransfer
		trigger = {
			NOT = { has_event_target = king_flees_to }
			has_event_target = entente_transfer_to
		}
	}
	desc = {
		text = entente.251.d.capturedandcollapse
		trigger = {
			NOT = { has_event_target = king_flees_to }
			has_event_target = entente_collapses
		}
	}
	desc = {
		text = entente.251.d.captured
		trigger = {
			NOT = {
				has_event_target = king_flees_to
				has_event_target = entente_transfer_to
				has_event_target = entente_collapses
			}
		}
	}

	trigger = {
		tag = event_target:KR_king_base
		surrender_progress > 0.8
		is_subject = no
		has_socialist_government = no
		has_idea = CAN_rally_the_country
		NOT = {
			AND = {
				tag = CAN
				is_subject = no
				OR = {
					is_in_faction = no
					is_faction_leader = yes
				}
				CAN_can_surrender_to_america = yes
			}
		}
	}

	mean_time_to_happen = {
		days = 3
	}

	immediate = {
		hidden_effect = {
			#find an appropriate new entente leader, if they lead the entente
			if = {
				limit = {
					tag = ENT
					OR = {
						is_faction_leader = yes
						AND = {
							is_in_faction = yes
							has_capitulated = yes
						}
					}
				}
				CAN_find_entente_leader = yes
			}

			#find appropriate country for king to flee to, if possible
			if = {
				limit = {
					NOT = { tag = GBR }
					GBR = {
						is_in_faction_with = ROOT
						surrender_progress < 0.30
					}
				}
				GBR = { save_event_target_as = king_flees_to }
			}
			else_if = {
				limit = {
					NOT = { tag = CAN }
					CAN = {
						is_in_faction_with = ROOT
						surrender_progress < 0.30
					}
				}
				CAN = { save_event_target_as = king_flees_to }
			}
			else_if = {
				limit = {
					NOT = { original_tag = AST }
					AST = {
						is_in_faction_with = ROOT
						surrender_progress < 0.30
						NOT = { has_government = paternal_autocrat }
					}
				}
				AST = { save_event_target_as = king_flees_to }
			}
			else_if = {
				limit = {
					NOT = { original_tag = RAJ }
					RAJ = {
						is_in_faction_with = ROOT
						surrender_progress < 0.30
						NOT = { has_government = social_democrat }
					}
				}
				RAJ = { save_event_target_as = king_flees_to }
			}
			else_if = {
				limit = {
					NOT = { original_tag = SAF }
					SAF = {
						is_in_faction_with = ROOT
						surrender_progress < 0.30
					}
				}
				SAF = { save_event_target_as = king_flees_to }
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.251 option canada.251.a"
		name = canada.251.a
		add_stability = -0.10
		add_political_power = -200
		if = {
			limit = { NOT = { has_event_target = entente_collapses } }
			remove_ideas = CAN_rally_the_country
		}
		else = {
			effect_tooltip = {
				remove_ideas = CAN_rally_the_country
			}
		}

		# first have the king flee to another country
		if = {
			limit = { has_event_target = king_flees_to }
			event_target:king_flees_to = {
				CAN_transfer_king_base = yes
				hidden_effect = { news_event = entente.259 }
			}
		}
		# then have the king captured
		else = {
			hidden_effect = {
				news_event = entente.260
				GBR = { CAN_transfer_king_base = yes }
			}
		}

		if = {
			limit = { tag = CAN }
			hidden_effect = { CAN_create_republic = yes }
		}

		# then transfer entente leadership, if being transferred
		if = {
			limit = { has_event_target = entente_transfer_to }
			event_target:entente_transfer_to = {
				CAN_transfer_entente_leader = yes
				hidden_effect = {
					ROOT = { CAN_remove_from_iedc = yes }
					every_subject_country = {
						ROOT = {
							set_autonomy = {
								target = PREV
								autonomy_state = autonomy_free
							}
						}
					}
					every_other_country = {
						limit = {
							is_in_faction_with = ROOT
							surrender_progress > 0.8
						}
						leave_faction = yes
					}
					remove_from_faction = ROOT
				}
			}
		}
		# then end the entente, if it's collapsing
		else_if = {
			limit = { has_event_target = entente_collapses }
			CAN_entente_collapses = yes
		}
	}
}

# Entente leader has been invaded
country_event = {
	id = entente.253
	title = entente.253.t
	desc = entente.253.d
	picture = GFX_report_event_canada_army

	trigger = {
		tag = ENT
		is_faction_leader = yes
		surrender_progress > 0.05
		NOT = {
			tag = event_target:KR_king_base
			has_idea = CAN_rally_the_country
			has_idea = CAN_darkest_hour
		}
	}

	immediate = {
		hidden_effect = {
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					NOT = { is_controlled_by = ROOT }
				}
				controller = {
					save_event_target_as = invader
				}
			}
			if = {
				limit = { has_idea = CAN_all_hands_on_deck_idea }
				swap_ideas = {
					remove_idea = CAN_all_hands_on_deck_idea
					add_idea = CAN_darkest_hour
				}
			}
			else_if = {
				limit = { has_idea = has_scripted_peace }
				swap_ideas = {
					remove_idea = has_scripted_peace
					add_idea = CAN_darkest_hour
				}
			}
			else = {
				add_ideas = CAN_darkest_hour
			}
		}
	}

	mean_time_to_happen = {
		days = 3
	}

	option = {
		log = "[GetLogInfo]: event entente.253 option entente.253.a"
		name = entente.253.a
		effect_tooltip = {
			add_ideas = CAN_darkest_hour
		}
	}
}

# Entente leader collapses
country_event = {
	id = entente.254
	title = entente.254.t
	picture = GFX_report_event_CAN_army2

	desc = {
		text = entente.254.d.transfer
		trigger = { has_event_target = entente_transfer_to }
	}
	desc = {
		text = entente.254.d.collapse
		trigger = { NOT = { has_event_target = entente_transfer_to } }
	}

	trigger = {
		tag = ENT
		has_war = yes
		is_faction_leader = yes
		has_idea = CAN_darkest_hour
		surrender_progress > 0.8
		NOT = {
			AND = {
				tag = CAN
				is_subject = no
				OR = {
					is_in_faction = no
					is_faction_leader = yes
				}
				CAN_can_surrender_to_america = yes
			}
		}
	}

	mean_time_to_happen = {
		days = 3
	}

	immediate = {
		hidden_effect = {
			#find an appropriate new entente leader
			CAN_find_entente_leader = yes
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.254 option entente.254.a"
		name = entente.254.a
		add_stability = -0.10
		add_political_power = -200
		if = {
			limit = { has_event_target = entente_transfer_to }
			event_target:entente_transfer_to = {
				CAN_transfer_entente_leader = yes
				hidden_effect = {
					news_event = { id = entente.255 hours = 8 }
					ROOT = { CAN_remove_from_iedc = yes }
					every_subject_country = {
						ROOT = {
							set_autonomy = {
								target = PREV
								autonomy_state = autonomy_free
							}
						}
					}
					remove_from_faction = ROOT
				}
			}
			remove_ideas = CAN_darkest_hour
			hidden_effect = {
				# peace out the rest of the Entente if appropriate
				every_country = {
					limit = {
						has_war_with = event_target:entente_transfer_to
						is_valid_peace_target = yes
					}
					country_event = { id = entente.258 hours = 3 }
				}
			}
		}
		else = {
			CAN_entente_collapses = yes
			news_event = entente.256
		}
	}
}

# News: Entente leadership transferred
news_event = {
	id = entente.255
	immediate = { log = "[GetLogInfo]: event entente.255" }
	title = entente.255.t
	desc = entente.255.d
	picture = GFX_news_event_canada_army

	trigger = {
		wants_world_news = yes
	}

	is_triggered_only = yes
	fire_for_sender = no
	major = yes

	show_major = {
		NOT = { tag = FROM }
	}

	option = {
		name = entente.255.a
		trigger = {
			tag = event_target:entente_transfer_to
		}
	}
	option = {
		name = entente.255.b
		trigger = {
			is_in_faction_with = event_target:entente_transfer_to
			NOT = { tag = event_target:entente_transfer_to }
		}
	}
	option = {
		name = entente.255.c
		trigger = {
			has_war_with = event_target:entente_transfer_to
		}
	}
	option = {
		name = entente.255.e
		trigger = {
			NOT = {
				has_war_with = event_target:entente_transfer_to
				is_in_faction_with = event_target:entente_transfer_to
				tag = event_target:entente_transfer_to
			}
		}
	}
}

# News: Entente collapses
news_event = {
	id = entente.256
	immediate = { log = "[GetLogInfo]: event entente.256" }
	title = entente.256.t
	desc = entente.256.d
	picture = GFX_news_event_canada_army

	trigger = {
		wants_world_news = yes
	}

	is_triggered_only = yes
	fire_for_sender = no
	major = yes

	show_major = {
		NOT = { is_in_faction_with = FROM }
	}

	option = {
		name = entente.256.a
		trigger = {
			has_war_with = FROM
		}
	}
	option = {
		name = entente.256.b
		trigger = {
			NOT = { has_war_with = FROM }
		}
	}
}

# Entente member informed of collapse
country_event = {
	id = entente.257
	title = entente.257.t
	desc = entente.257.d
	picture = GFX_report_event_CAN_army2

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.257 option entente.257.a"
		name = entente.257.a
		add_stability = -0.10
		add_political_power = -100
		if = {
			limit = { is_subject_of = FROM }
			overlord = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_free
				}
			}
		}
		if = {
			limit = { is_in_tech_sharing_group = entente_research }
			remove_from_tech_sharing_group = entente_research
		}
		CAN_remove_from_iedc = yes
	}
}

# Hidden event to peace out Entente members
country_event = {
	id = entente.258

	is_triggered_only = yes
	hidden = yes

	immediate = {
		# get rid of ideas
		if = {
			limit = {
				FROM = { has_idea = CAN_rally_the_country }
			}
			FROM = { remove_ideas = CAN_rally_the_country }
		}
		if = {
			limit = {
				FROM = { has_idea = CAN_darkest_hour }
			}
			FROM = { remove_ideas = CAN_darkest_hour }
		}

		# First European faction leaders peace out with any non-neighbours outside of Europe other than the French Republic
		if = {
			limit = {
				is_in_europe = yes
				is_faction_leader = yes
			}
			every_enemy_country = {
				limit = {
					has_country_flag = KR_was_in_entente
					is_valid_peace_target = yes
					NOT = {
						tag = NFA
						AND = {
							tag = NZL
							AST = { is_in_faction_with = ROOT }
						}
						AND = {
							OR = {
								tag = PUE
								tag = HAW
							}
							any_allied_country = { is_american_tag = yes }
						}
						has_capitulated = yes
						is_in_europe = yes
						any_owned_state = {
							is_core_of = PREV
							any_neighbor_state = {
								is_owned_by_ROOT_or_ally = yes
							}
						}
						any_owned_state = {
							is_coastal = yes
							is_controlled_by_ROOT_or_ally = yes
						}
					}
				}
				white_peace_with_ROOT = yes
			}
		}
		# Then Asian faction leaders peace out with any non-neighbours outside of Asia
		else_if = {
			limit = {
				is_in_asia = yes
				is_faction_leader = yes
			}
			every_enemy_country = {
				limit = {
					has_country_flag = KR_was_in_entente
					is_valid_peace_target = yes
					NOT = {
						has_capitulated = yes
						is_in_asia = yes
						AND = {
							tag = NZL
							AST = { is_in_faction_with = ROOT }
						}
						AND = {
							tag = HOL
							ROOT = { tag = INS }
						}
						AND = {
							OR = {
								tag = PUE
								tag = HAW
							}
							any_allied_country = { is_american_tag = yes }
						}
						any_owned_state = {
							is_core_of = PREV
							any_neighbor_state = {
								is_owned_by_ROOT_or_ally = yes
							}
						}
						any_owned_state = {
							is_coastal = yes
							is_controlled_by_ROOT_or_ally = yes
						}
					}
				}
				white_peace_with_ROOT = yes
			}
		}
		# Then everyone else peaces out with any non-neighbours not on the same continent
		else = {
			every_enemy_country = {
				limit = {
					has_country_flag = KR_was_in_entente
					is_valid_peace_target = yes
					NOT = {
						has_capitulated = yes
						same_continent_as_ROOT = yes
						AND = {
							tag = HOL
							ROOT = { tag = INS }
						}
						AND = {
							OR = {
								tag = PUE
								tag = HAW
							}
							ROOT = { is_american_tag = yes }
						}
						any_owned_state = {
							is_core_of = PREV
							any_neighbor_state = {
								is_owned_by_ROOT_or_ally = yes
							}
						}
						any_owned_state = {
							is_coastal = yes
							is_controlled_by_ROOT_or_ally = yes
						}
					}
				}
				white_peace_with_ROOT = yes
			}
		}
	}
}

# News: King flees to other country
news_event = {
	id = entente.259
	immediate = { log = "[GetLogInfo]: event entente.259" }
	title = entente.259.t
	picture = GFX_news_event_CAN_fleeing

	desc = {
		text = entente.259.d.transfer
		trigger = { has_event_target = entente_transfer_to }
	}
	desc = {
		text = entente.259.d.collapse
		trigger = { has_event_target = entente_collapses }
	}
	desc = {
		text = entente.259.d.notleader
		trigger = {
			NOT = {
				has_event_target = entente_transfer_to
				has_event_target = entente_collapses
			}
		}
	}

	trigger = {
		wants_world_news = yes
	}

	is_triggered_only = yes
	major = yes

	show_major = {
		NOT = { tag = FROM }
	}

	option = {
		name = entente.259.a
		trigger = {
			tag = event_target:king_flees_to
		}
	}
	option = {
		name = entente.259.b
		trigger = {
			is_in_faction_with = event_target:king_flees_to
			NOT = { tag = event_target:king_flees_to }
		}
	}
	option = {
		name = entente.259.c
		trigger = {
			has_war_with = event_target:king_flees_to
		}
	}
	option = {
		name = entente.259.e
		trigger = {
			NOT = {
				has_war_with = event_target:king_flees_to
				is_in_faction_with = event_target:king_flees_to
				tag = event_target:king_flees_to
			}
		}
	}
}

# News: King captured
news_event = {
	id = entente.260
	immediate = { log = "[GetLogInfo]: event entente.260" }
	title = entente.260.t
	picture = GFX_news_event_eng_decolonization

	desc = {
		text = entente.260.d.transfer
		trigger = { has_event_target = entente_transfer_to }
	}
	desc = {
		text = entente.260.d.collapse
		trigger = { has_event_target = entente_collapses }
	}
	desc = {
		text = entente.260.d.notleader
		trigger = {
			NOT = {
				has_event_target = entente_transfer_to
				has_event_target = entente_collapses
			}
		}
	}

	trigger = {
		wants_world_news = yes
	}

	is_triggered_only = yes
	major = yes

	show_major = {
		NOT = { tag = FROM }
	}

	option = {
		name = entente.260.a
		trigger = {
			is_in_faction_with = FROM
		}
	}
	option = {
		name = entente.260.b
		trigger = {
			has_war_with = FROM
		}
	}
	option = {
		name = entente.260.c
		trigger = {
			NOT = {
				has_war_with = FROM
				is_in_faction_with = FROM
			}
		}
	}
}

# The King returns to Canada/UK
news_event = {
	id = entente.261
	immediate = { log = "[GetLogInfo]: event entente.261" }
	title = entente.261.t
	desc = entente.261.d
	picture = GFX_news_event_royal_visit

	trigger = {
		wants_world_news = yes
	}

	is_triggered_only = yes
	major = yes

	option = {
		name = entente.261.a
		trigger = { tag = FROM }
	}
	option = {
		name = entente.261.b
		trigger = { tag = event_target:king_come_from }
	}
	option = {
		name = entente.261.c
		trigger = {
			is_in_faction_with = FROM
			NOT = {
				tag = FROM
				tag = event_target:king_come_from
			}
		}
	}
	option = {
		name = entente.261.e
		trigger = {
			has_war_with = FROM
			NOT = { tag = event_target:king_come_from }
		}
	}
	option = {
		name = entente.261.f
		trigger = {
			NOT = {
				tag = FROM
				is_in_faction_with = FROM
				has_war_with = FROM
				tag = event_target:king_come_from
			}
		}
	}
}

# Entente asks for access to Portugal
country_event = {
	id = entente.275
	title = entente.275.t
	desc = entente.275.d
	picture = GFX_report_event_CAN_army1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.275 option entente.275.a"
		name = entente.275.a #Of course!
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = KR_close_allies }
			country_event = entente.276
		}
		SAF = {
			add_opinion_modifier = { target = ROOT modifier = KR_outraged }
		}
		every_country = {
			limit = {
				is_in_faction_with = FROM
				NOT = { has_military_access_to = ROOT }
			}
			diplomatic_relation = {
				country = ROOT
				relation = military_access
				active = yes
			}
			diplomatic_relation = {
				country = ROOT
				relation = docking_rights
				active = yes
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.275 option entente.275.b"
		name = entente.275.b #We don't want to get involved
		ai_chance = { base = 0 }
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = KR_disapproves_of_govt }
			country_event = entente.277
		}
	}
}

# Portugal Agrees
country_event = {
	id = entente.276
	title = entente.276.t
	desc = entente.276.d
	picture = GFX_report_event_CAN_army1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.276 option entente.276.a"
		name = entente.276.a
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = KR_close_allies }
		}
	}
}

# Portugal Refuses
country_event = {
	id = entente.277
	title = entente.277.t
	desc = entente.277.d
	picture = GFX_report_event_CAN_army1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.277 option entente.277.a"
		name = entente.277.a
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = KR_disapproves_of_govt }
		}
	}
}

### Dockyard Leasing ###
country_event = { #Does CAN want to work with ACW navally?
	id = entente.278
	title = entente.278.t
	desc = {
		text = entente.278.d.gbrexists
		trigger = { country_exists = GBR }
	}
	desc = {
		text = entente.278.d.gbrdoesnotexist
		trigger = { NOT = { country_exists = GBR } }
	}
	picture = GFX_report_event_CAN_army1 #WIP

	fire_only_once = yes
	is_triggered_only = yes

	option = { # Yes please
		log = "[GetLogInfo]: event entente.278 option entente.278.a"
		name = entente.278.a
		trigger = { has_political_power > 74.99 }
		add_political_power = -75
		FROM = { country_event = { id = entente.279 days = 2 } }
	}

	option = { # No thanks
		log = "[GetLogInfo]: event entente.278 option entente.278.b"
		name = entente.278.b
		trigger = { has_political_power > 74.99 }
		ai_chance = { base = 0 }
		activate_targeted_decision = { decision = CAN_request_brooklyn_yard_lease target = FROM }
	}

	option = { # Ask later
		log = "[GetLogInfo]: event entente.278 option entente.278.c"
		name = entente.278.c
		trigger = { has_political_power < 75 }
		activate_targeted_decision = { decision = CAN_request_brooklyn_yard_lease target = FROM }
	}
}

country_event = { #Does ACW want to work with CAN navally?
	id = entente.279
	title = entente.279.t
	desc = {
		text = entente.279.d.gbrexists
		trigger = { country_exists = GBR }
	}
	desc = {
		text = entente.279.d.gbrdoesnotexist
		trigger = { NOT = { country_exists = GBR } }
	}
	picture = GFX_report_event_CAN_army1 #WIP

	is_triggered_only = yes

	option = { # Yes
		log = "[GetLogInfo]: event entente.279 option entente.279.a"
		name = entente.279.a
		add_political_power = 75
		add_ideas = CAN_backed_rebuilding
		358 = {
			remove_building = { type = dockyard level = 7 }
			add_dynamic_modifier = { modifier = CAN_leased_brooklyn_yard }
		}
		FROM = {
			add_offsite_building = { type = dockyard level = 7 }
			hidden_effect = {
				remove_targeted_decision = { target = ROOT decision = CAN_request_brooklyn_yard_lease }
				activate_targeted_decision = { target = ROOT decision = CAN_cancel_brooklyn_yard_lease }
				activate_targeted_decision = { target = ROOT decision = CAN_create_naval_research_group }
				country_event = entente.280
			}
		}
		hidden_effect = {
			activate_targeted_decision = { target = FROM decision = CAN_ACW_cancel_brooklyn_yard_lease }
			activate_targeted_decision = { target = FROM decision = CAN_create_naval_research_group }
		}
	}

	option = { # No thanks
		log = "[GetLogInfo]: event entente.279 option entente.279.b"
		name = entente.279.b
		ai_chance = { base = 0 }
		FROM = { country_event = entente.281 }
	}
}

country_event = { #ACW agrees to lease the Brooklyn Yard
	id = entente.280
	title = entente.280.t
	desc = entente.280.d
	picture = GFX_report_event_CAN_parliament1 #WIP

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.280 option entente.280.a"
		name = entente.280.a
		effect_tooltip = { add_offsite_building = { type = dockyard level = 7 } }
	}
}

country_event = { #ACW declines to lease the Brooklyn Yard
	id = entente.281
	title = entente.281.t
	desc = entente.281.d
	picture = GFX_report_event_CAN_parliament1 #WIP

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.281 option entente.281.a"
		name = entente.281.a # :(
	}
}

country_event = { #ACW - CAN ends lease
	id = entente.282
	title = entente.282.t
	desc = entente.282.d
	picture = GFX_report_event_CAN_parliament1 #WIP

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.282 option entente.282.a"
		name = entente.282.a
		effect_tooltip = {
			remove_ideas = CAN_backed_rebuilding
			358 = {
				remove_dynamic_modifier = { modifier = CAN_leased_brooklyn_yard }
				add_building_construction = { type = dockyard level = 7 }
			}
		}
	}
}

country_event = { #CAN - ACW ends lease
	id = entente.283
	title = entente.283.t
	desc = entente.283.d
	picture = GFX_report_event_CAN_parliament1 #WIP

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.283 option entente.283.a"
		name = entente.283.a
		add_political_power = 25
		effect_tooltip = {
			add_offsite_building = { type = dockyard level = -7 }
		}
	}
}

country_event = { #informed that research group has been created for naval tech
	id = entente.284
	title = entente.284.t
	desc = entente.284.d
	picture = GFX_report_event_CAN_parliament1 #WIP

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.284 option entente.284.a"
		name = entente.284.a
		if = {
			limit = { has_tech_sharing_feature = yes }
			add_to_tech_sharing_group = joint_north_american_naval_programme
		}
		else = {
			add_ideas = CAN_joint_naval_research_nontfv
		}
	}
}

### Halifax Conference Events

# The Halifax Conference - Germany invited (fired by decision)
country_event = {
	id = entente.300
	title = entente.300.t
	desc = entente.300.d
	picture = GFX_report_event_CAN_parliament1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.300 option entente.300.a"
		name = entente.300.a
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_FAIL }
			}
		}
		ENT = {
			country_event = { id = entente.302 days = 3 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.300 option entente.300.b"
		name = entente.300.b #Refuse
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_FAIL }
			}
		}
		ENT = {
			add_opinion_modifier = { target = ROOT modifier = KR_disapproves_of_govt }
			country_event = { id = entente.301 days = 3 }
		}
	}
}

# Germany refused
country_event = {
	id = entente.301
	title = entente.301.t
	desc = entente.301.d
	picture = GFX_report_event_GER_reichstag2

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.301 option entente.301.a"
		name = entente.301.a
		add_political_power = -25
	}
}

# Germany agrees
country_event = {
	id = entente.302
	title = entente.302.t
	desc = entente.302.d
	picture = GFX_report_event_GER_reichstag2

	is_triggered_only = yes

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.302 option entente.302.a"
		name = entente.302.a
		add_political_power = 25
		hidden_effect = {
			random_country = {
				limit = {
					NOT = {
						tag = ENT
						tag = GER
					}
					OR = {
						is_in_faction_with = ENT
						is_in_faction_with = GER
					}
				}
				country_event = { id = entente.303 days = 1 } #inform everyone
			}
			country_event = { id = entente.304 days = 8 } #conference begins
			GER = {
				country_event = { id = entente.305 days = 9 } #ponders first demand
			}
		}
	}
}

# The Halifax Conference - scheduled to begin
country_event = {
	id = entente.303
	title = entente.303.t
	desc = entente.303.d
	picture = GFX_report_event_CAN_parliament1

	is_triggered_only = yes
	major = yes

	show_major = {
		NOT = {
			tag = ENT
			tag = GER
			tag = GBR
		}
		OR = {
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.303 option entente.303.a"
		name = entente.303.a
	}
}

# The Halifax Conference - begins
country_event = {
	id = entente.304
	title = entente.304.t
	desc = entente.304.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.304 option entente.304.a"
		name = entente.304.a
	}
}

# The Halifax Conference - Germany ponders demands
country_event = {
	id = entente.305
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	title = {
		text = entente.305.t
		trigger = {
			NOT = {
				has_country_flag = GER_conf_demand_alsace
				has_country_flag = GER_conf_demand_france_mitt
				has_country_flag = GER_conf_demand_colonies
				has_country_flag = GER_conf_demand_northireland
			}
		}
	}
	title = {
		text = entente.305.t.return
		trigger = {
			OR = {
				has_country_flag = GER_conf_demand_alsace
				has_country_flag = GER_conf_demand_france_mitt
				has_country_flag = GER_conf_demand_colonies
				has_country_flag = GER_conf_demand_northireland
			}
		}
	}
	desc = {
		text = entente.305.d
		trigger = {
			NOT = {
				has_country_flag = GER_conf_demand_alsace
				has_country_flag = GER_conf_demand_france_mitt
				has_country_flag = GER_conf_demand_colonies
				has_country_flag = GER_conf_demand_northireland
			}
		}
	}
	desc = {
		text = entente.305.d.return
		trigger = {
			OR = {
				has_country_flag = GER_conf_demand_alsace
				has_country_flag = GER_conf_demand_france_mitt
				has_country_flag = GER_conf_demand_colonies
				has_country_flag = GER_conf_demand_northireland
			}
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.305 option entente.305.a"
		name = entente.305.a # France must give up on Alsace-Lorraine
		trigger = {
			owns_state = 28 #Alsace-Lorraine
			NOT = { has_war_with = NFA }
			NFA = { is_in_faction_with = ENT }
			NOT = { has_country_flag = GER_conf_demand_alsace }
		}
		ai_chance = {
			base = 100
			modifier = {
				factor = 0.1
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_ENT }
			}
		}
		set_country_flag = GER_conf_demand_alsace
		NFA = {
			country_event = { id = entente.307 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.305 option entente.305.b"
		name = entente.305.b # France must join Mitteleuropa afterwards
		trigger = {
			NOT = { has_war_with = NFA }
			NFA = { is_in_faction_with = ENT }
			NOT = { has_country_flag = GER_conf_demand_france_mitt }
		}
		ai_chance = { base = 50 }
		set_country_flag = GER_conf_demand_france_mitt
		NFA = {
			country_event = { id = entente.310 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.305 option entente.305.c"
		name = entente.305.c # German acquisitions in Afica/SE Asia must be recognized
		trigger = {
			OR = {
				336 = { is_owned_by_ROOT_or_subject = yes } #Singapore
				827 = { is_owned_by_ROOT_or_subject = yes } #Annam
				547 = { is_owned_by_ROOT_or_subject = yes } #Kenya
				807 = { is_owned_by_ROOT_or_subject = yes } #Ivory Coast
			}
			NOT = { has_country_flag = GER_conf_demand_colonies }
			OR = {
				NFA = { is_in_faction_with = ENT }
				GBR = { is_in_faction_with = ENT }
				CAN = { is_in_faction_with = ENT }
			}
		}
		ai_chance = { base = 30 }
		set_country_flag = GER_conf_demand_colonies
		if = {
			limit = { GBR = { is_in_faction_with = ENT } }
			GBR = { country_event = { id = entente.313 days = 1 } }
		}
		else_if = {
			limit = { CAN = { is_in_faction_with = ENT } }
			CAN = { country_event = { id = entente.313 days = 1 } }
		}
		else = {
			NFA = { country_event = { id = entente.313 days = 1 } }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.305 option entente.305.e"
		name = entente.305.e # British renounce claims to Northern Ireland
		trigger = {
			119 = { is_owned_by = IRE } #Northern Ireland
			is_in_faction_with = IRE
			NOT = {
				has_country_flag = GER_conf_demand_northireland
				GBR = { has_country_flag = CAN_promised_ireland_ind }
			}
			OR = {
				GBR = { is_in_faction_with = ENT }
				AND = {
					NOT = { country_exists = GBR }
					CAN = { is_in_faction_with = ENT }
				}
			}
		}
		ai_chance = { base = 20 }
		set_country_flag = GER_conf_demand_northireland
		if = {
			limit = { is_in_faction_with = GBR }
			GBR = {
				country_event = { id = entente.316 days = 1 }
			}
		}
		else = {
			CAN = {
				country_event = { id = entente.316 days = 1 }
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.305 option entente.305.f"
		name = entente.305.f # We're good to proceed
		ai_chance = {
			base = 5
			modifier = {
				factor = 4
				OR = {
					has_war_with = RUS
					has_war_with = SOV
				}
			}
			modifier = {
				factor = 2
				surrender_progress > 0.05
			}
			modifier = {
				factor = 2
				surrender_progress > 0.10
			}
			modifier = {
				factor = 3
				has_global_flag = USA_civil_war_over_flag
				OR = {
					USA = { is_in_faction_with = ENT }
					PSA = { is_in_faction_with = ENT }
				}
			}
			modifier = {
				factor = 0.5
				has_global_flag = USA_civil_war_over_flag
				TEX = { is_in_faction_with = GER }
			}
			modifier = {
				factor = 0.2
				NOT = { has_war_with = NFA }
				NFA = { is_in_faction_with = ENT }
				NOT = { has_country_flag = GER_conf_demand_france_mitt }
			}
			modifier = {
				factor = 0
				owns_state = 28 #Alsace-Lorraine
				NOT = { has_war_with = NFA }
				NFA = { is_in_faction_with = ENT }
				NOT = {
					has_country_flag = GER_conf_demand_alsace
					has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_ENT }
				}
			}
			modifier = {
				factor = 10
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_ENT }
			}
		}
		ENT = {
			news_event = { id = entente.319 days = 1 }
		}
		hidden_effect = {
			ENT = {
				country_event = { id = entente.325 days = 1 }
			}
			GER = {
				country_event = { id = entente.326 days = 1 }
			}
			every_country = {
				limit = {
					OR = {
						is_in_faction_with = ENT
						is_in_faction_with = GER
					}
					NOT = {
						tag = ENT
						tag = GER
					}
				}
				country_event = { id = entente.327 days = 1 }
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.305 option entente.305.g"
		name = entente.305.g # We don't want this
		trigger = {
			is_ai = no
			NOT = {
				has_country_flag = GER_conf_demand_alsace
				has_country_flag = GER_conf_demand_france_mitt
				has_country_flag = GER_conf_demand_colonies
				has_country_flag = GER_conf_demand_northireland
			}
		}
		country_event = { id = entente.306 days = 1 }
	}
}

# Halifax Conference - Germany shuts it down
country_event = {
	id = entente.306
	title = entente.306.t
	desc = entente.306.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.306 option entente.306.a"
		name = entente.306.a
		trigger = { tag = GER }
	}
	option = {
		log = "[GetLogInfo]: event entente.306 option entente.306.b"
		name = entente.306.b
		trigger = { tag = ENT }
		add_political_power = -25
	}
	option = {
		log = "[GetLogInfo]: event entente.306 option entente.306.b"
		name = entente.306.b
		trigger = {
			NOT = { tag = GER }
			is_in_faction_with = GER
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.306 option entente.306.b"
		name = entente.306.b
		trigger = {
			NOT = { tag = ENT }
			is_in_faction_with = ENT
		}
	}
}

# Halifax Conference - NFA asked to give up Alsace-Lorraine
country_event = {
	id = entente.307
	title = entente.307.t
	desc = entente.307.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.307 option entente.307.a"
		name = entente.307.a #Never!
		ai_chance = {
			base = 60
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_GER }
			}
		}
		GER = {
			add_opinion_modifier = { target = ROOT modifier = KR_disapproves_of_govt }
			country_event = { id = entente.308 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.307 option entente.307.b"
		name = entente.307.b #Agree
		ai_chance = {
			base = 40
			modifier = {
				factor = 1.5
				has_elected_government = yes
			}
			modifier = {
				factor = 0
				has_government = national_populist
				NOT = {
					has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_GER }
				}
			}
		}
		GER = {
			add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt }
			country_event = { id = entente.309 days = 1 }
		}
	}
}

# Halifax Conference - NFA refuses
country_event = {
	id = entente.308
	title = entente.308.t
	desc = entente.308.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.308 option entente.308.a"
		name = entente.308.a #That it, then
		ai_chance = {
			base = 75
			modifier = {
				factor = 0.75
				has_global_flag = USA_civil_war_over_flag
				OR = {
					USA = { is_in_faction_with = ENT }
					PSA = { is_in_faction_with = ENT }
				}
			}
			modifier = {
				factor = 1.25
				has_global_flag = USA_civil_war_over_flag
				TEX = { is_in_faction_with = GER }
			}
			modifier = {
				factor = 0.5
				OR = {
					has_war_with = RUS
					has_war_with = SOV
				}
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_ENT }
			}
		}
		ENT = {
			set_country_flag = ENT_france_refuse_alsace
			news_event = entente.320
			hidden_effect = { country_event = entente.328 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.308 option entente.308.b"
		name = entente.308.b #We'll put it aside for now
		ai_chance = { base = 25 }
		add_political_power = -100
		country_event = entente.305
	}
}

# Halifax Conference - NFA agrees to give up Alsace-Lorraine
country_event = {
	id = entente.309
	title = entente.309.t
	desc = entente.309.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.309 option entente.309.a"
		name = entente.309.a
		trigger = {
			tag = ENT
			NOT = { tag = NFA }
		}
		set_country_flag = ENT_france_agree_alsace
	}
	option = {
		log = "[GetLogInfo]: event entente.309 option entente.309.b"
		name = entente.309.b
		trigger = { tag = GER }
		add_political_power = 50
		country_event = { id = entente.305 days = 1 }
	}
	option = {
		log = "[GetLogInfo]: event entente.309 option entente.309.c"
		name = entente.309.c
		trigger = {
			tag = NFA
			NOT = { tag = ENT }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.309 option entente.309.e"
		name = entente.309.e
		trigger = {
			NOT = {
				tag = ENT
				tag = GER
				tag = NFA
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.309 option entente.309.f"
		name = entente.309.f
		trigger = {
			tag = NFA
			tag = ENT
		}
		set_country_flag = ENT_france_agree_alsace
	}
}

# Halifax Conference - NFA must join Mitteleuropa after return
country_event = {
	id = entente.310
	title = entente.310.t
	desc = entente.310.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.310 option entente.310.a"
		name = entente.310.a #Never!
		ai_chance = {
			base = 40
			modifier = {
				factor = 1.5
				has_authoritarian_government = yes
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_GER }
			}
		}
		GER = {
			add_opinion_modifier = { target = ROOT modifier = KR_disapproves_of_govt }
			country_event = { id = entente.311 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.310 option entente.310.b"
		name = entente.310.b #Agree
		ai_chance = {
			base = 60
			modifier = {
				factor = 1.5
				has_elected_government = yes
			}
			modifier = {
				factor = 0.5
				has_government = national_populist
			}
		}
		GER = {
			add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt }
			country_event = { id = entente.312 days = 1 }
		}
	}
}

# Halifax Conference - NFA refuses
country_event = {
	id = entente.311
	title = entente.311.t
	desc = entente.311.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.311 option entente.311.a"
		name = entente.311.a #That it, then
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.75
				has_global_flag = USA_civil_war_over_flag
				OR = {
					USA = { is_in_faction_with = ENT }
					PSA = { is_in_faction_with = ENT }
				}
			}
			modifier = {
				factor = 1.25
				has_global_flag = USA_civil_war_over_flag
				TEX = { is_in_faction_with = GER }
			}
			modifier = {
				factor = 0.75
				has_elected_government = yes
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_ENT }
			}
		}
		ENT = {
			set_country_flag = ENT_france_refuse_mittel
			news_event = entente.320
			hidden_effect = { country_event = entente.328 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.311 option entente.311.b"
		name = entente.311.b #We'll put it aside for now
		ai_chance = { base = 50 }
		add_political_power = -50
		country_event = entente.305
	}
}

# Halifax Conference - NFA agrees to join Mitteleuropa after return
country_event = {
	id = entente.312
	title = entente.312.t
	desc = entente.312.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.312 option entente.312.a"
		name = entente.312.a
		trigger = {
			tag = ENT
			NOT = { tag = NFA }
		}
		set_country_flag = ENT_france_agree_mittel
	}
	option = {
		log = "[GetLogInfo]: event entente.312 option entente.312.b"
		name = entente.312.b
		trigger = { tag = GER }
		add_political_power = 50
		country_event = { id = entente.305 days = 1 }
	}
	option = {
		log = "[GetLogInfo]: event entente.312 option entente.312.c"
		name = entente.312.c
		trigger = {
			tag = NFA
			NOT = { tag = ENT }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.312 option entente.312.e"
		name = entente.312.e
		trigger = {
			NOT = {
				tag = ENT
				tag = GER
				tag = NFA
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.312 option entente.312.f"
		name = entente.312.f
		trigger = { #NFA is also ENT
			tag = NFA
			tag = ENT
		}
		set_country_flag = ENT_france_agree_mittel
	}
}

# Halifax Conference - German colonies in Africa and SE Asia must be recognized
country_event = {
	id = entente.313
	title = entente.313.t
	desc = entente.313.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.313 option entente.313.a"
		name = entente.313.a #Never!
		ai_chance = {
			base = 30
			modifier = {
				factor = 0.5
				tag = NFA
			}
			modifier = {
				factor = 1.5
				has_authoritarian_government = yes
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_GER }
			}
		}
		GER = {
			add_opinion_modifier = { target = ROOT modifier = KR_disapproves_of_govt }
			country_event = { id = entente.314 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.313 option entente.313.b"
		name = entente.313.b #Agree
		ai_chance = {
			base = 70
			modifier = {
				factor = 1.5
				has_elected_government = yes
			}
			modifier = {
				factor = 0.5
				has_government = national_populist
			}
		}
		if = {
			limit = {
				OR = {
					tag = CAN
					tag = GBR
				}
				NFA = {
					is_in_faction_with = ROOT
				}
			}
			NFA = { country_event = entente.313 }
		}
		else = {
			GER = {
				add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt }
				country_event = { id = entente.315 days = 1 }
			}
		}
	}
}

# Halifax Conference - CAN/NFA refuses
country_event = {
	id = entente.314
	title = entente.314.t
	desc = entente.314.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.314 option entente.314.a"
		name = entente.314.a #That it, then
		ai_chance = {
			base = 40
			modifier = {
				factor = 0.75
				has_global_flag = USA_civil_war_over_flag
				OR = {
					USA = { is_in_faction_with = ENT }
					PSA = { is_in_faction_with = ENT }
				}
			}
			modifier = {
				factor = 1.25
				has_global_flag = USA_civil_war_over_flag
				TEX = { is_in_faction_with = GER }
			}
			modifier = {
				factor = 0.5
				OR = {
					has_war_with = RUS
					has_war_with = SOV
				}
			}
			modifier = {
				factor = 0.5
				has_elected_government = yes
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_ENT }
			}
		}
		ENT = {
			set_country_flag = ENT_refuse_colonies
			news_event = entente.320
			hidden_effect = { country_event = entente.328 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.314 option entente.314.b"
		name = entente.314.b #We'll put it aside for now
		ai_chance = { base = 60 }
		add_political_power = -50
		country_event = entente.305
	}
}

# Halifax Conference - CAN/NFA agree to recognize German colonies in Africa/SE Asia
country_event = {
	id = entente.315
	title = entente.315.t
	desc = entente.315.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.315 option entente.315.a"
		name = entente.315.a
		trigger = { tag = ENT }
		set_country_flag = ENT_agree_colonies
	}
	option = {
		log = "[GetLogInfo]: event entente.315 option entente.315.b"
		name = entente.315.b
		trigger = { tag = GER }
		add_political_power = 50
		country_event = { id = entente.305 days = 1 }
	}
	option = {
		log = "[GetLogInfo]: event entente.315 option entente.315.c"
		name = entente.315.c
		trigger = {
			tag = NFA
			NOT = { tag = ENT }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.315 option entente.315.c"
		name = entente.315.c
		trigger = {
			OR = {
				tag = GBR
				tag = CAN
			}
			NOT = { tag = ENT }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.315 option entente.315.e"
		name = entente.315.e
		trigger = {
			NOT = {
				tag = ENT
				tag = GER
				tag = NFA
				tag = GBR
				tag = CAN
			}
		}
	}
}

# Halifax Conference - Britain must renounce claim to Northern Ireland
country_event = {
	id = entente.316
	title = entente.316.t
	desc = entente.316.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.316 option entente.316.a"
		name = entente.316.a #Never!
		ai_chance = {
			base = 20
			modifier = {
				factor = 1.5
				has_authoritarian_government = yes
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_GER }
			}
		}
		GER = {
			add_opinion_modifier = { target = ROOT modifier = KR_disapproves_of_govt }
			country_event = { id = entente.317 days = 1 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.316 option entente.316.b"
		name = entente.316.b #Agree
		ai_chance = {
			base = 80
			modifier = {
				factor = 1.5
				has_elected_government = yes
			}
			modifier = {
				factor = 0.5
				has_authoritarian_government = yes
			}
		}
		GER = {
			add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt }
			country_event = { id = entente.318 days = 1 }
		}
	}
}

# Halifax Conference - CAN/GBR Refuses
country_event = {
	id = entente.317
	title = entente.317.t
	desc = entente.317.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes
	timeout_days = 4

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.317 option entente.317.a"
		name = entente.317.a #That it, then
		ai_chance = {
			base = 25
			modifier = {
				factor = 0.5
				has_global_flag = USA_civil_war_over_flag
				OR = {
					USA = { is_in_faction_with = ENT }
					PSA = { is_in_faction_with = ENT }
				}
			}
			modifier = {
				factor = 1.5
				has_global_flag = USA_civil_war_over_flag
				TEX = { is_in_faction_with = GER }
			}
			modifier = {
				factor = 0.5
				OR = {
					has_war_with = RUS
					has_war_with = SOV
				}
			}
			modifier = {
				factor = 2
				has_elected_government = yes
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = CAN_halifax option = CAN_HALIFAX_ENT }
			}
		}
		ENT = {
			set_country_flag = ENT_britain_refuse_northire
			news_event = entente.320
			hidden_effect = { country_event = entente.328 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.317 option entente.317.b"
		name = entente.317.b #We'll put it aside for now
		ai_chance = { base = 75 }
		add_political_power = -25
		country_event = entente.305
	}
}

# Halifax Conference - CAN/GBR agrees to give up Northern Ireland
country_event = {
	id = entente.318
	title = entente.318.t
	desc = entente.318.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes
	major = yes

	show_major = {
		OR = {
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
	}

	trigger = {
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.318 option entente.318.a"
		name = entente.318.a
		trigger = { tag = ENT }
		set_country_flag = ENT_britain_agree_northire
	}
	option = {
		log = "[GetLogInfo]: event entente.318 option entente.318.b"
		name = entente.318.b
		trigger = { tag = GER }
		add_political_power = 25
		country_event = { id = entente.305 days = 1 }
	}
	option = {
		log = "[GetLogInfo]: event entente.318 option entente.318.c"
		name = entente.318.c
		trigger = { tag = IRE }
		add_political_power = 50
	}
	option = {
		log = "[GetLogInfo]: event entente.318 option entente.318.e"
		name = entente.318.e
		trigger = {
			OR = {
				tag = GBR
				AND = {
					tag = CAN
					NOT = { country_exists = GBR }
				}
			}
			NOT = { tag = ENT }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.318 option entente.318.f"
		name = entente.318.f
		trigger = {
			NOT = {
				tag = ENT
				tag = GER
				tag = IRE
				tag = GBR
				AND = {
					tag = CAN
					NOT = { country_exists = GBR }
				}
			}
		}
	}
}

# Halifax Conference - Conference succeeds
news_event = {
	id = entente.319
	immediate = { log = "[GetLogInfo]: event entente.319" }
	title = entente.319.t
	desc = entente.319.d
	picture = GFX_news_event_CAN_conference

	is_triggered_only = yes
	major = yes

	trigger = {
		OR = {
			wants_world_news = yes
			is_in_faction_with = ENT
			is_in_faction_with = GER
		}
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		name = entente.319.a
		trigger = { tag = ENT }
		effect_tooltip = {
			add_political_power = 50
			if = {
				limit = { has_country_flag = ENT_france_agree_alsace }
				28 = { remove_claim_by = NFA }
			}
			every_country = {
				limit = { is_in_faction_with = GER }
				add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
				if = {
					limit = {
						NOT = { gives_military_access_to = ROOT }
					}
					give_military_access = ROOT
				}
			}
		}
	}
	option = {
		name = entente.319.b
		trigger = { tag = GER }
		effect_tooltip = {
			if = {
				limit = {
					ENT = { has_country_flag = ENT_france_agree_alsace }
					28 = { is_claimed_by = NFA }
				}
				28 = { remove_claim_by = NFA }
			}
			every_country = {
				limit = { is_in_faction_with = ENT }
				add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
				if = {
					limit = {
						NOT = { gives_military_access_to = ROOT }
					}
					give_military_access = ROOT
				}
			}
		}
	}
	option = {
		name = entente.319.c
		trigger = {
			NOT = {
				tag = ENT
				tag = GER
			}
			is_in_faction_with = ENT
		}
		effect_tooltip = {
			add_political_power = 25
			if = {
				limit = {
					ENT = { has_country_flag = ENT_france_agree_alsace }
					28 = { is_claimed_by = NFA }
				}
				28 = { remove_claim_by = NFA }
			}
			every_country = {
				limit = { is_in_faction_with = GER }
				add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
				if = {
					limit = {
						NOT = { gives_military_access_to = ROOT }
					}
					give_military_access = ROOT
				}
			}
		}
	}
	option = {
		name = entente.319.c
		trigger = {
			NOT = {
				tag = ENT
				tag = GER
			}
			is_in_faction_with = GER
		}
		effect_tooltip = {
			add_political_power = 25
			if = {
				limit = {
					ENT = { has_country_flag = ENT_france_agree_alsace }
					28 = { is_claimed_by = NFA }
				}
				28 = { remove_claim_by = NFA }
			}
			every_country = {
				limit = { is_in_faction_with = ENT }
				add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
				if = {
					limit = {
						NOT = { gives_military_access_to = ROOT }
					}
					give_military_access = ROOT
				}
			}
		}
	}
	option = {
		name = entente.319.e
		trigger = {
			has_socialist_government = yes
			NOT = {
				is_in_faction_with = ENT
				is_in_faction_with = GER
			}
		}
	}
	option = {
		name = entente.319.f
		trigger = {
			NOT = {
				has_socialist_government = yes
				is_in_faction_with = ENT
				is_in_faction_with = GER
			}
		}
	}
}

# Halifax Conference - Conference ends with disagreement
news_event = {
	id = entente.320
	immediate = { log = "[GetLogInfo]: event entente.320" }
	title = entente.320.t
	picture = GFX_news_event_CAN_conference

	desc = {
		text = entente.320.d.alsace
		trigger = { ENT = { has_country_flag = ENT_france_refuse_alsace } }
	}
	desc = {
		text = entente.320.d.mittel
		trigger = { ENT = { has_country_flag = ENT_france_refuse_mittel } }
	}
	desc = {
		text = entente.320.d.colonies
		trigger = { ENT = { has_country_flag = ENT_refuse_colonies } }
	}
	desc = {
		text = entente.320.d.northire
		trigger = { ENT = { has_country_flag = ENT_britain_refuse_northire } }
	}

	is_triggered_only = yes
	major = yes

	trigger = {
		wants_world_news = yes
		ENT = {
			OR = {
				tag = CAN
				tag = NFA
				tag = GBR
			}
			is_faction_leader = yes
			has_war_with = FRA
			NOT = { has_war_with = GER }
		}
		GER = {
			is_faction_leader = yes
			has_war_with = FRA
		}
	}

	option = {
		name = entente.320.a
		trigger = { tag = ENT }
	}
	option = {
		name = entente.320.b
		trigger = { tag = GER }
	}
	option = {
		name = entente.320.c
		trigger = {
			NOT = {
				tag = ENT
				tag = GER
			}
			OR = {
				is_in_faction_with = ENT
				is_in_faction_with = GER
			}
		}
	}
	option = {
		name = entente.320.e
		trigger = {
			has_socialist_government = yes
			NOT = {
				is_in_faction_with = ENT
				is_in_faction_with = GER
			}
		}
	}
	option = {
		name = entente.320.f
		trigger = {
			NOT = {
				has_socialist_government = yes
				is_in_faction_with = ENT
				is_in_faction_with = GER
			}
		}
	}
}

#321 is free

# Return French territory?
country_event = {
	id = entente.322
	title = entente.322.t
	desc = entente.322.d
	picture = GFX_report_event_generic_conference2

	timeout_days = 4

	trigger = {
		is_in_faction_with = GER
		has_global_flag = GER_stay_out_france_uk
		NOT = { country_exists = FRA }
		OR = {
			NFA = {
				exists = yes
				NOT = { has_war_with = ROOT }
			}
			ENT = {
				is_faction_leader = yes
				NOT = { has_war_with = ROOT }
			}
		}
		any_owned_state = {
			is_european_france = yes
			is_claim_or_core_of_ROOT = no
		}
	}

	mean_time_to_happen = {
		days = 3
	}

	option = {
		log = "[GetLogInfo]: event entente.322 option entente.322.a"
		name = entente.322.a
		if = {
			limit = {
				NFA = {
					exists = yes
					NOT = { has_war_with = ROOT }
				}
			}
			NFA = { add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt } }
			every_owned_state = {
				limit = {
					is_european_france = yes
					is_claim_or_core_of_ROOT = no
				}
				transfer_state_to = NFA
			}
			hidden_effect = {
				NFA = {
					set_country_flag = ENT_returning_france
					country_event = entente.329
				}
			}
		}
		else = {
			ENT = { add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt } }
			every_owned_state = {
				limit = {
					is_european_france = yes
					is_claim_or_core_of_ROOT = no
				}
				transfer_state_to = ENT
			}
			hidden_effect = {
				ENT = {
					set_country_flag = ENT_returning_france
					country_event = entente.329
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.322 option entente.322.b"
		name = entente.322.b
		trigger = { is_faction_leader = yes }
		ai_chance = { base = 0 }
		add_political_power = -250
		add_stability = -0.10
		clr_global_flag = GER_stay_out_france_uk
		clr_global_flag = ENT_britain_agree_northire
		clr_global_flag = ENT_agree_colonies
		if = {
			limit = { has_global_flag = ENT_france_agree_mittel }
			clr_global_flag = ENT_france_agree_mittel
			NFA = {
				GER_leave_mitteleuropa = yes
				clr_country_flag = CAN_refused_iedc
			}
		}
		if = {
			limit = { has_global_flag = ENT_france_agree_alsace }
			clr_global_flag = ENT_france_agree_alsace
			28 = { add_claim_by = NFA }
		}
		every_country = {
			limit = { is_in_faction_with = ENT }
			country_event = entente.324
		}
	}
}

# Return British territory?
country_event = {
	id = entente.323
	title = entente.323.t
	desc = entente.323.d
	picture = GFX_report_event_generic_conference2

	timeout_days = 4

	trigger = {
		is_in_faction_with = GER
		has_global_flag = GER_stay_out_france_uk
		NOT = { country_exists = ENG }
		OR = {
			GBR = {
				exists = yes
				NOT = { has_war_with = ROOT }
			}
			ENT = {
				is_faction_leader = yes
				NOT = { has_war_with = ROOT }
			}
		}
		any_owned_state = {
			is_great_britain = yes
			is_claim_or_core_of_ROOT = no
		}
	}

	mean_time_to_happen = {
		days = 3
	}

	option = {
		log = "[GetLogInfo]: event entente.323 option entente.323.a"
		name = entente.323.a
		if = {
			limit = {
				GBR = {
					exists = yes
					NOT = { has_war_with = ROOT }
				}
			}
			GBR = { add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt } }
			effect_tooltip = {
				every_owned_state = {
					limit = {
						is_claim_or_core_of_ROOT = no
						is_great_britain = yes
					}
					transfer_state_to = GBR
					teleport_armies = {
						limit = { is_ally_with = GER }
						to_state_array = owned_controlled_states
					}
				}
			}
			hidden_effect = {
				GBR = {
					set_country_flag = ENT_returning_britain
					country_event = entente.329
				}
			}
		}
		else = {
			ENT = { add_opinion_modifier = { target = ROOT modifier = KR_approves_of_govt } }
			effect_tooltip = {
				every_owned_state = {
					limit = {
						is_great_britain = yes
						is_claim_or_core_of_ROOT = no
					}
					transfer_state_to = CAN
					teleport_armies = {
						limit = { is_ally_with = GER }
						to_state_array = owned_controlled_states
					}
				}
			}
			hidden_effect = {
				CAN = {
					set_country_flag = ENT_returning_britain
					country_event = entente.329
				}
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.323 option entente.323.b"
		name = entente.323.b
		trigger = { is_faction_leader = yes }
		ai_chance = { base = 0 }
		add_political_power = -250
		add_stability = -0.10
		clr_global_flag = GER_stay_out_france_uk
		clr_global_flag = ENT_britain_agree_northire
		clr_global_flag = ENT_agree_colonies
		if = {
			limit = { has_global_flag = ENT_france_agree_mittel }
			clr_global_flag = ENT_france_agree_mittel
			NFA = {
				GER_leave_mitteleuropa = yes
				clr_country_flag = CAN_refused_iedc
			}
		}
		if = {
			limit = { has_global_flag = ENT_france_agree_alsace }
			clr_global_flag = ENT_france_agree_alsace
			28 = { add_claim_by = NFA }
		}
		every_country = {
			limit = { is_in_faction_with = ENT }
			country_event = entente.324
		}
	}
}

# Germany betrays Halifax Conf terms
country_event = {
	id = entente.324
	title = entente.324.t
	desc = entente.324.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.324 option entente.324.a"
		name = entente.324.a
		every_country = {
			limit = { is_in_faction_with = FROM }
			remove_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
			ROOT = {
				remove_opinion_modifier = { target = PREV modifier = CAN_halifax_conference }
			}
			if = {
				limit = { ROOT = { gives_military_access_to = PREV } }
				diplomatic_relation = {
					country = ROOT
					relation = military_access
					active = no
				}
			}
			if = {
				limit = { gives_military_access_to = ROOT }
				ROOT = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
						active = no
					}
				}
			}
		}
	}
}

# Hidden events
country_event = {
	id = entente.325

	hidden = yes
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.325 option 1"
		add_political_power = 50
		clr_country_flag = ENT_france_refuse_alsace
		clr_country_flag = ENT_france_refuse_mittel
		clr_country_flag = ENT_refuse_colonies
		clr_country_flag = ENT_britain_refuse_northire
		if = {
			limit = { has_country_flag = ENT_france_agree_alsace }
			clr_country_flag = ENT_france_agree_alsace
			set_global_flag = ENT_france_agree_alsace
			28 = { remove_claim_by = NFA }
		}
		if = {
			limit = { has_country_flag = ENT_france_agree_mittel }
			clr_country_flag = ENT_france_agree_mittel
			set_global_flag = ENT_france_agree_mittel
		}
		if = {
			limit = { has_country_flag = ENT_agree_colonies }
			clr_country_flag = ENT_agree_colonies
			set_global_flag = ENT_agree_colonies
		}
		if = {
			limit = { has_country_flag = ENT_britain_agree_northire }
			clr_country_flag = ENT_britain_agree_northire
			set_global_flag = ENT_britain_agree_northire
		}
		every_country = {
			limit = { is_in_faction_with = GER }
			add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
			if = {
				limit = {
					NOT = { gives_military_access_to = ROOT }
					OR = {
						any_neighbor_country = { has_war_with = ROOT }
						tag = IRE
						tag = ICE
					}
				}
				give_military_access = ROOT
			}
		}
	}
}

country_event = {
	id = entente.326

	hidden = yes
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.326 option 1"
		clr_country_flag = GER_conf_demand_alsace
		clr_country_flag = GER_conf_demand_france_mitt
		clr_country_flag = GER_conf_demand_colonies
		clr_country_flag = GER_conf_demand_northireland
		set_global_flag = GER_stay_out_france_uk
		every_country = {
			limit = { is_in_faction_with = ENT }
			add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
			if = {
				limit = {
					NOT = { gives_military_access_to = ROOT }
					any_neighbor_country = { has_war_with = ROOT }
				}
				give_military_access = ROOT
			}
		}
	}
}

country_event = {
	id = entente.327

	hidden = yes
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.327 option 1"
		add_political_power = 25
		if = {
			limit = { is_in_faction_with = ENT }
			every_country = {
				limit = { is_in_faction_with = GER }
				add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
				if = {
					limit = {
						NOT = { gives_military_access_to = ROOT }
						OR = {
							any_neighbor_country = { has_war_with = ROOT }
							tag = IRE
							tag = ICE
						}
					}
					give_military_access = ROOT
				}
			}
		}
		if = {
			limit = { is_in_faction_with = GER }
			every_country = {
				limit = { is_in_faction_with = ENT }
				add_opinion_modifier = { target = ROOT modifier = CAN_halifax_conference }
				if = {
					limit = {
						NOT = { gives_military_access_to = ROOT }
						any_neighbor_country = { has_war_with = ROOT }
					}
					give_military_access = ROOT
				}
			}
		}
	}
}

country_event = {
	id = entente.328

	hidden = yes
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.328 option 1"
		clr_country_flag = ENT_france_refuse_alsace
		clr_country_flag = ENT_france_agree_alsace
		clr_country_flag = ENT_france_refuse_mittel
		clr_country_flag = ENT_france_agree_mittel
		clr_country_flag = ENT_refuse_colonies
		clr_country_flag = ENT_agree_colonies
		clr_country_flag = ENT_britain_refuse_northire
		clr_country_flag = ENT_britain_agree_northire
		GER = {
			clr_country_flag = GER_conf_demand_alsace
			clr_country_flag = GER_conf_demand_france_mitt
			clr_country_flag = GER_conf_demand_colonies
			clr_country_flag = GER_conf_demand_northireland
		}
	}
}

# Germany returns land, as promised
country_event = {
	id = entente.329
	title = entente.329.t
	picture = GFX_report_event_generic_diplomacy3

	desc = {
		text = entente.329.d.british
		trigger = { has_country_flag = ENT_returning_britain }
	}
	desc = {
		text = entente.329.d.french
		trigger = { has_country_flag = ENT_returning_france }
	}

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.329 option entente.329.a"
		name = entente.329.a
		if = {
			limit = { has_country_flag = ENT_returning_france }
			clr_country_flag = ENT_returning_france
			every_state = {
				limit = {
					is_owned_by = FROM
					is_claim_or_core_of_FROM = no
					is_european_france = yes
				}
				transfer_state_to = ROOT
			}
		}
		if = {
			limit = { has_country_flag = ENT_returning_britain }
			clr_country_flag = ENT_returning_britain
			every_state = {
				limit = {
					is_owned_by = FROM
					is_claim_or_core_of_FROM = no
					is_great_britain = yes
				}
				transfer_state_to = ROOT
				teleport_armies = {
					limit = { is_ally_with = GER }
					to_state_array = owned_controlled_states
				}
			}
		}
	}
}

# Germany's capitulation means Halifax Conference no longer applies
country_event = {
	id = entente.330
	title = entente.330.t
	picture = GFX_report_event_german_reichstag_bombed

	desc = {
		text = entente.330.d.gex
		trigger = { country_exists = GEX }
	}
	desc = {
		text = entente.330.d.nogex
		trigger = { NOT = { country_exists = GEX } }
	}

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.330 option entente.330.a"
		name = entente.330.a
		if = {
			limit = { tag = ENT }
			set_global_flag = ENT_had_halifax_agreement
			clr_global_flag = GER_stay_out_france_uk
			clr_global_flag = ENT_britain_agree_northire
			clr_global_flag = ENT_agree_colonies
			if = {
				limit = { has_global_flag = ENT_france_agree_mittel }
				clr_global_flag = ENT_france_agree_mittel
				NFA = {
					GER_leave_mitteleuropa = yes
					clr_country_flag = CAN_refused_iedc
				}
			}
			if = {
				limit = {
					has_global_flag = ENT_france_agree_alsace
					NFA = { is_in_faction_with = ENT }
				}
				clr_global_flag = ENT_france_agree_alsace
				28 = { add_claim_by = NFA }
			}
			if = {
				limit = { country_exists = GEX }
				hidden_effect = {
					GEX = { country_event = entente.330 }
				}
			}
		}
	}
}

# hidden event to break Halifax if GER is at war with ENT
country_event = {
	id = entente.331

	hidden = yes
	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_global_flag = GER_stay_out_france_uk
			has_global_flag = ENT_britain_agree_northire
			has_global_flag = ENT_agree_colonies
			has_global_flag = ENT_france_agree_alsace
			has_global_flag = ENT_france_agree_mittel
		}
	}

	option = {
		log = "[GetLogInfo]: event entente.331 option 1"
		GER = { country_event = entente.332 }
		GBR = { country_event = entente.332 }
		CAN = { country_event = entente.332 }
		NFA = { country_event = entente.332 }
	}
}

# Promises dropped if war between Germany/Entente begins
country_event = {
	id = entente.332
	title = entente.332.t
	desc = entente.332.d
	picture = GFX_report_event_generic_conference2

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.332 option entente.332.a"
		name = entente.332.a
		clr_global_flag = GER_stay_out_france_uk
		clr_global_flag = ENT_britain_agree_northire
		clr_global_flag = ENT_agree_colonies
		clr_global_flag = ENT_france_agree_alsace
		clr_global_flag = ENT_france_agree_mittel
		if = {
			limit = { tag = NFA }
			clr_country_flag = CAN_refused_iedc
			if = {
				limit = { 28 = { is_claim_or_core_of_ROOT = no } }
				28 = { add_claim_by = NFA }
			}
		}
	}
}

# Demanding Return of Land
country_event = {
	id = entente.340
	title = entente.340.t
	picture = GFX_report_event_generic_conference1

	desc = {
		text = entente.340.d.british
		trigger = {
			event_target:ENT_demand = { has_country_flag = ENT_has_british_land }
		}
	}
	desc = {
		text = entente.340.d.french
		trigger = {
			event_target:ENT_demand = {
				NOT = { has_country_flag = ENT_has_british_land }
				has_country_flag = ENT_has_french_land
			}
		}
	}

	trigger = {
		tag = ENT
		is_faction_leader = yes
		any_allied_country = {
			OR = {
				AND = {
					is_subject = no
					NOT = {
						country_exists = GBR
						has_country_flag = ENT_receiving_demand
						has_war_with = ROOT
					}
					OR = {
						has_subject = GBP
						has_subject = ENG
						has_subject = SCO
						has_subject = WLS
						any_owned_state = {
							is_great_britain = yes
							is_claim_or_core_of_PREV = no
						}
					}
				}
				AND = {
					is_subject = no
					is_in_faction_with = NFA
					NOT = {
						tag = NFA
						has_country_flag = ENT_receiving_demand
						has_war_with = ROOT
					}
					OR = {
						has_subject = BRI
						any_owned_state = {
							is_european_france = yes
							is_claim_or_core_of_PREV = no
						}
					}
				}
			}
		}
	}

	immediate = {
		hidden_effect = {
			random_other_country = {
				limit = {
					is_in_faction_with = ROOT
					OR = {
						AND = {
							is_subject = no
							NOT = {
								country_exists = GBR
								has_country_flag = ENT_receiving_demand
								has_war_with = ROOT
							}
							OR = {
								has_subject = GBP
								has_subject = ENG
								has_subject = SCO
								has_subject = WLS
								any_owned_state = {
									is_great_britain = yes
									is_claim_or_core_of_PREV = no
								}
							}
						}
						AND = {
							is_subject = no
							is_in_faction_with = NFA
							NOT = {
								tag = NFA
								has_country_flag = ENT_receiving_demand
								has_war_with = ROOT
							}
							OR = {
								has_subject = BRI
								any_owned_state = {
									is_european_france = yes
									is_claim_or_core_of_PREV = no
								}
							}
						}
					}
				}
				if = {
					limit = {
						NOT = {
							country_exists = GBR
							has_country_flag = ENT_receiving_demand
							has_war_with = ROOT
						}
						OR = {
							has_subject = GBP
							has_subject = ENG
							has_subject = SCO
							has_subject = WLS
							any_owned_state = {
								is_great_britain = yes
								is_claim_or_core_of_PREV = no
							}
						}
					}
					set_country_flag = ENT_has_british_land
				}
				else = {
					set_country_flag = ENT_has_french_land
				}
				set_country_flag = ENT_receiving_demand
				save_event_target_as = ENT_demand
			}
		}
	}

	mean_time_to_happen = {
		months = 1
	}

	option = {
		log = "[GetLogInfo]: event entente.340 option entente.340.a"
		name = entente.340.a #send demand
		event_target:ENT_demand = {
			country_event = entente.341
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.340 option entente.340.b"
		name = entente.340.b #don't care
		ai_chance = { base = 0 }
	}
}

country_event = {
	id = entente.341
	title = entente.341.t
	desc = entente.341.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.341 option entente.341.a"
		name = entente.341.a #return the lands
		clr_country_flag = ENT_has_british_land
		clr_country_flag = ENT_has_french_land
		clr_country_flag = ENT_receiving_demand
		if = {
			limit = {
				country_exists = CAN
				is_in_faction_with = CAN
			}
			reverse_add_opinion_modifier = { target = CAN modifier = KR_approves_of_govt }
			every_other_country = {
				limit = {
					is_subject_of = ROOT
					OR = {
						tag = GBP
						tag = ENG
						tag = SCO
						tag = WLS
					}
				}
				CAN = { puppet = PREV }
			}
			every_owned_state = {
				limit = {
					is_great_britain = yes
					is_claim_or_core_of_ROOT = no
				}
				transfer_state_to = CAN
			}
		}
		else = {
			every_other_country = {
				limit = {
					is_subject_of = ROOT
					OR = {
						tag = GBP
						tag = ENG
						tag = SCO
						tag = WLS
					}
				}
				FROM = { puppet = PREV }
			}
			every_owned_state = {
				limit = {
					is_great_britain = yes
					is_claim_or_core_of_ROOT = no
				}
				transfer_state_to = FROM
			}
		}
		if = {
			limit = {
				country_exists = NFA
				is_in_faction_with = NFA
			}
			reverse_add_opinion_modifier = { target = NFA modifier = KR_approves_of_govt }
			every_other_country = {
				limit = {
					is_subject_of = ROOT
					tag = BRI
				}
				NFA = {
					annex_country = {
						target = PREV
						transfer_troops = no
					}
				}
			}
			every_owned_state = {
				limit = {
					is_european_france = yes
					is_claim_or_core_of_ROOT = no
				}
				transfer_state_to = NFA
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.341 option entente.341.b"
		name = entente.341.b #refuse
		ai_chance = { base = 0 }
		clr_country_flag = ENT_has_british_land
		clr_country_flag = ENT_has_french_land
		clr_country_flag = ENT_receiving_demand
		add_political_power = -100
		leave_faction = yes
		FROM = {
			country_event = entente.342
		}
	}
}

country_event = {
	id = entente.342
	title = entente.342.t
	desc = entente.342.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event entente.342 option entente.342.a"
		name = entente.342.a
		effect_tooltip = {
			remove_from_faction = FROM
		}
		if = {
			limit = { is_ai = yes }
			add_ai_strategy = {
				type = declare_war
				id = FROM
				value = 100
			}
			every_country = {
				limit = { is_in_faction_with = ROOT }
				add_ai_strategy = {
					type = conquer
					id = FROM
					value = 100
				}
				add_ai_strategy = {
					type = antagonize
					id = FROM
					value = 100
				}
			}
		}
		every_country = {
			limit = { is_in_faction_with = ROOT }
			add_opinion_modifier = { target = FROM modifier = KR_outraged }
		}
	}
}

### East Asian Peace Events

# Chinese Peace-offer over War for HK
country_event = {
	id = entente.343
	title = entente.343.t
	desc = entente.343.d
	picture = GFX_report_event_generic_conference1

	trigger = {
		tag = 326.controller
		has_war_with = ENT
		has_country_flag = { flag = CHI_war_vs_ENT days > 180 }
		is_valid_peace_target = yes
		ENT = { is_valid_peace_target = yes }
		NOT = {
			has_country_flag = CHI_refuse_entente_peace
			surrender_progress > 0
			owns_state = 743 #Shanghai
			owns_state = 746 #Ningbo
			owns_state = 747 #Fuzhou
			owns_state = 801 #Shantou
			owns_state = 326 #Hong Kong
		}
	}

	mean_time_to_happen = {
		days = 7
	}

	option = { #offer peace to the Entente
		log = "[GetLogInfo]: event entente.343 option entente.343.a"
		name = entente.343.a
		ENT = {
			country_event = { id = entente.344 days = 2 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.343 option entente.343.b"
		name = entente.343.b
		ai_chance = { base = 0 }
		add_war_support = -0.10
		add_stability = -0.10
		set_country_flag = CHI_refuse_entente_peace
	}
}

# Chinese offer peace
country_event = {
	id = entente.344
	title = entente.344.t
	desc = entente.344.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = { #Accept peace
		log = "[GetLogInfo]: event entente.344 option entente.344.a"
		name = entente.344.a
		every_other_country = {
			limit = {
				is_tag_in_china_area = yes
				is_ally_with = ROOT
			}
			if = {
				limit = { is_subject = yes }
				overlord = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_free
					}
				}
			}
			leave_faction = yes
		}
		every_state = {
			limit = {
				is_china_claim_area = yes
				owner = { is_ally_with = ROOT }
				if = {
					limit = { state = 524 } #Taiwan
					controller = { is_ally_with = FROM }
				}
			}
			transfer_state_to = FROM
		}
		var:326.controller = {
			white_peace_with_ROOT = yes
			every_other_country = {
				limit = { is_ally_with = ROOT }
				diplomatic_relation = {
					country = ROOT
					relation = non_aggression_pact
				}
				set_truce = { target = ROOT days = 730 }
			}
			country_event = { id = entente.345 days = 1 }
		}
		hidden_effect = {
			if = {
				limit = {
					HAW = { #Entente Hawaii forced out by an American peace deal
						has_war_with = FROM
						NOT = { has_war_with_wargoal_against = FROM }
						NOT = { FROM = { has_war_with_wargoal_against = PREV } }
						is_valid_peace_target = yes
					}
				}
				HAW = { save_event_target_as = white_peace_receiver }
				FROM = { white_peace_with_TARGET = yes }
			}
		}
	}
	option = { #We fight on!
		log = "[GetLogInfo]: event entente.344 option entente.344.b"
		name = entente.344.b
		ai_chance = { base = 0 }
		var:326.controller = {
			country_event = { id = entente.346 days = 1 }
		}
	}
}

# The Entente Accepts
country_event = {
	id = entente.345
	title = entente.345.t
	desc = entente.345.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = { #Excellent
		log = "[GetLogInfo]: event entente.345 option entente.345.a"
		name = entente.345.a
	}
}

# The Entente Rejects Peace!
country_event = {
	id = entente.346
	title = entente.346.t
	desc = entente.346.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = { #Very well
		log = "[GetLogInfo]: event entente.346 option entente.346.a"
		name = entente.346.a
	}
}

# Japan Offers Peace to the Entente
country_event = {
	id = entente.347
	title = entente.347.t
	desc = entente.347.d
	picture = GFX_report_event_generic_conference1

	trigger = {
		tag = JAP
		has_war_with = ENT
		has_global_flag = { flag = JAP_war_vs_ENT days > 180 }
		surrender_progress < 0.05
		is_valid_peace_target = yes
		ENT = {
			is_valid_peace_target = yes
			NOT = {
				any_allied_country = {
					OR = {
						is_in_asia = yes
						is_in_australia = yes
					}
					has_capitulated = no
				}
			}
		}
	}

	mean_time_to_happen = {
		days = 7
	}

	fire_only_once = yes

	option = { #offer peace to the Entente
		log = "[GetLogInfo]: event entente.347 option entente.347.a"
		name = entente.347.a
		ENT = {
			country_event = { id = entente.348 days = 2 }
		}
	}
	option = {
		log = "[GetLogInfo]: event entente.347 option entente.347.b"
		name = entente.347.b
		ai_chance = { base = 0 }
		add_war_support = -0.10
		add_stability = -0.10
	}
}

# Japanese offer peace
country_event = {
	id = entente.348
	title = entente.348.t
	desc = entente.348.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = { #Accept peace
		log = "[GetLogInfo]: event entente.348 option entente.348.a"
		name = entente.348.a
		every_other_country = {
			limit = {
				is_in_faction_with = ROOT
				has_capitulated = yes
				OR = {
					is_in_asia = yes
					is_in_india = yes
					is_in_australia = yes
				}
			}
			if = {
				limit = { is_subject = yes }
				overlord = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_free
					}
				}
			}
			leave_faction = yes
			set_country_flag = KR_was_in_entente
		}
		every_state = {
			limit = {
				owner = { is_ally_with = ROOT }
				OR = {
					is_on_continent = asia
					is_on_continent = australia
				}
			}
			transfer_state_to = JAP
		}
		JAP = {
			white_peace_with_ROOT = yes
			country_event = { id = entente.349 days = 1 }
		}
		hidden_effect = { news_event = entente.351 }
	}
	option = { #We fight on!
		log = "[GetLogInfo]: event entente.348 option entente.348.b"
		name = entente.348.b
		ai_chance = { base = 0 }
		JAP = {
			country_event = { id = entente.350 days = 1 }
		}
	}
}

# The Entente Accepts
country_event = {
	id = entente.349
	title = entente.349.t
	desc = entente.349.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = { #Excellent
		log = "[GetLogInfo]: event entente.349 option entente.349.a"
		name = entente.349.a
	}
}

# The Entente Rejects Peace!
country_event = {
	id = entente.350
	title = entente.350.t
	desc = entente.350.d
	picture = GFX_report_event_generic_conference1

	is_triggered_only = yes

	option = { #Very well
		log = "[GetLogInfo]: event entente.350 option entente.350.a"
		name = entente.350.a
	}
}

# News event: Japan Signs Peace with the Entente
news_event = {
	id = entente.351
	immediate = { log = "[GetLogInfo]: event entente.351" }
	title = entente.351.t
	desc = entente.351.d
	picture = GFX_news_event_generic_sign_treaty2

	major = yes
	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	show_major = {
		NOT = {
			tag = JAP
			tag = ENT
		}
	}

	option = {
		name = entente.351.a
		trigger = { is_ally_with = JAP }
	}

	option = {
		name = entente.351.b
		trigger = { is_ally_with = ENT }
	}

	option = {
		name = entente.351.c
		trigger = {
			has_socialist_government = no
			NOT = {
				is_ally_with = JAP
				is_ally_with = ENT
			}
		}
	}

	option = {
		name = entente.351.e
		trigger = {
			has_socialist_government = yes
			NOT = { is_ally_with = ENT }
		}
	}
}


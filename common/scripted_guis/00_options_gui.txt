scripted_gui = {
	KR_options_gui = {
		context_type = player_context
		window_name = "kr_options_container"
		parent_window_token = top_bar
		dirty = global.kr_options_dirty

		ai_enabled = {
			always = no
		}

		visible = {
			has_global_flag = kr_options_visible
		}

		effects = {
			rename_button_click = {
				if = {
					limit = { has_global_flag = allowrenaming_flag }
					set_variable = { global.renaming_frame = 1 }
					clr_global_flag = allowrenaming_flag
				}
				else = {
					set_variable = { global.renaming_frame = 2 }
					set_global_flag = allowrenaming_flag
				}
				every_state = { rename_state_effect = yes }
				add_to_variable = { global.kr_options_dirty = 1 }
			}
			regional_news_button_click = {
				if = {
					limit = { has_global_flag = NEWS_SOME }
					set_variable = { global.regional_news_frame = 1 }
					clr_global_flag = NEWS_SOME
				}
				else = {
					set_variable = { global.regional_news_frame = 2 }
					set_global_flag = NEWS_SOME
				}
				add_to_variable = { global.kr_options_dirty = 1 }
			}
			world_news_button_click = {
				if = {
					limit = { has_global_flag = NEWS_ALL }
					set_variable = { global.world_news_frame = 1 }
					clr_global_flag = NEWS_ALL
				}
				else = {
					set_variable = { global.world_news_frame = 2 }
					set_global_flag = NEWS_ALL

					#also locks regional news into enabled
					set_variable = { global.regional_news_frame = 2 }
					set_global_flag = NEWS_SOME
				}
				add_to_variable = { global.kr_options_dirty = 1 }
			}
		}

		triggers = {
			regional_news_button_click_enabled = {
				NOT = { has_global_flag = NEWS_ALL }
			}
		}

		properties = {
			rename_button = {
				frame = global.renaming_frame
			}
			regional_news_button = {
				frame = global.regional_news_frame
			}
			world_news_button = {
				frame = global.world_news_frame
			}
		}
	}

	KR_options_button = {
		context_type = player_context
		window_name = "kr_options_button_container"
		parent_window_token = top_bar
		dirty = global.kr_options_dirty

		ai_enabled = {
			always = no
		}

		effects = {
			kr_options_button_click = {
				if = {
					limit = { has_global_flag = kr_options_visible }
					clr_global_flag = kr_options_visible
				}
				else = {
					set_global_flag = { flag = kr_options_visible days = 1 value = 1 }
				}
			}
		}
	}

	KR_help_button = {
		context_type = player_context
		window_name = "kr_help_button_container"
		parent_window_token = top_bar
		dirty = KR_welcome_splash_variable

		ai_enabled = { always = no }

		effects = {
			kr_help_button_click = {
				if = {
					limit = { NOT = { has_variable = KR_welcome_splash_variable } }
					if = {
						limit = { tag_has_country_intro = yes }
						set_variable = { KR_welcome_splash_variable = 1 }
					}
					else = {
						set_variable = { KR_welcome_splash_variable = 4 }
					}
				}
			}
		}
	}
}

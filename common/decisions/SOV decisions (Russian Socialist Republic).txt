################################
## Socialist Russia Decisions ##
## By Alpinia                 ##
################################

RUS_Industrial_Expansion_decisions = {
	SOV_The_First_Five_Year_Plan = {
		icon = eng_trade_unions_demand

		allowed = { always = no } #manually activated

		available = {
			num_of_factories > 120
			has_completed_focus = SOV_Khozraschyot
			has_completed_focus = SOV_Mechanisation
			has_completed_focus = SOV_Ural_Tractor_Plants
			has_completed_focus = SOV_Research_Investments
			has_completed_focus = SOV_Transsiberian_Expansion
			has_completed_focus = SOV_Resource_Prospection
		}

		is_good = no
		days_mission_timeout = 1825

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_The_First_Five_Year_Plan"
			add_political_power = 100
			add_stability = 0.10
			add_war_support = 0.2
		}

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout SOV_The_First_Five_Year_Plan"
			add_political_power = -100
			add_stability = -0.10
			add_war_support = -0.2
		}
	}
}

SOV_Spreading_The_Revolution_decisions = {
	SOV_Protect_The_Baltics = {
		icon = generic_civil_support

		available = {
			NOT = { has_country_flag = RUS_invited_country }
			at_peace_or_same_enemies_as_FROM = yes
		}

		visible = {
			is_in_faction = yes
			FROM = {
				has_socialist_government = yes
				is_subject = no
				is_in_faction = no
			}
		}

		targets = { EST LAT LIT }
		target_root_trigger = {
			is_faction_leader = yes
		}
		target_trigger = {
			FROM = {
				has_socialist_government = yes
				is_subject = no
				is_in_faction = no
			}
		}

		cost = 0
		days_remove = 10
		fire_only_once = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				FROM = {
					any_owned_state = { is_claim_or_core_of_ROOT = yes }
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_Protect_The_Baltics target: [From.GetName]"
			set_country_flag = { flag = RUS_invited_country days = 20 value = 1 }
			FROM = { country_event = { id = russoc.115 days = 3 random_hours = 72 } }
		}
	}
	SOV_Protect_Ukraine = {
		icon = generic_civil_support

		available = {
			strength_ratio = { tag = UKR ratio > 2 }
			surrender_progress < 0.01
		}

		visible = {
			is_in_faction = yes
			FROM = {
				has_socialist_government = yes
				is_subject = no
				is_in_faction = no
				NOT = { has_war_with = ROOT }
			}
		}

		targets = { UKR }
		target_root_trigger = { is_faction_leader = yes }
		target_trigger = {
			FROM = {
				has_socialist_government = yes
				is_subject = no
				is_in_faction = no
				NOT = { has_war_with = ROOT }
			}
		}

		cost = 0
		days_remove = 10
		fire_only_once = yes

		ai_will_do = { factor = 100 }

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_Protect_Ukraine target: [From.GetName]"
			set_country_flag = { flag = RUS_invited_country days = 20 value = 1 }
			FROM = { country_event = { id = ukraine_borotbist.115 days = 180 } }
		}
	}
	SOV_Invade_Far_East = {
		name = RUS_Attack_Region
		icon = hol_draw_up_staff_plans

		available = {
			if = {
				limit = {
					FROM = { NOT = { tag = JAP } }
				}
				is_neighbor_of = FROM
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { has_socialist_government = no }
		}

		targets = { TRM JAP }
		target_root_trigger = {
			NOT = { country_exists = GER }
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { has_socialist_government = no }
		}

		cost = 10
		days_remove = 30
		fire_only_once = yes
		war_with_target_on_remove = yes
		cancel_if_not_visible = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				NOT = { has_completed_focus = SOV_Allow_Small_Traders }
			}
			modifier = {
				factor = 0
				country_exists = GER #do not attack Japan before defeating Germany
			}
			modifier = {
				factor = 0
				RUS_dont_attack_if_vulnerable_or_preparing = yes
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_target_is_stronger = yes }
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_faction_is_stronger = yes }
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_overlord_is_stronger = yes }
			}
		}

		cancel_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision cancel SOV_Invade_Far_East target: [From.GetName]"
			clear_decision_attack_AI = yes
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_Invade_Far_East target: [From.GetName]"
			FROM = { incoming_war_notification_effect = yes }
			setup_decision_attack_AI = yes
			if = {
				limit = {
					FROM = { tag = JAP }
				}
				every_neighbor_country = {
					limit = {
						OR = {
							tag = TRM
							is_guaranteed_by = JAP
							JAP = { is_ally_with = PREV }
						}
					}
					set_country_flag = added_AI_strategies_@ROOT
					add_ai_strategy = {
						type = prepare_for_war
						id = ROOT
						value = 1000
					}
					ROOT = {
						add_ai_strategy = {
							type = prepare_for_war
							id = PREV
							value = 1000
						}
					}
					incoming_war_notification_effect = yes
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove SOV_Invade_Far_East target: [From.GetName]"
			clear_decision_attack_AI = yes
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
			every_other_country = {
				limit = { has_country_flag = added_AI_strategies_@ROOT }
				clr_country_flag = added_AI_strategies_@ROOT
				add_ai_strategy = {
					type = prepare_for_war
					id = ROOT
					value = 1000
				}
				ROOT = {
					add_ai_strategy = {
						type = prepare_for_war
						id = PREV
						value = 1000
					}
					if = {
						limit = { can_declare_war_on = PREV }
						declare_war_on = {
							target = PREV
							type = annex_everything
						}
					}
				}
			}
		}
	}
	SOV_Invade_Middle_East = {
		name = RUS_Attack_Region
		icon = hol_draw_up_staff_plans

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { has_socialist_government = no }
		}

		targets = { TUR PER AFG }
		target_root_trigger = {
			NOT = { country_exists = GER }
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { has_socialist_government = no }
		}

		cost = 10
		days_remove = 30
		fire_only_once = yes
		war_with_target_on_remove = yes
		cancel_if_not_visible = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				NOT = { has_completed_focus = SOV_Allow_Small_Traders }
			}
			modifier = {
				factor = 0
				RUS_dont_attack_if_vulnerable_or_preparing = yes
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_target_is_stronger = yes }
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_faction_is_stronger = yes }
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_overlord_is_stronger = yes }
			}
		}

		cancel_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision cancel SOV_Invade_Middle_East target: [From.GetName]"
			clear_decision_attack_AI = yes
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_Invade_Middle_East target: [From.GetName]"
			FROM = { incoming_war_notification_effect = yes }
			setup_decision_attack_AI = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove SOV_Invade_Middle_East target: [From.GetName]"
			clear_decision_attack_AI = yes
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	SOV_Attack_Europe = {
		name = RUS_Attack_Region
		icon = hol_draw_up_staff_plans

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
		}

		targets = { EST LAT LIT WHR UKR FIN GEO ARM AZR }
		target_root_trigger = {
			has_completed_focus = SOV_The_Final_Battle
		}
		target_trigger = {
			can_declare_war_on = FROM
		}

		cost = 10
		days_remove = 30
		fire_only_once = yes
		war_with_target_on_remove = yes
		cancel_if_not_visible = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				NOT = { has_completed_focus = SOV_Allow_Small_Traders }
			}
			modifier = {
				factor = 0
				FROM = {
					NOT = { original_tag = WHR }
					NOT = { original_tag = UKR }
					has_socialist_government = yes
				}
			}
			modifier = {
				factor = 0
				RUS_dont_attack_if_vulnerable_or_preparing = yes
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_target_is_stronger = yes }
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_faction_is_stronger = yes }
			}
			modifier = {
				factor = 0
				FROM = { RUS_dont_attack_if_overlord_is_stronger = yes }
			}
		}

		cancel_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision cancel SOV_Attack_Europe target: [From.GetName]"
			clear_decision_attack_AI = yes
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_Attack_Europe target: [From.GetName]"
			FROM = { incoming_war_notification_effect = yes }
			setup_decision_attack_AI = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove SOV_Attack_Europe target: [From.GetName]"
			clear_decision_attack_AI = yes
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	SOV_join_INT_wars = {
		icon = generic_prepare_civil_war

		available = {
			FROM = {
				has_defensive_war = yes
				any_enemy_country = {
					has_offensive_war_with = FROM
					NOT = { has_war_with = ROOT }
				}
			}
		}

		cost = 0
		days_re_enable = 15

		targets = { INT }
		target_trigger = {
			is_faction_leader = yes
			FROM = { is_faction_leader = yes }
		}

		ai_will_do = {
			factor = 0
			modifier = {
				add = 100
				FROM = {
					OR = {
						enemies_strength_ratio > 1
						surrender_progress > 0.05
					}
					any_enemy_country = {
						has_offensive_war_with = FROM
						NOT = { has_war_with = ROOT }
						is_valid_peace_target = yes
					}
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_join_INT_wars target: [From.GetName]"
			FROM = { country_event = { id = russoc.121 days = 1 } }
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				FROM = {
					every_enemy_country = {
						limit = {
							has_offensive_war_with = FROM
							NOT = { has_war_with = ROOT }
						}
						ROOT = {
							add_to_war = {
								targeted_alliance = FROM
								enemy = PREV
							}
						}
					}
				}
			}
		}
	}
	SOV_request_INT_join_wars = {
		icon = generic_prepare_civil_war

		available = {
			has_defensive_war = yes
			any_enemy_country = {
				has_offensive_war_with = PREV
				NOT = { has_war_with = FROM }
			}
		}

		targets = { INT }
		target_trigger = {
			is_faction_leader = yes
			FROM = { is_faction_leader = yes }
		}

		cost = 0
		days_re_enable = 15

		ai_will_do = {
			factor = 0
			modifier = {
				add = 100
				enemies_strength_ratio > 1
				any_enemy_country = {
					has_offensive_war_with = ROOT
					NOT = { has_war_with = FROM }
					is_valid_peace_target = yes
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete SOV_request_INT_join_wars target: [From.GetName]"
			FROM = { country_event = { id = russoc.122 days = 1 } }
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				every_enemy_country = {
					limit = {
						has_offensive_war_with = ROOT
						NOT = { has_war_with = FROM }
					}
					FROM = {
						add_to_war = {
							targeted_alliance = ROOT
							enemy = PREV
						}
					}
				}
			}
		}
	}
}

FRA_internationale_category = {
	INT_join_SOV_wars = {
		icon = generic_prepare_civil_war

		available = {
			FROM = {
				has_defensive_war = yes
				any_enemy_country = {
					has_offensive_war_with = PREV
					NOT = { has_war_with = ROOT }
				}
			}
		}

		cost = 0
		days_re_enable = 15

		targets = { SOV }
		target_trigger = {
			FROM = { is_faction_leader = yes }
			is_faction_leader = yes
		}

		ai_will_do = {
			base = 0
			modifier = {
				factor = 0
				has_country_flag = RUS_ai_call_to_war_cooldown
			}
			modifier = {
				add = 100
				FROM = {
					OR = {
						enemies_strength_ratio > 1
						surrender_progress > 0.05
					}
					any_enemy_country = {
						has_offensive_war_with = FROM
						NOT = { has_war_with = ROOT }
						is_valid_peace_target = yes
					}
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete INT_join_SOV_wars target: [From.GetName]"
			set_country_flag = { flag = RUS_ai_call_to_war_cooldown value = 1 days = 100 }
			FROM = { country_event = { id = russoc.121 days = 1 } }
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				FROM = {
					every_enemy_country = {
						limit = {
							has_offensive_war_with = FROM
							NOT = { has_war_with = ROOT }
						}
						ROOT = {
							add_to_war = {
								targeted_alliance = FROM
								enemy = PREV
							}
						}
					}
				}
			}
		}
	}
	INT_request_SOV_join_wars = {
		icon = generic_prepare_civil_war

		available = {
			has_defensive_war = yes
			any_enemy_country = {
				has_offensive_war_with = PREV
				NOT = { has_war_with = FROM }
			}
		}

		targets = { SOV }
		target_trigger = {
			FROM = { is_faction_leader = yes }
			is_faction_leader = yes
		}

		cost = 0
		days_re_enable = 15

		ai_will_do = {
			base = 0
			modifier = {
				factor = 0
				has_country_flag = RUS_ai_call_to_war_cooldown
			}
			modifier = {
				add = 100
				enemies_strength_ratio > 1
				any_enemy_country = {
					has_offensive_war_with = ROOT
					NOT = { has_war_with = FROM }
					is_valid_peace_target = yes
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete INT_request_SOV_join_wars target: [From.GetName]"
			set_country_flag = { flag = RUS_ai_call_to_war_cooldown value = 1 days = 100 }
			FROM = { country_event = { id = russoc.122 days = 1 } }
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				every_enemy_country = {
					limit = {
						has_offensive_war_with = ROOT
						NOT = { has_war_with = FROM }
					}
					FROM = {
						add_to_war = {
							targeted_alliance = ROOT
							enemy = PREV
						}
					}
				}
			}
		}
	}
}

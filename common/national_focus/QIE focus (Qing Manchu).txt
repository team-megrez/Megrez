###########################
# Qing - Manchu Focus Tree
# By MantisToboggan
# Revamp by Chiron29
###########################

focus_tree = {
	id = QIE_manchu
	country = { factor = 0 }

	default = no
	continuous_focus_position = {
		x = 2340
		y = 1100
	}

	focus = {
		id = QIE_purge_zhili
		icon = GFX_goal_QIE_purge_zhili
		cost = 2

		x = 21
		y = 0

		select_effect = {
			log = "[GetDateText]: [Root.GetName]: Select Focus QIE_purge_zhili"
			country_event = { id = qiecoup.30 days = 1 }
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_purge_zhili"
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = -0.10
			}
			if = {
				limit = { has_country_flag = QIE_yan_backs_coup }
				615 = { set_demilitarized_zone = no }
			}
			else = {
				1063 = { set_demilitarized_zone = no }
			}
			activate_targeted_decision = { target = FROM decision = QIE_push_to_yellow_river }
			activate_targeted_decision = { target = FROM decision = QIE_assault_luoyang }
			activate_targeted_decision = { target = FROM decision = QIE_mop_up_south }
			activate_targeted_decision = { target = FROM decision = QIE_final_push }
		}
		search_filters = { FOCUS_FILTER_ANNEXATION }
	}

	#coup backer
	focus = {
		id = QIE_coup_backer
		icon = GFX_goal_LEP_governor_question
		cost = 3

		x = 6
		y = 1

		prerequisite = { focus = QIE_purge_zhili }
		available = { has_country_flag = won_zhili_manchu_war }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_coup_backer"
			add_political_power = 15
			country_event = qiefocus.24
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_zhang_tianran_backer
		icon = GFX_goal_SQI_yiguandao
		cost = 4

		relative_position_id = QIE_coup_backer
		x = -3
		y = 1

		prerequisite = { focus = QIE_coup_backer }
		available = { has_country_flag = QIE_zhang_backs_coup }
		mutually_exclusive = {
			focus = QIE_qu_yingguang_backer
			focus = QIE_yan_xishan_backer
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_zhang_tianran_backer"
			add_ideas = QIE_zhang_tianran_backer_idea
		}
		search_filters = {
			FOCUS_FILTER_POLITICAL
			FOCUS_FILTER_INDUSTRY
			FOCUS_FILTER_RESEARCH
		}
	}

	focus = {
		id = QIE_qu_yingguang_backer
		icon = GFX_goal_SQI_confucianism
		cost = 4

		relative_position_id = QIE_coup_backer
		x = 0
		y = 1

		prerequisite = { focus = QIE_coup_backer }
		available = { has_country_flag = QIE_qu_backs_coup }
		mutually_exclusive = {
			focus = QIE_zhang_tianran_backer
			focus = QIE_yan_xishan_backer
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_qu_yingguang_backer"
			add_ideas = QIE_qu_yingguang_backer_idea_1
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_yan_xishan_backer
		icon = GFX_goal_generic_puppet_monarch
		cost = 4

		relative_position_id = QIE_coup_backer
		x = 3
		y = 1

		prerequisite = { focus = QIE_coup_backer }
		available = { has_country_flag = QIE_yan_backs_coup }
		mutually_exclusive = {
			focus = QIE_zhang_tianran_backer
			focus = QIE_qu_yingguang_backer
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_yan_xishan_backer"
			add_ideas = QIE_yan_xishan_backer_idea
		}
		search_filters = {
			FOCUS_FILTER_POLITICAL
			FOCUS_FILTER_INDUSTRY
			FOCUS_FILTER_RESEARCH
		}
	}

	focus = {
		id = QIE_yiguandao
		icon = GFX_goal_china_yiguandao
		cost = 5

		relative_position_id = QIE_zhang_tianran_backer
		x = -1
		y = 1

		prerequisite = { focus = QIE_zhang_tianran_backer }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_yiguandao"
			custom_effect_tooltip = QIE_yiguandao_influence_unlocked_TT
			hidden_effect = {
				QIE_add_yiguandao_modifier = yes
				QIE_recalculate_yiguandao_influence = yes
				activate_targeted_decision = { target = FROM decision = QIE_raise_yiguandao_militia }
				activate_targeted_decision = { target = FROM decision = QIE_refugee_workforce }
				activate_targeted_decision = { target = FROM decision = QIE_yiguandao_infiltraitors }
				activate_targeted_decision = { target = FROM decision = QIE_sponsor_prayer_meeting }
				activate_targeted_decision = { target = FROM decision = QIE_arrest_yiguandao_priest }
			}
			add_political_power = 100
			add_popularity = {
				ideology = national_populist
				popularity = 0.10
			}
			QIE_recalculate_yiguandao_influence = yes
			set_temp_variable = { ideology_change_var = 0.05 }
			change_ruling_party_popularity = yes
			hidden_effect = {
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = -0.05
				}
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_ceremonial_rites
		icon = GFX_focus_man_claim_the_mandate_of_heaven
		cost = 6

		relative_position_id = QIE_zhang_tianran_backer
		x = 1
		y = 1

		prerequisite = {
			focus = QIE_zhang_tianran_backer
			focus = QIE_qu_yingguang_backer
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_ceremonial_rites"
			set_temp_variable = { ideology_change_var = 0.075 }
			change_ruling_party_popularity = yes
			hidden_effect = {
				QIE_guo_zeyun = { set_nationality = QIE }
			}
			if = {
				limit = { has_free_political_advisor_slot = yes }
				activate_advisor = QIE_guo_zeyun
			}
			else = {
				add_political_power = 100
				effect_tooltip = {
					QIE_guo_zeyun = { set_nationality = QIE }
				}
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_gather_dynasties
		icon = GFX_goal_collaborate_local_elites
		cost = 4

		relative_position_id = QIE_zhang_tianran_backer
		x = 1
		y = 2

		prerequisite = {
			focus = QIE_yiguandao
			focus = QIE_modernize_monarchy
		}
		prerequisite = { focus = QIE_ceremonial_rites }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_gather_dynasties"
			QIE_reduce_fractured_empire = yes
			country_event = { id = qiefocus.23 days = 14 }
		}
	}

	focus = {
		id = QIE_bolster_legitimacy
		icon = GFX_goal_QIE_modernize_monarchy
		cost = 6

		relative_position_id = QIE_zhang_tianran_backer
		x = -1
		y = 2

		prerequisite = { focus = QIE_yiguandao }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_bolster_legitimacy"
			add_stability = 0.075
			country_event = { id = qiefocus.21 }
		}
		search_filters = { FOCUS_FILTER_STABILITY }
	}

	focus = {
		id = QIE_legitimate_emperor
		icon = GFX_goal_QIE_puyi_restored
		cost = 6

		relative_position_id = QIE_zhang_tianran_backer
		x = 0
		y = 3

		prerequisite = { focus = QIE_bolster_legitimacy }
		prerequisite = { focus = QIE_gather_dynasties }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_legitimate_emperor"
			swap_ideas = {
				remove_idea = QIE_zhang_tianran_backer_idea
				add_idea = QIE_legitimate_emperor_idea
			}
			add_popularity = {
				ideology = national_populist
				popularity = 0.03
			}
			QIE_recalculate_yiguandao_influence = yes
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {
		id = QIE_modernize_monarchy
		icon = GFX_goal_POR_royal_edicts
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 0
		y = 2

		prerequisite = { focus = QIE_qu_yingguang_backer }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_modernize_monarchy"
			QIE_reduce_fractured_empire = yes
			country_event = { id = qiefocus.13 }
		}
	}

	focus = {
		id = QIE_replace_corrupt_govs
		icon = GFX_goal_generic_tackle_corruption
		cost = 5

		relative_position_id = QIE_coup_backer
		x = 2
		y = 2

		prerequisite = {
			focus = QIE_yan_xishan_backer
			focus = QIE_qu_yingguang_backer
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_replace_corrupt_govs"
			add_timed_idea = {
				idea = QIE_rooting_out_corruption
				days = 200
			}
			add_stability = 0.05
			add_political_power = 50
		}
		search_filters = {
			FOCUS_FILTER_POLITICAL
			FOCUS_FILTER_STABILITY
		}
	}

	focus = {
		id = QIE_train_civil_servants
		icon = GFX_goal_civil_service
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 0
		y = 3

		prerequisite = { focus = QIE_modernize_monarchy }
		prerequisite = { focus = QIE_replace_corrupt_govs }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_train_civil_servants"
			custom_effect_tooltip = QIE_electoral_reforms_unlocked_TT
			custom_effect_tooltip = tooltip_white_line
			hidden_effect = {
				activate_targeted_decision = { target = FROM decision = QIE_electoral_districting }
				activate_targeted_decision = { target = FROM decision = QIE_polling_infrastructure }
				activate_targeted_decision = { target = FROM decision = QIE_empower_local_assemblies }
			}
			swap_ideas = {
				remove_idea = QIE_qu_yingguang_backer_idea_1
				add_idea = QIE_qu_yingguang_backer_idea_2
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_move_industry
		icon = GFX_goal_generic_industry_reallocation
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 2
		y = 4

		prerequisite = {
			focus = QIE_lessons_of_model_province
			focus = QIE_train_civil_servants
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_move_industry"
			608 = {
				remove_building = {
					type = industrial_complex
					level = 1
				}
				remove_building = {
					type = arms_factory
					level = 1
				}
			}
			614 = {
				remove_building = {
					type = industrial_complex
					level = 1
				}
			}
			1058 = {
				add_extra_state_shared_building_slots = 3
				add_building_construction = {
					type = arms_factory
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_revise_the_chinese_tripitaka
		icon = GFX_SIA_buddhisttraditions
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 0
		y = 4

		prerequisite = { focus = QIE_train_civil_servants }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_revise_the_chinese_tripitaka"
			swap_ideas = {
				remove_idea = QIE_qu_yingguang_backer_idea_2
				add_idea = QIE_qu_yingguang_backer_idea_3
			}
			set_temp_variable = { ideology_change_var = 0.05 }
			change_ruling_party_popularity = yes
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_imperial_academy
		icon = GFX_goal_ANQ_court_vermilion_society
		cost = 6

		relative_position_id = QIE_coup_backer
		x = -2
		y = 5

		prerequisite = {
			focus = QIE_revise_the_chinese_tripitaka
			focus = QIE_legitimate_emperor
		}
		available = {
			OR = {
				has_country_flag = QIE_zhang_backs_coup
				has_country_flag = QIE_qu_backs_coup
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_imperial_academy"
			china_add_research_slots = yes
		}
	}

	focus = {
		id = QIE_vigor_modernization
		icon = GFX_goal_social_reforms
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 4
		y = 2

		prerequisite = { focus = QIE_yan_xishan_backer }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_vigor_modernization"
			add_tech_bonus = {
				name = QIE_vigor_modernization
				bonus = 1
				uses = 2
				category = industry
			}
			china_add_research_slots = yes
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = QIE_lessons_of_model_province
		icon = GFX_goal_generic_railroad
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 4
		y = 3

		prerequisite = { focus = QIE_vigor_modernization }
		prerequisite = { focus = QIE_replace_corrupt_govs }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_lessons_of_model_province"
			QIE_reduce_fractured_empire = yes
			if = {
				limit = { owns_state = 1072 }
				1072 = {
					add_extra_state_shared_building_slots = 2
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			if = {
				limit = { owns_state = 615 }
				615 = {
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
			if = {
				limit = { owns_state = 1060 }
				1060 = {
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_nationalize_yan_thot
		icon = GFX_goal_revolution
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 4
		y = 4

		prerequisite = { focus = QIE_lessons_of_model_province }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_nationalize_yan_thot"
			swap_ideas = {
				remove_idea = QIE_yan_xishan_backer_idea
				add_idea = QIE_nationalized_yan_xishan_thought
			}
			if = {
				limit = { has_idea = QIE_cult_of_progress_idea }
				hidden_effect = {
					add_popularity = {
						ideology = paternal_autocrat
						popularity = 0.03
					}
				}
			}
		}
		search_filters = {
			FOCUS_FILTER_ARMY_BONUS
			FOCUS_FILTER_POLITICAL
			FOCUS_FILTER_INDUSTRY
		}
	}

	focus = {
		id = QIE_chinese_bismarck
		icon = GFX_goal_refugee_management
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 2
		y = 5

		prerequisite = { focus = QIE_nationalize_yan_thot }
		prerequisite = { focus = QIE_move_industry }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_chinese_bismarck"
			effect_tooltip = {
				swap_ruler_traits = {
					remove = QIE_restored_emperor
					add = QIE_patron_of_bismarck
				}
			}
			hidden_effect = {
				var:country_leader = {
					for_each_loop = {
						array = global.ideologies
						meta_effect = {
							text = {
								if = {
									limit = { has_ideology = [IDEOLOGY] }
									swap_country_leader_traits = {
										remove = QIE_restored_emperor
										add = QIE_patron_of_bismarck
										ideology = [IDEOLOGY]
									}
								}
							}
							IDEOLOGY = "[?v.GetTokenKey]"
						}
					}
				}
			}
			hidden_effect = {
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.03
				}
			}
		}
	}

	focus = {
		id = QIE_prepare_for_storm
		icon = GFX_goal_japan_helmet
		cost = 6

		relative_position_id = QIE_coup_backer
		x = 0
		y = 6

		prerequisite = {
			focus = QIE_imperial_academy
			focus = QIE_chinese_bismarck
		}
		available = {
			OR = {
				has_idea = QIE_banner_idea
				has_idea = QIE_YCP_militarized_state
				has_stability > 0.60
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_prepare_for_storm"
			if = {
				limit = {
					NOT = {
						has_war_with = JAP
						owns_state = 524
					}
				}
				add_ideas = QIE_prepare_for_storm_idea
				custom_effect_tooltip = tooltip_white_line
				custom_effect_tooltip = QIE_prepare_for_storm_idea_desc
			}
			else = {
				add_war_support = 0.15
			}
			#decisions and stuff
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	#start of Manchu domesic parties
	focus = {
		id = QIE_form_emergency_govt
		icon = GFX_GRE_empower_monarchy
		cost = 4

		x = 21
		y = 1

		prerequisite = { focus = QIE_purge_zhili }
		available = { has_country_flag = won_zhili_manchu_war }
		select_effect = {
			log = "[GetDateText]: [Root.GetName]: Select Focus QIE_form_emergency_govt"
			country_event = { id = qiefocus.15 days = 2 }
		}

		ai_will_do = { factor = 1000 }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_form_emergency_govt"
			country_event = qiefocus.18
		}
	}

	focus = {
		id = QIE_manchu_default_debt
		icon = GFX_goal_treaty_fails
		cost = 7

		relative_position_id = QIE_form_emergency_govt
		x = 4
		y = 1

		prerequisite = { focus = QIE_form_emergency_govt }
		mutually_exclusive = { focus = QIE_more_equal_treaties }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_manchu_default_debt"
			remove_ideas = QIE_big_debt
			add_timed_idea = {
				idea = QIE_defaulted_debt
				days = 700
			}
			country_event = { id = qiecoup.29 days = 2 }
		}
	}

	focus = {
		id = QIE_more_equal_treaties
		icon = GFX_goal_generic_debt_negotiations
		cost = 7

		relative_position_id = QIE_form_emergency_govt
		x = 2
		y = 1

		prerequisite = { focus = QIE_form_emergency_govt }
		mutually_exclusive = { focus = QIE_manchu_default_debt }
		ai_will_do = { factor = 1000 }

		available = {
			NOT = {
				has_completed_focus = QIE_pick_NCERA
				has_completed_focus = QIE_pick_YCP
				country_exists = LEP
				has_country_flag = QIE_germans_rejected_debt_negotiations
				has_country_flag = QIE_zhang_backs_coup
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_more_equal_treaties"
			GEA = { country_event = qiefocus.32 }
			if = {
				limit = { has_character = ANQ_sun_liren }
				retire_character = ANQ_sun_liren
			}
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				QIE = { custom_effect_tooltip = QIE_buymauser_tt }
			}
			hidden_effect = {
				set_country_flag = QIE_negotiated_debts
			}
		}
	}

	focus = {
		id = QIE_county_reorganization
		icon = GFX_goal_LEC_shanghai_yuan
		cost = 7

		relative_position_id = QIE_form_emergency_govt
		x = -4
		y = 1

		prerequisite = { focus = QIE_form_emergency_govt }
		mutually_exclusive = { focus = QIE_county_assemblies }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_county_reorganization"
			add_stability = -0.1
			set_temp_variable = { ideology_change_var = -0.05 }
			change_ruling_party_popularity = yes
			increase_mobilisation = yes
			if = {
				limit = { has_idea = QIE_fractured_empire2 }
				swap_ideas = {
					remove_idea = QIE_fractured_empire2
					add_idea = QIE_fractured_empire3
				}
			}
			else_if = {
				limit = { has_idea = QIE_fractured_empire3 }
				remove_ideas = QIE_fractured_empire3
			}
			if = {
				limit = { NOT = { has_country_flag = QIE_zhang_backs_coup } }
				add_popularity = {
					ideology = national_populist
					popularity = -0.1
				}
			}
			else = {
				add_popularity = {
					ideology = national_populist
					popularity = 0.05
				}
				add_political_power = 100
			}
		}
	}

	focus = {
		id = QIE_county_assemblies
		icon = GFX_goal_plantation_grants
		cost = 7

		relative_position_id = QIE_form_emergency_govt
		x = -2
		y = 1

		prerequisite = { focus = QIE_form_emergency_govt }
		mutually_exclusive = { focus = QIE_county_reorganization }
		available = { NOT = { has_completed_focus = QIE_pick_YCP } }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_county_assemblies"
			add_stability = 0.1
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = -0.05
			}
			set_temp_variable = { ideology_change_var = 0.1 }
			change_ruling_party_popularity = yes
			if = {
				limit = { has_idea = QIE_fractured_empire2 }
				swap_ideas = {
					remove_idea = QIE_fractured_empire2
					add_idea = QIE_fractured_empire3
				}
			}
			else_if = {
				limit = { has_idea = QIE_fractured_empire3 }
				remove_ideas = QIE_fractured_empire3
			}
		}
	}

	focus = {
		id = QIE_pick_NCERA
		icon = GFX_goal_QIE_ncera
		cost = 4

		relative_position_id = QIE_form_emergency_govt
		x = 6
		y = 1

		prerequisite = { focus = QIE_form_emergency_govt }
		available = {
			NOT = {
				has_idea = QIE_cult_of_progress_idea
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_pick_NCERA"
			add_political_power = 50
			add_popularity = {
				ideology = social_conservative
				popularity = 0.1
			}
			add_stability = -0.1
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_pick_MP
		icon = GFX_goal_QIE_manchu_symbol
		cost = 4

		relative_position_id = QIE_form_emergency_govt
		x = 0
		y = 1

		prerequisite = { focus = QIE_form_emergency_govt }
		available = {
			NOT = {
				has_idea = QIE_cult_of_progress_idea
			}
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
				NOT = { has_completed_focus = QIE_rural_loyalty }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_pick_MP"
			add_political_power = 50
			add_popularity = {
				ideology = paternal_autocrat
				popularity = 0.1
			}
			add_stability = -0.1
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_pick_YCP
		icon = GFX_goal_QIE_ycp
		cost = 4

		relative_position_id = QIE_form_emergency_govt
		x = -6
		y = 1

		prerequisite = { focus = QIE_form_emergency_govt }
		available = {
			NOT = {
				has_country_flag = QIE_zhang_backs_coup
			}
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
				NOT = { has_completed_focus = QIE_rural_loyalty }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_pick_YCP"
			add_political_power = 50
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = 0.1
			}
			add_stability = -0.1
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_reform_criminal_justice
		icon = GFX_goal_generic_trial
		cost = 7

		relative_position_id = QIE_pick_NCERA
		x = -2
		y = 1

		prerequisite = { focus = QIE_pick_NCERA }
		mutually_exclusive = { focus = QIE_new_coronation }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_PATAUT }
				has_completed_focus = QIE_centralize_state
			}
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_reform_criminal_justice"
			if = {
				limit = { has_idea = QIE_fractured_empire2 }
				swap_ideas = {
					remove_idea = QIE_fractured_empire2
					add_idea = QIE_fractured_empire3
				}
			}
			else_if = {
				limit = { has_idea = QIE_fractured_empire3 }
				remove_ideas = QIE_fractured_empire3
			}
			add_stability = 0.15
			add_popularity = {
				ideology = social_democrat
				popularity = 0.05
			}
			add_popularity = {
				ideology = social_conservative
				popularity = 0.05
			}
			if = {
				limit = {
					NOT = { has_government = social_conservative }
				}
				set_temp_variable = { coalition_partner_var = token:social_conservative }
				add_to_coalition = yes
			}
			if = {
				limit = {
					has_government = paternal_autocrat
					has_completed_focus = QIE_centralize_state
				}
				hidden_effect = {
					country_event = { id = qiefocus.19 days = 7 }
				}
			}
			if = {
				limit = {
					has_government = paternal_autocrat
					has_completed_focus = QIE_centralize_state
					NOT = { has_completed_focus = QIE_reform_criminal_justice }
				}
				custom_effect_tooltip = tooltip_white_line
				custom_effect_tooltip = QIE_bit_off_too_much_tt
			}
			else_if = {
				limit = {
					has_government = paternal_autocrat
					NOT = { has_completed_focus = QIE_appoint_viceroys }
				}
				custom_effect_tooltip = tooltip_white_line
				custom_effect_tooltip = QIE_delayed_gratification_tt
			}
		}
		search_filters = { FOCUS_FILTER_STABILITY }
	}

	focus = {
		id = QIE_rural_reform
		icon = GFX_goal_LEP_subsidize_villages
		cost = 7

		relative_position_id = QIE_pick_NCERA
		x = 0
		y = 1

		prerequisite = { focus = QIE_pick_NCERA }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		available = {
			set_temp_variable = { coalition_target = token:social_conservative }
			OR = {
				has_government = social_conservative
				has_coalition_with_target = yes
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_rural_reform"
			add_ideas = QIE_rural_reform_idea
			if = {
				limit = {
					NOT = {
						has_government = social_conservative
						has_government = social_democrat
					}
				}
				set_temp_variable = { coalition_partner_var = token:social_democrat }
				add_to_coalition = yes
			}
		}
	}

	focus = {
		id = QIE_rural_infrastructure
		icon = GFX_goal_OTT_Railroad
		cost = 7

		relative_position_id = QIE_pick_NCERA
		x = 2
		y = 1

		prerequisite = { focus = QIE_pick_NCERA }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_rural_infrastructure"
			1059 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			1058 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_kang_youwei
		icon = GFX_goal_QIE_kang_youwei
		cost = 7

		relative_position_id = QIE_pick_NCERA
		x = -1
		y = 2

		prerequisite = {
			focus = QIE_rural_reform
			focus = QIE_reform_criminal_justice
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_kang_youwei"
			add_ideas = QIE_Legacy_Kang_Youwei
			add_popularity = {
				ideology = social_conservative
				popularity = 0.05
			}
			hidden_effect = {
				country_event = { id = qieflavor.20 days = 20 random_days = 5 }
			}
		}
	}

	focus = {
		id = QIE_ncera_industry
		icon = GFX_goal_production
		cost = 7

		relative_position_id = QIE_pick_NCERA
		x = 1
		y = 2

		prerequisite = { focus = QIE_rural_infrastructure }
		prerequisite = { focus = QIE_rural_reform }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_ncera_industry"
			1058 = {
				increase_state_category_by_one_level = yes
			}
			1061 = {
				increase_state_category_by_one_level = yes
			}
			1060 = {
				increase_state_category_by_one_level = yes
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
			if = {
				limit = { has_tech = dispersed_industry }
				add_tech_bonus = {
					name = QIE_ncera_industry
					bonus = 0.5
					uses = 1
					category = dispersed_industry_category
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_benevolent_emperor
		icon = GFX_goal_generic_controlled_board
		cost = 7

		relative_position_id = QIE_pick_NCERA
		x = -1
		y = 3

		prerequisite = {
			focus = QIE_kang_youwei
		}
		available = {
			NOT = { has_idea = QIE_unifying_emperor_idea }
			has_stability > 0.5
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_benevolent_emperor"
			swap_ideas = {
				remove_idea = QIE_Legacy_Kang_Youwei
				add_idea = QIE_Legacy_Kang_Youwei_2
			}
			if = {
				limit = { has_authoritarian_government = yes }
				set_temp_variable = { coalition_partner_var = token:social_democrat }
				add_to_coalition = yes
			}
			add_war_support = 0.10
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = QIE_rural_loyalty
		icon = GFX_goal_agrarian_soldiers
		cost = 7

		relative_position_id = QIE_pick_NCERA
		x = 1
		y = 4

		prerequisite = { focus = QIE_ncera_industry }
		prerequisite = { focus = QIE_benevolent_emperor }
		prerequisite = { focus = QIE_rural_defense_force }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_rural_loyalty"
			swap_ideas = {
				remove_idea = QIE_rural_reform_idea
				add_idea = QIE_rural_insurgency_idea
			}
			if = {
				limit = { NOT = { has_government = social_conservative } }
				add_popularity = {
					ideology = social_democrat
					popularity = 0.05
				}
			}
			else = {
				add_popularity = {
					ideology = social_conservative
					popularity = 0.05
				}
			}
		}
		search_filters = { FOCUS_FILTER_RESISTANCE }
	}

	#manchu tree

	focus = {
		id = QIE_noble_factories
		icon = GFX_goal_ANQ_Dalu_Yinhang
		cost = 7

		relative_position_id = QIE_pick_MP
		x = -2
		y = 1

		prerequisite = { focus = QIE_pick_MP }
		mutually_exclusive = { focus = QIE_centralize_state }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_noble_factories"
			add_ideas = QIE_noble_factories_idea
			608 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
			if = {
				limit = {
					has_government = authoritarian_democrat
					QIE_li_huang = { is_second_in_command = yes }
				}
				custom_effect_tooltip = tooltip_white_line
				custom_effect_tooltip = QIE_delayed_gratification_tt
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_imperial_roads
		icon = GFX_goal_generic_railway_construction
		cost = 7

		relative_position_id = QIE_pick_MP
		x = 0
		y = 1

		prerequisite = { focus = QIE_pick_MP }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_imperial_roads"
			614 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			611 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			1062 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_new_coronation
		icon = GFX_goal_QIE_forbiddenpalace
		cost = 7

		relative_position_id = QIE_pick_MP
		x = 2
		y = 1

		prerequisite = { focus = QIE_pick_MP }
		mutually_exclusive = { focus = QIE_reform_criminal_justice }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_new_coronation"
			country_event = qiefocus.22
			if = {
				limit = {
					NOT = {
						has_government = paternal_autocrat
					}
				}
				set_temp_variable = { coalition_partner_var = token:paternal_autocrat }
				add_to_coalition = yes
			}
		}
	}

	focus = {
		id = QIE_imperial_arsenals
		icon = GFX_goal_munitions_factories
		cost = 7

		relative_position_id = QIE_pick_MP
		x = -2
		y = 2

		prerequisite = { focus = QIE_noble_factories }
		prerequisite = { focus = QIE_imperial_roads }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_imperial_arsenals"
			1062 = {
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_appoint_viceroys
		icon = GFX_goal_generic_radar
		cost = 7

		relative_position_id = QIE_pick_MP
		x = 0
		y = 2

		prerequisite = { focus = QIE_noble_factories }
		prerequisite = { focus = QIE_imperial_roads }
		prerequisite = { focus = QIE_new_coronation }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_appoint_viceroys"
			add_tech_bonus = {
				name = QIE_appoint_viceroys
				bonus = 0.5
				uses = 1
				category = motorized_equipment
			}
			add_tech_bonus = {
				name = QIE_appoint_viceroys
				bonus = 0.5
				uses = 1
				category = construction_tech
			}
			add_tech_bonus = {
				name = QIE_appoint_viceroys
				bonus = 0.5
				uses = 2
				category = radar_tech
				technology = radio
			}
			if = {
				limit = {
					owns_state = 1059
					owns_state = 597
					owns_state = 1064
				}
				build_railway = {
					level = 1
					path = { 7656 7129 12069 10043 12015 4181 1124 }
				}
			}
			if = {
				limit = {
					has_country_flag = QIE_yan_backs_coup
					owns_state = 615
				}
				615 = {
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
		}
		search_filters = { FOCUS_FILTER_STABILITY }
	}

	focus = {
		id = QIE_raise_banners
		icon = GFX_goal_QIE_hail_to_the_qing
		cost = 7

		relative_position_id = QIE_pick_MP
		x = -1
		y = 3

		prerequisite = { focus = QIE_imperial_arsenals }
		prerequisite = { focus = QIE_appoint_viceroys }
		available = {
			OR = {
				has_completed_focus = QIE_mandate_heaven
				QIE_aisin_gioro_pujie = { is_second_in_command = yes }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_raise_banners"
			add_ideas = QIE_banner_idea
		}
	}

	focus = {
		id = QIE_reinforce_confucianism
		icon = GFX_goal_QIE_confucianism
		cost = 7

		relative_position_id = QIE_pick_MP
		x = 3
		y = 2

		prerequisite = {
			focus = QIE_reform_criminal_justice
			focus = QIE_new_coronation
		}

		bypass = {
			has_country_flag = QIE_qu_backs_coup
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_reinforce_confucianism"
			add_ideas = QIE_reinforce_confucianism_idea
			if = {
				limit = { QIE_li_huang = { is_second_in_command = yes } }
				add_popularity = {
					ideology = social_democrat
					popularity = 0.025
				}
				add_popularity = {
					ideology = social_conservative
					popularity = 0.025
				}
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.025
				}
			}
			else = {
				set_temp_variable = { ideology_change_var = 0.05 }
				change_ruling_party_popularity = yes
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_mandate_heaven
		icon = GFX_goal_QIE_glory
		cost = 7

		relative_position_id = QIE_pick_MP
		x = 3
		y = 3

		prerequisite = {
			focus = QIE_reinforce_confucianism
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_fractured_empire_removed_tt
				NOT = {
					has_idea = QIE_fractured_empire
					has_idea = QIE_fractured_empire2
					has_idea = QIE_fractured_empire3
				}
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_mandate_heaven"
			swap_ideas = {
				remove_idea = QIE_reinforce_confucianism_idea
				add_idea = QIE_reinforce_confucianism_idea2
			}
			if = {
				limit = { QIE_li_huang = { is_second_in_command = yes } }
				add_popularity = {
					ideology = social_democrat
					popularity = 0.025
				}
				add_popularity = {
					ideology = social_conservative
					popularity = 0.025
				}
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.025
				}
			}
			else = {
				set_temp_variable = { ideology_change_var = 0.05 }
				change_ruling_party_popularity = yes
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	#YCP Tree

	focus = {
		id = QIE_YCP_modernization
		icon = GFX_goal_factory_complex
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = -2
		y = 1

		prerequisite = { focus = QIE_pick_YCP }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_YCP_modernization"
			add_timed_idea = {
				idea = QIE_ycp_industry_push_idea
				days = 365
			}
			1061 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
			1062 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = QIE_centralize_state
		icon = GFX_goal_ANQ_centralization
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = 0
		y = 1

		prerequisite = { focus = QIE_pick_YCP }
		mutually_exclusive = { focus = QIE_noble_factories }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_PATAUT }
				has_completed_focus = QIE_reform_criminal_justice
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_centralize_state"
			add_ideas = QIE_centralize_the_state
			if = {
				limit = { NOT = { has_government = authoritarian_democrat } }
				set_temp_variable = { coalition_partner_var = token:authoritarian_democrat }
				add_to_coalition = yes
			}
			if = {
				limit = {
					has_government = paternal_autocrat
					has_completed_focus = QIE_reform_criminal_justice
				}
				hidden_effect = {
					country_event = { id = qiefocus.19 days = 7 }
				}
			}
			if = {
				limit = {
					has_government = paternal_autocrat
					has_completed_focus = QIE_reform_criminal_justice
					NOT = { has_completed_focus = QIE_centralize_state }
				}
				custom_effect_tooltip = tooltip_white_line
				custom_effect_tooltip = QIE_bit_off_too_much_tt
			}
			if = {
				limit = {
					has_government = paternal_autocrat
					NOT = { has_completed_focus = QIE_reform_criminal_justice }
				}
				custom_effect_tooltip = tooltip_white_line
				custom_effect_tooltip = QIE_delayed_gratification_tt
			}
		}
		search_filters = {
			FOCUS_FILTER_POLITICAL
			FOCUS_FILTER_STABILITY
		}
	}

	focus = {
		id = QIE_YCP_arsenals
		icon = GFX_goal_Focus_Military_Mobilisation
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = -1
		y = 2

		prerequisite = { focus = QIE_YCP_modernization }
		prerequisite = { focus = QIE_centralize_state }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_YCP_arsenals"
			620 = {
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
			add_tech_bonus = {
				name = QIE_YCP_arsenals
				bonus = 1
				uses = 1
				category = industry
			}
		}
		search_filters = {
			FOCUS_FILTER_INDUSTRY
			FOCUS_FILTER_RESEARCH
		}
	}

	focus = {
		id = QIE_destroy_leftists
		icon = GFX_HOL_crackdown_syndie
		cost = 5

		relative_position_id = QIE_pick_YCP
		x = 2
		y = 2

		prerequisite = {
			focus = QIE_centralize_state
			focus = QIE_noble_factories
		}

		bypass = {
			NOT = {
				country_exists = CHI
				HNN = {
					has_country_leader = { character = HNN_cheng_qian }
				}
				GXC = {
					has_country_leader = { character = GXC_chen_mingshu }
				}
				YUN = {
					OR = {
						has_country_leader = { character = YUN_zhu_peide }
						has_country_leader = { character = YUN_zhu_de }
					}
				}
				date < 1937.06.15
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_destroy_leftists"
			country_event = qiefocus.20
			if = {
				limit = { has_government = social_conservative }
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.05
				}
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.05
				}
			}
			else = {
				set_temp_variable = { ideology_change_var = 0.1 }
				change_ruling_party_popularity = yes
			}
		}
	}

	focus = {
		id = QIE_emperor_unifier
		icon = GFX_focus_rom_royal_dictatorship
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = 2
		y = 3

		prerequisite = { focus = QIE_destroy_leftists }
		available = {
			NOT = { has_idea = QIE_Legacy_Kang_Youwei_2 }
			OR = {
				num_of_factories > 30
				has_war_support > .75
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_emperor_unifier"
			add_ideas = QIE_unifying_emperor_idea
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = QIE_military_state
		icon = GFX_goal_mass_concentration_of_army
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = 0
		y = 3

		prerequisite = { focus = QIE_YCP_arsenals }
		prerequisite = { focus = QIE_destroy_leftists }
		available = { has_authoritarian_government = yes }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_military_state"
			army_experience = 25
			add_ideas = QIE_YCP_militarized_state
			if = {
				limit = { has_idea = QIE_cult_of_progress_idea }
				hidden_effect = {
					add_popularity = {
						ideology = authoritarian_democrat
						popularity = 0.03
					}
				}
			}
		}
		search_filters = {
			FOCUS_FILTER_ARMY_BONUS
			FOCUS_FILTER_ARMY_XP
		}
	}

	focus = {
		id = QIE_chinese_century
		icon = GFX_goal_ANQ_end_century_humiliation
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = 1
		y = 4

		prerequisite = { focus = QIE_military_state }
		prerequisite = { focus = QIE_emperor_unifier }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_chinese_century"
			if = {
				limit = { has_country_flag = QIE_zhang_backs_coup }
				add_ideas = QIE_chinese_century_tianran_idea
			}
			else_if = {
				limit = { amount_research_slots > 3 }
				add_ideas = QIE_chinese_century_idea
				add_stability = 0.1
			}
			else = {
				china_add_research_slots = yes
				add_stability = 0.1
			}
			if = {
				limit = { has_dictatorship_government = yes }
				set_temp_variable = { ideology_change_var = 0.1 }
				change_ruling_party_popularity = yes
			}
			else = {
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.1
				}
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = QIE_cult_of_progress
		icon = GFX_goal_double_research
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = -3
		y = 2

		prerequisite = { focus = QIE_vigor_modernization }
		prerequisite = { focus = QIE_YCP_modernization }
		available = {
			NOT = {
				has_completed_focus = QIE_pick_MP
				has_completed_focus = QIE_pick_NCERA
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_cult_of_progress"
			add_timed_idea = {
				idea = QIE_cult_of_progress_idea
				days = 365
			}
			add_tech_bonus = {
				name = QIE_cult_of_progress
				bonus = 0.50
				uses = 1
				category = electronics
			}
			add_tech_bonus = {
				name = QIE_cult_of_progress
				bonus = 0.50
				uses = 1
				category = train_tech
			}
			custom_effect_tooltip = tooltip_white_line
			custom_effect_tooltip = QIE_ycp_gambit_tt
			hidden_effect = {
				mark_focus_tree_layout_dirty = yes
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = QIE_YCP_modern_warfare
		icon = GFX_goal_generic_army_superior_firepower
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = -2
		y = 3

		prerequisite = { focus = QIE_YCP_arsenals }
		prerequisite = { focus = QIE_cult_of_progress }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_YCP_modern_warfare"
			add_tech_bonus = {
				name = QIE_YCP_modern_warfare
				bonus = 0.50
				uses = 2
				category = artillery
			}
			add_doctrine_cost_reduction = {
				name = QIE_YCP_modern_warfare
				cost_reduction = 0.75
				uses = 1
				category = land_doctrine
			}
			if = {
				limit = { has_idea = QIE_cult_of_progress_idea }
				hidden_effect = {
					add_popularity = {
						ideology = authoritarian_democrat
						popularity = 0.03
					}
				}
			}
		}
		search_filters = {
			FOCUS_FILTER_INDUSTRY
			FOCUS_FILTER_RESEARCH
		}
	}

	focus = {
		id = QIE_YCP_trappings_of_a_party_state
		icon = GFX_goal_authority
		cost = 7

		relative_position_id = QIE_pick_YCP
		x = -3
		y = 4

		prerequisite = { focus = QIE_military_state }
		prerequisite = { focus = QIE_nationalize_yan_thot }
		prerequisite = { focus = QIE_cult_of_progress }
		available = { has_idea = QIE_cult_of_progress_idea }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_YCP_trappings_of_a_party_state"
			swap_ideas = {
				remove_idea = QIE_nationalized_yan_xishan_thought
				add_idea = QIE_Yan_party_state_idea
			}
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = 0.3
			}
			if = {
				limit = { has_idea = QIE_fractured_empire3 }
				remove_ideas = QIE_fractured_empire3
			}
			custom_effect_tooltip = tooltip_white_line
			custom_effect_tooltip = QIE_ycp_consolidates_tt
			hidden_effect = {
				remove_ideas = QIE_cult_of_progress_idea
				add_ideas = QIE_cult_of_progress_idea
			}
		}
		search_filters = {
			FOCUS_FILTER_ARMY_BONUS
			FOCUS_FILTER_ARMY_XP
		}
	}

	#manchu FP
	focus = {
		id = QIE_imperial_consolidation
		icon = GFX_goal_ANQ_stand_with_qing
		cost = 5

		relative_position_id = QIE_pick_MP
		x = 0
		y = 4

		prerequisite = {
			focus = QIE_emperor_unifier
			focus = QIE_raise_banners
			focus = QIE_mandate_heaven
		}
		available = {
			is_subject = no
			OR = {
				has_idea = QIE_YCP_militarized_state
				has_idea = QIE_unifying_emperor_idea
				has_idea = QIE_banner_idea
				has_idea = QIE_rural_insurgency_idea
			}
		}

		bypass = {
			is_subject = yes
		}

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				can_declare_war_on = CHI
				OR = {
					ROOT_is_threatened = yes
					CHI = { default_attack_AI_trigger_FROM = yes }
				}
			}
		}

		will_lead_to_war_with = CHI

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_imperial_consolidation"
			custom_effect_tooltip = QIE_demand_fealty_TT
			add_to_array = { china_possible_allies_array = SQI }
			add_to_array = { china_possible_allies_array_northwest = KUM }
			add_to_array = { china_possible_allies_array_northwest = XSM }
			custom_effect_tooltip = tooltip_white_line
			hidden_effect = {
				china_enable_all_demand_submission_decisions = yes
				FNG = { country_event = { id = qiefor.52 hours = 6 } }
				if = {
					limit = {
						country_exists = LEP
						country_exists = GEA
						GEA = { has_capitulated = no }
					}
					GEA = { country_event = { id = qiefor.55 hours = 6 } }
				}
				random_other_country = {
					limit = { is_ai = yes }
					news_event = { id = worldnews.234 hours = 2 }
				}
			}
		}
	}

	focus = {
		id = QIE_destroy_concessions
		icon = GFX_goal_QIE_destroy_LEC
		cost = 5

		relative_position_id = QIE_pick_MP
		x = -2
		y = 5

		prerequisite = {
			focus = QIE_rural_loyalty
			focus = QIE_chinese_century
			focus = QIE_imperial_consolidation
		}

		available = {
			market_liberal < 0.05
		}

		bypass = {
			owns_state = 729
			NOT = { country_exists = LEC }
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_destroy_concessions"
			china_enable_concession_decisions = yes
			hidden_effect = {
				activate_targeted_decision = { target = TIB decision = QIE_integrate_tibet }
			}
		}
	}

	focus = {
		id = QIE_false_republic
		icon = GFX_goal_generic_attack_fengtian
		cost = 5

		relative_position_id = QIE_pick_MP
		x = 2
		y = 5

		available = {
			is_subject = no
		}

		bypass = {
			NOT = { can_declare_war_on = FNG }
		}

		prerequisite = {
			focus = QIE_chinese_century
			focus = QIE_rural_loyalty
			focus = QIE_imperial_consolidation
		}

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				strength_ratio = { tag = FNG ratio < 2 }
				JAP = {
					has_guaranteed = FNG
					NOT = { has_war_with = GER }
				}
			}
			modifier = {
				factor = 0
				OR = {
					ROOT_is_threatened = yes
					FNG = { default_attack_AI_trigger_FROM = yes }
				}
			}
		}

		will_lead_to_war_with = FNG

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_false_republic"
			add_political_power = 100
			add_war_support = 0.10
			create_wargoal = {
				target = FNG
				type = annex_everything
			}
		}
	}

	focus = {
		id = QIE_we_win
		icon = GFX_Goal_YUN_Promote_Tourism
		cost = 8

		relative_position_id = QIE_pick_MP
		x = 0
		y = 6

		prerequisite = {
			focus = QIE_destroy_concessions
			focus = QIE_false_republic
		}
		available = {
			has_global_flag = china_united
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_we_win"
			add_political_power = 100
			add_research_slot_until_five = yes
			if = {
				limit = {
					amount_research_slots > 3
					NOT = { has_idea = QIE_chinese_century_idea }
				}
				add_ideas = QIE_chinese_century_idea
			}
			custom_effect_tooltip = tooltip_white_line
			china_enable_outskirts_decisions = yes
			hidden_effect = {
				if = {
					limit = { ANQ = { china_is_aligned_with_zhili = yes } }
					activate_targeted_decision = { target = ANQ decision = QIE_war_goal_anqing_for_refusal_faction }
				}
			}
		}
		search_filters = {
			FOCUS_FILTER_POLITICAL
			FOCUS_FILTER_RESEARCH
		}
	}

	#military tree
	focus = {
		id = QIE_uneasy_coalition
		icon = GFX_goal_consolidating_coalitionv2
		cost = 2

		x = 32
		y = 1

		prerequisite = { focus = QIE_purge_zhili }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_uneasy_coalition"
			country_event = qiefocus.16
		}
	}

	focus = {
		id = QIE_foreigner_against_foreigner
		icon = GFX_goal_bag_of_money
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 1
		y = 1

		prerequisite = { focus = QIE_uneasy_coalition }
		mutually_exclusive = { focus = QIE_look_to_our_past }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_foreigner_against_foreigner"
			activate_targeted_decision = { target = FROM decision = QIE_hire_bandits }
			activate_targeted_decision = { target = FROM decision = QIE_hire_russian_cw_veterans }
			activate_targeted_decision = { target = FROM decision = QIE_hire_legation_exiles }
			add_stability = -0.05
		}
		search_filters = {
			FOCUS_FILTER_POLITICAL
			FOCUS_FILTER_STABILITY
		}
	}

	focus = {
		id = QIE_look_to_our_past
		icon = GFX_goal_cavalry
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = -1
		y = 1

		prerequisite = { focus = QIE_uneasy_coalition }
		mutually_exclusive = { focus = QIE_foreigner_against_foreigner }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_look_to_our_past"
			add_doctrine_cost_reduction = {
				name = QIE_look_to_our_past
				cost_reduction = 0.5
				uses = 1
				category = land_doctrine
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = QIE_assess_doctrines
		icon = GFX_goal_generic_army_grand_battleplan
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 0
		y = 2

		prerequisite = {
			focus = QIE_look_to_our_past
			focus = QIE_foreigner_against_foreigner
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_assess_doctrines"
			add_doctrine_cost_reduction = {
				name = QIE_assess_doctrines
				cost_reduction = 0.5
				uses = 1
				category = land_doctrine
			}
		}
	}

	focus = {
		id = QIE_prepare_dikes
		icon = GFX_goal_dam
		cost = 5

		relative_position_id = QIE_uneasy_coalition
		x = -2
		y = 3

		prerequisite = {
			focus = QIE_assess_doctrines
			focus = QIE_rural_infrastructure
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_prepare_dikes"
			custom_effect_tooltip = breach_dams_TT
			hidden_effect = {
				activate_targeted_decision = { target = FROM decision = QIE_relocate_civilians_out_of_danger_area }
				activate_targeted_decision = { target = FROM decision = QIE_breach_dams_channel_water_north }
				activate_targeted_decision = { target = FROM decision = QIE_breach_dams_channel_water_south }
			}
		}
	}

	focus = {
		id = QIE_rebuild_command_structure
		icon = GFX_goal_QIE_Imperial_Army_1
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 0
		y = 3

		prerequisite = { focus = QIE_assess_doctrines }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_rebuild_command_structure"
			army_experience = 15
			country_event = qiefocus.14
			remove_ideas = QIE_leadership_crisis_bad
			add_advisor_role = {
				character = QIE_aisin_gioro_jixing
				advisor = {
					slot = high_command
					idea_token = QIE_aisin_gioro_jixing_mhc
					ledger = army
					traits = { KR_MHC_artillery_1 }
					cost = 50
				}
			}
			add_advisor_role = {
				character = QIE_xing_shilian
				advisor = {
					slot = high_command
					idea_token = QIE_xing_shilian_mhc
					ledger = army
					traits = { KR_MHC_army_regrouping_1 }
					cost = 50
				}
			}
		}
		search_filters = {
			FOCUS_FILTER_ARMY_BONUS
			FOCUS_FILTER_ARMY_XP
		}
	}

	focus = {
		id = QIE_rural_defense_force
		icon = GFX_goal_generic_drafted_army
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = -2
		y = 4

		prerequisite = { focus = QIE_rebuild_command_structure }

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_game_rule = { rule = QIE_path option = QIE_PATH_MANCHU_LEGIT_SOCCON }
			}
		}

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_rural_defense_force"
			if = {
				limit = {
					NOT = {
						has_government = social_democrat
						has_government = social_conservative
					}
				}
				add_popularity = {
					ideology = social_conservative
					popularity = 0.03
				}
			}
			country_event = qiefocus.17
			add_ideas = QIE_rural_defense_idea
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {
		id = QIE_best_money_can_buy
		icon = GFX_focus_usa_reestablish_the_gold_standard
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 0
		y = 4

		prerequisite = { focus = QIE_rebuild_command_structure }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_best_money_can_buy"
			#flavor event for QIE, LEP, and YUN
			if = {
				limit = { NOT = { has_government = authoritarian_democrat } }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.03
				}
			}
			add_doctrine_cost_reduction = {
				name = QIE_best_money_can_buy
				cost_reduction = 0.5
				uses = 1
				category = land_doctrine
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = QIE_exploit_baoding_contacts
		icon = GFX_goal_QIE_baoding
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 2
		y = 4

		prerequisite = { focus = QIE_rebuild_command_structure }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_exploit_baoding_contacts"
			if = {
				limit = {
					NOT = {
						has_government = authoritarian_democrat
					}
				}
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.03
				}
			}
			army_experience = 15
			add_tech_bonus = {
				name = QIE_exploit_baoding_contacts
				bonus = 1
				uses = 2
				category = infantry_weapons
			}
		}
		search_filters = {
			FOCUS_FILTER_ARMY_BONUS
			FOCUS_FILTER_RESEARCH
			FOCUS_FILTER_ARMY_XP
		}
	}

	focus = {
		id = QIE_reinstate_baojia
		icon = GFX_goal_COS_War
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = -1
		y = 5

		prerequisite = { focus = QIE_rural_defense_force }
		prerequisite = { focus = QIE_best_money_can_buy }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_reinstate_baojia"
			if = {
				limit = {
					NOT = {
						has_government = social_conservative
					}
				}
				add_popularity = {
					ideology = social_conservative
					popularity = 0.03
				}
			}
			else_if = {
				limit = { has_government = social_conservative }
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.03
				}
			}
			add_ideas = QIE_baojia_idea
		}
	}

	focus = {
		id = QIE_imperial_propaganda
		icon = GFX_goal_generic_propaganda
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 1
		y = 5

		prerequisite = { focus = QIE_best_money_can_buy }
		prerequisite = { focus = QIE_exploit_baoding_contacts }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_imperial_propaganda"
			if = {
				limit = { NOT = { has_government = authoritarian_democrat } }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.03
				}
			}
			else_if = {
				limit = { has_government = authoritarian_democrat }
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.03
				}
			}
			add_ideas = QIE_imperial_propaganda_idea
			QIE_reduce_fractured_empire = yes
			#flavor event for QIE
		}
	}

	focus = {
		id = QIE_manchu_naval_academy
		icon = GFX_goal_QIE_Imperial_Navy_1
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = -1
		y = 6

		prerequisite = { focus = QIE_imperial_propaganda }
		prerequisite = { focus = QIE_reinstate_baojia }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_manchu_naval_academy"
			if = {
				limit = { country_exists = SIC }
				unlock_decision_category_tooltip = QIE_commission_sicilian_ships
				custom_effect_tooltip = QIE_sic_ships_warning
				hidden_effect = {
					activate_targeted_decision = { target = FROM decision = QIE_sic_destroyers }
					activate_targeted_decision = { target = FROM decision = QIE_sic_subs }
					activate_targeted_decision = { target = FROM decision = QIE_sic_cruisers }
					activate_targeted_decision = { target = FROM decision = QIE_sic_convoys }
				}
			}
			add_doctrine_cost_reduction = {
				name = QIE_manchu_naval_academy
				cost_reduction = 0.5
				uses = 1
				category = naval_doctrine
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = QIE_manchu_air_warfare
		icon = GFX_goal_QIE_Imperial_Air_Force_1
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 1
		y = 6

		prerequisite = { focus = QIE_imperial_propaganda }
		prerequisite = { focus = QIE_reinstate_baojia }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_manchu_air_warfare"
			add_doctrine_cost_reduction = {
				name = QIE_manchu_air_warfare
				cost_reduction = 0.5
				uses = 1
				category = air_doctrine
			}
			add_tech_bonus = {
				name = QIE_manchu_air_warfare
				bonus = 0.75
				uses = 2
				category = light_fighter
				category = cat_heavy_fighter
				category = tactical_bomber
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = QIE_expand_baoding_rnd
		icon = GFX_goal_generic_design_equipment_standards
		cost = 8

		relative_position_id = QIE_uneasy_coalition
		x = 0
		y = 7

		prerequisite = { focus = QIE_manchu_air_warfare }
		prerequisite = { focus = QIE_manchu_naval_academy }

		completion_reward = {
			log = "[GetDateText]: [Root.GetName]: Focus QIE_expand_baoding_rnd"
			custom_effect_tooltip = QIE_merge_military_spirits_tt
			custom_effect_tooltip = tooltip_white_line
			china_add_research_slots = yes
			add_ideas = QIE_imperial_headquarters_idea
			hidden_effect = {
				remove_ideas = QIE_baojia_idea
				remove_ideas = QIE_imperial_propaganda_idea
				remove_ideas = QIE_rural_defense_idea
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}
}

